(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    561861,      12933]
NotebookOptionsPosition[    551974,      12765]
NotebookOutlinePosition[    552317,      12780]
CellTagsIndexPosition[    552274,      12777]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Load Radia", "Section",
 CellChangeTimes->{{3.766397988602113*^9, 3.766398000439457*^9}, {
  3.784905891255539*^9, 3.7849058937557244`*^9}, {3.8244837953260765`*^9, 
  3.824483799507316*^9}, {3.824484206680256*^9, 
  3.8244842076301928`*^9}},ExpressionUUID->"a20bfe0c-ce1c-4fe5-95f0-\
72aace82b492"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "Radia`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RadPlot3DOptions", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radUtiDelAll", "[", "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Erase", " ", "all", " ", "previous", " ", "elements"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6818148953014574`*^9, 3.6818148962234063`*^9}, {
  3.8230135271584983`*^9, 3.8230135274597864`*^9}, {3.823013680470293*^9, 
  3.8230136807868514`*^9}, {3.823186043440482*^9, 3.8231860437259874`*^9}, {
  3.824544725241103*^9, 3.8245447263781257`*^9}, {3.8245490022725987`*^9, 
  3.824549002725765*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[262]:=",ExpressionUUID->"03992682-afbe-4169-bb6f-06bebcd00eeb"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Radia Version: \"\>", "\[InvisibleSpace]", "4.31`", 
   "\[InvisibleSpace]", "\<\" is loaded\"\>"}],
  SequenceForm["Radia Version: ", 4.31, " is loaded"],
  Editable->False]], "Print",
 CellChangeTimes->{3.829216562783606*^9, 3.829387934895523*^9, 
  3.829662379337986*^9, 3.8297254159029093`*^9, 3.829757130085475*^9, 
  3.829815743343231*^9, 3.829841660714402*^9, 3.829842128904995*^9, 
  3.829842444150694*^9, 3.8298426706091423`*^9, 3.8298974409163747`*^9, 
  3.8305982084655695`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"d98cdd68-a081-4abb-ba3b-5c259baacc5a"],

Cell[BoxData["\<\"Radia is copyright ESRF, France.\"\>"], "Print",
 CellChangeTimes->{3.829216562783606*^9, 3.829387934895523*^9, 
  3.829662379337986*^9, 3.8297254159029093`*^9, 3.829757130085475*^9, 
  3.829815743343231*^9, 3.829841660714402*^9, 3.829842128904995*^9, 
  3.829842444150694*^9, 3.8298426706091423`*^9, 3.8298974409163747`*^9, 
  3.8305982084655695`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"e8a413b1-6d75-4310-a719-6bb6ac0b058b"],

Cell[BoxData["\<\"Portions copyright Synchrotron SOLEIL, France.\"\>"], \
"Print",
 CellChangeTimes->{3.829216562783606*^9, 3.829387934895523*^9, 
  3.829662379337986*^9, 3.8297254159029093`*^9, 3.829757130085475*^9, 
  3.829815743343231*^9, 3.829841660714402*^9, 3.829842128904995*^9, 
  3.829842444150694*^9, 3.8298426706091423`*^9, 3.8298974409163747`*^9, 
  3.8305982084811845`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"f93c323c-622c-4326-8a5f-47779d0a360d"],

Cell[BoxData["\<\"Portions copyright Wolfram Research, Inc.\"\>"], "Print",
 CellChangeTimes->{3.829216562783606*^9, 3.829387934895523*^9, 
  3.829662379337986*^9, 3.8297254159029093`*^9, 3.829757130085475*^9, 
  3.829815743343231*^9, 3.829841660714402*^9, 3.829842128904995*^9, 
  3.829842444150694*^9, 3.8298426706091423`*^9, 3.8298974409163747`*^9, 
  3.8305982084811845`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"f5d08969-e3b9-4819-94a5-27d4b1579215"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.824216014586543*^9, 
  3.824216020486326*^9}},ExpressionUUID->"840b05d9-51ab-45e4-ba4d-\
6d8d1291fdf4"],

Cell[CellGroupData[{

Cell["BlockGeometry", "Subsection",
 CellChangeTimes->{{3.823006823806962*^9, 
  3.823006826765521*^9}},ExpressionUUID->"d8aa3d6e-c222-46c0-a648-\
0b9d56672601"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idBlockGeometry", "[", "checkgeo_", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"geo1", ",", "geo2", ",", "geo3"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Geo", " ", "A1"}], ",", " ", 
        RowBox[{"Delta", " ", "52.5"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"checkgeo", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"geo1", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "21.5"}], ",", 
               RowBox[{"-", "50"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"21.5", ",", 
               RowBox[{"-", "50"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"22.5", ",", 
               RowBox[{"-", "49"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"22.5", ",", 
               RowBox[{"-", "41.8"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"16.794", ",", 
               RowBox[{"-", "37.654"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "16.794"}], ",", 
               RowBox[{"-", "37.654"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "22.5"}], ",", 
               RowBox[{"-", "41.8"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "22.5"}], ",", 
               RowBox[{"-", "49"}]}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"geo2", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"16.794", ",", 
               RowBox[{"-", "37.654"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"16.794", ",", 
               RowBox[{"-", "33.946"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "16.794"}], ",", 
               RowBox[{"-", "33.946"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "16.794"}], ",", 
               RowBox[{"-", "37.654"}]}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"geo3", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"16.794", ",", 
               RowBox[{"-", "33.946"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"22.5", ",", 
               RowBox[{"-", "29.8"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"22.5", ",", 
               RowBox[{"-", "19.3"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"5.25", ",", "0.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "5.25"}], ",", "0.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "22.5"}], ",", 
               RowBox[{"-", "19.3"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "22.5"}], ",", 
               RowBox[{"-", "29.8"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "16.794"}], ",", 
               RowBox[{"-", "33.946"}]}], "}"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"checkgeo", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"geo1", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"16.794", ",", 
               RowBox[{"-", "37.654"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"16.794", ",", 
               RowBox[{"-", "33.946"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "16.794"}], ",", 
               RowBox[{"-", "33.946"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "16.794"}], ",", 
               RowBox[{"-", "37.654"}]}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"geo2", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"16.794", ",", 
               RowBox[{"-", "33.946"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"22.5", ",", 
               RowBox[{"-", "29.8"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"22.5", ",", 
               RowBox[{"-", "19.3"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"5.25", ",", "0.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "5.25"}], ",", "0.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "22.5"}], ",", 
               RowBox[{"-", "19.3"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "22.5"}], ",", 
               RowBox[{"-", "29.8"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "16.794"}], ",", 
               RowBox[{"-", "33.946"}]}], "}"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"geo1", ",", "geo2", ",", "geo3"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.8229973334496083`*^9, 3.8229975357986193`*^9}, {
   3.82299756675494*^9, 3.8229975706368685`*^9}, {3.823006742030616*^9, 
   3.8230068053256755`*^9}, 3.8230101467535343`*^9, {3.8231011693095837`*^9, 
   3.8231011939352427`*^9}, {3.8236951137333775`*^9, 3.823695115555832*^9}, {
   3.8237008274433804`*^9, 3.8237008500952864`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[266]:=",ExpressionUUID->"321735b9-b075-4bbb-8fe7-1fe4be8c7c82"]
}, Closed]],

Cell[CellGroupData[{

Cell["cassetteDraw", "Subsection",
 CellChangeTimes->{{3.822996513974464*^9, 3.8229965257892003`*^9}, {
  3.8229965764562564`*^9, 
  3.8229965827147937`*^9}},ExpressionUUID->"d5b41983-278f-47c0-9e7b-\
c32de49448a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cassetteDraw", "::", "usage"}], " ", "=", " ", 
    "\"\<magnetizations = Lista das magnetiza\[CCedilla]\[OTilde]es dos \
blocos de um cassete (lista de tamanho n); blockGeo = {geo1,geo2,geo3}; \n\
termination = {{lista de magnetizacoes na entrada}, {lista de espessuras na \
entrada}, {lista de espa\[CCedilla]amentos na entrada},{lista de \
magnetizacoes na sa\[IAcute]da}, {lista de espessuras na sa\[IAcute]da}, \
{lista de espa\[CCedilla]amentos na sa\[IAcute]da}}\>\""}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"idCassetteDraw", "[", 
   RowBox[{
   "magnetizations_", ",", "blockGeo_", ",", "posErrors_", ",", 
    "termination_", ",", "periodL_", ",", "blockThick_", ",", "gap_", ",", 
    "blockGap_", ",", "subdiv_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "cassette", ",", "block", ",", "obj", ",", "obj1", ",", "obj2", ",", 
        "obj3", ",", "blocknumber", ",", "vacodym745ap", ",", "termLength", 
        ",", "i", ",", "j", ",", "parts", ",", "randomErrorY", ",", 
        "randomErrorZ", ",", "longPos"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cassette", "=", 
        RowBox[{"radObjCnt", "[", 
         RowBox[{"{", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"parts", "=", 
        RowBox[{"Length", "[", "blockGeo", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"obj", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "parts"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"blocknumber", "=", 
        RowBox[{
         RowBox[{"Length", "[", "magnetizations", "]"}], "+", 
         RowBox[{"Length", "[", 
          RowBox[{"termination", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
         RowBox[{"Length", "[", 
          RowBox[{"termination", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Position", " ", "Errors"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"posErrors", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"randomErrorY", "=", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RandomVariate", "[", 
               RowBox[{"NormalDistribution", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"posErrors", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"posErrors", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ")"}], "/", 
                  "3"}]}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "blocknumber"}], "}"}]}], "]"}], 
            "*", 
            RowBox[{"RandomChoice", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "blocknumber"}], 
             "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"randomErrorY", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", "blocknumber"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"posErrors", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"randomErrorZ", "=", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RandomVariate", "[", 
               RowBox[{"NormalDistribution", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"posErrors", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "/", "2"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"posErrors", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "2"}], ")"}], "/", 
                  "3"}]}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "blocknumber"}], "}"}]}], "]"}], 
            "*", 
            RowBox[{"RandomChoice", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "blocknumber"}], 
             "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"randomErrorZ", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", "blocknumber"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", 
          RowBox[{"Termination", " ", "Front"}]}], " ", "===", "=="}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"block", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{"termination", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"termination", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"block", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"radObjCnt", "[", 
            RowBox[{"{", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Next", " ", "Block", " ", "Position"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"longPos", "=", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"longPos", "=", 
              RowBox[{"longPos", "+", 
               RowBox[{"0.5", "*", 
                RowBox[{"termination", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", 
                   RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], "+", 
               RowBox[{"termination", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", 
                  RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "+", 
               RowBox[{"0.5", "*", 
                RowBox[{"termination", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "i"}], "]"}], "]"}]}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Create", " ", "the", " ", "Block", " ", "Object"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", " ", "parts"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Extrude", " ", "part"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"obj", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", 
              RowBox[{"radObjThckPgn", "[", 
               RowBox[{"longPos", ",", 
                RowBox[{"termination", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "i"}], "]"}], "]"}], ",", 
                RowBox[{"blockGeo", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"termination", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "i"}], "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Part", " ", "Subdivision"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"radObjDivMag", "[", 
              RowBox[{
               RowBox[{"obj", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"subdiv", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Add", " ", "Part", " ", "to", " ", "block"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"radObjAddToCnt", "[", 
              RowBox[{
               RowBox[{"block", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"obj", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "}"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Position", " ", "Error"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"radTrfOrnt", "[", 
           RowBox[{
            RowBox[{"block", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"radTrfTrsl", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"randomErrorY", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"randomErrorZ", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Apply", " ", "Material", " ", "and", " ", "Magnetization"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"vacodym745ap", "=", 
           RowBox[{"radMatLin", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.06", ",", "0.17"}], "}"}], ",", 
             RowBox[{"termination", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"radMatApl", "[", 
           RowBox[{
            RowBox[{"block", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "vacodym745ap"}], "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Add", " ", "to", " ", "Cassette"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"radObjAddToCnt", "[", 
           RowBox[{"cassette", ",", 
            RowBox[{"{", 
             RowBox[{"block", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", "Periods"}], " ", "===", "=="}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"block", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"Length", "[", "magnetizations", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "magnetizations", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"block", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"radObjCnt", "[", 
            RowBox[{"{", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Block", " ", "Position"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"longPos", "=", 
              RowBox[{"longPos", "+", 
               RowBox[{"0.5", "*", 
                RowBox[{"termination", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}]}], "+", 
               RowBox[{"termination", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], "+", 
               RowBox[{"0.5", "*", "blockThick"}]}]}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"longPos", "=", 
              RowBox[{"longPos", "+", "blockThick", "+", "blockGap"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", " ", "parts"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"obj", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", 
              RowBox[{"radObjThckPgn", "[", 
               RowBox[{"longPos", ",", "blockThick", ",", 
                RowBox[{"blockGeo", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"magnetizations", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Part", " ", "Subdivision"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"radObjDivMag", "[", 
              RowBox[{
               RowBox[{"obj", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"subdiv", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Add", " ", "Part", " ", "to", " ", "block"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"radObjAddToCnt", "[", 
              RowBox[{
               RowBox[{"block", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"obj", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "}"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Position", " ", "Error"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"radTrfOrnt", "[", 
           RowBox[{
            RowBox[{"block", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"radTrfTrsl", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"randomErrorY", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"randomErrorZ", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Apply", " ", "Material", " ", "and", " ", "Magnetization"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"vacodym745ap", "=", 
           RowBox[{"radMatLin", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.06", ",", "0.17"}], "}"}], ",", 
             RowBox[{"magnetizations", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"radMatApl", "[", 
           RowBox[{
            RowBox[{"block", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "vacodym745ap"}], "]"}], 
          ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Add", " ", "to", " ", "Cassette"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"radObjAddToCnt", "[", 
           RowBox[{"cassette", ",", 
            RowBox[{"{", 
             RowBox[{"block", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", 
          RowBox[{"Termination", " ", "Back"}]}], " ", "===", "=="}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"block", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{"termination", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"termination", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"block", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"radObjCnt", "[", 
            RowBox[{"{", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Next", " ", "Block", " ", "Position"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[LessEqual]", " ", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"longPos", "=", 
              RowBox[{"longPos", "+", 
               RowBox[{"blockThick", "/", "2"}], "+", 
               RowBox[{"termination", "[", 
                RowBox[{"[", 
                 RowBox[{"6", ",", "1"}], "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"termination", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ",", "1"}], "]"}], "]"}], "/", "2"}]}]}], 
             ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"longPos", "=", 
              RowBox[{"longPos", "+", 
               RowBox[{"0.5", "*", 
                RowBox[{"termination", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ",", 
                   RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], "+", 
               RowBox[{"termination", "[", 
                RowBox[{"[", 
                 RowBox[{"6", ",", "i"}], "]"}], "]"}], "+", 
               RowBox[{"0.5", "*", 
                RowBox[{"termination", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ",", "i"}], "]"}], "]"}]}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", " ", "parts"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"obj", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", 
              RowBox[{"radObjThckPgn", "[", 
               RowBox[{"longPos", ",", 
                RowBox[{"termination", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ",", "i"}], "]"}], "]"}], ",", 
                RowBox[{"blockGeo", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"termination", "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ",", "i"}], "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Part", " ", "Subdivision"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"radObjDivMag", "[", 
              RowBox[{
               RowBox[{"obj", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"subdiv", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Add", " ", "Part", " ", "to", " ", "block"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"radObjAddToCnt", "[", 
              RowBox[{
               RowBox[{"block", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"obj", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "}"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Position", " ", "Error"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"radTrfOrnt", "[", 
           RowBox[{
            RowBox[{"block", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"radTrfTrsl", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"randomErrorY", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"randomErrorZ", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Apply", " ", "Material", " ", "and", " ", "Magnetization"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"vacodym745ap", "=", 
           RowBox[{"radMatLin", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.06", ",", "0.17"}], "}"}], ",", 
             RowBox[{"termination", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "i"}], "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"radMatApl", "[", 
           RowBox[{
            RowBox[{"block", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "vacodym745ap"}], "]"}], 
          ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Add", " ", "to", " ", "Cassette"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"radObjAddToCnt", "[", 
           RowBox[{"cassette", ",", 
            RowBox[{"{", 
             RowBox[{"block", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cassette", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", ")"}]}]}], "Input",
 CellChangeTimes->{{3.822996642547748*^9, 3.8229966622053623`*^9}, {
   3.8229966999847193`*^9, 3.822996712607525*^9}, {3.822996866066005*^9, 
   3.822997007805232*^9}, {3.8229970886211834`*^9, 3.822997172861657*^9}, {
   3.8229972038423195`*^9, 3.8229972327467804`*^9}, {3.8229976128586516`*^9, 
   3.822997615581627*^9}, {3.8229977423096104`*^9, 3.8229979195374327`*^9}, {
   3.82299795068458*^9, 3.8229980492566676`*^9}, {3.8229981049572363`*^9, 
   3.822998135210442*^9}, {3.8229981887467437`*^9, 3.822998340346962*^9}, {
   3.8229983741706066`*^9, 3.8229984727502003`*^9}, {3.822998569425449*^9, 
   3.822999065586999*^9}, {3.8230016862031465`*^9, 3.8230016958932343`*^9}, {
   3.82300173329842*^9, 3.8230018618565197`*^9}, {3.8230018989871907`*^9, 
   3.8230019168120365`*^9}, 3.8230059047317824`*^9, {3.82300606412084*^9, 
   3.823006076465455*^9}, {3.8230061450248785`*^9, 3.8230061459811864`*^9}, {
   3.8230062004256153`*^9, 3.8230063181493616`*^9}, {3.8230064289977636`*^9, 
   3.8230065303095465`*^9}, {3.823006585873805*^9, 3.8230065883503504`*^9}, {
   3.82300661859441*^9, 3.8230066216896544`*^9}, {3.8230066631546993`*^9, 
   3.8230066998322268`*^9}, {3.823006918399409*^9, 3.82300691865304*^9}, {
   3.823007014024148*^9, 3.8230071885747604`*^9}, {3.8230072272774057`*^9, 
   3.8230072980440807`*^9}, {3.8230073454832535`*^9, 3.823007368184529*^9}, {
   3.823007417617037*^9, 3.823007431528256*^9}, {3.823007467409453*^9, 
   3.8230076108030863`*^9}, {3.8230076792257376`*^9, 
   3.8230077255548024`*^9}, {3.823007757155441*^9, 3.8230077683875284`*^9}, {
   3.823007865172476*^9, 3.823007941943116*^9}, {3.8230079756647186`*^9, 
   3.823008094077182*^9}, {3.8230081278690586`*^9, 3.823008130894298*^9}, {
   3.823008175277927*^9, 3.8230082141702065`*^9}, {3.8230082686879177`*^9, 
   3.823008274082326*^9}, 3.823008553616539*^9, {3.823010154173771*^9, 
   3.823010169655837*^9}, {3.823011269371171*^9, 3.823011514307005*^9}, {
   3.823011934197451*^9, 3.8230119375864625`*^9}, {3.823012442262043*^9, 
   3.823012447849208*^9}, {3.823013265967101*^9, 3.8230132706915827`*^9}, {
   3.8230133019855733`*^9, 3.823013308055996*^9}, {3.8230134137949634`*^9, 
   3.823013426172659*^9}, {3.8230145038129044`*^9, 3.8230146380798235`*^9}, {
   3.8230182516940327`*^9, 3.8230182519631915`*^9}, {3.8230729554520288`*^9, 
   3.82307298091088*^9}, {3.8230732793800507`*^9, 3.823073279897188*^9}, {
   3.8230936092727547`*^9, 3.8230936429576406`*^9}, {3.8230995686962013`*^9, 
   3.823099664377655*^9}, {3.8230998129285107`*^9, 3.8230999752067995`*^9}, {
   3.823100050687455*^9, 3.823100067923408*^9}, {3.82310043831323*^9, 
   3.8231006035879164`*^9}, {3.8231006441297226`*^9, 3.823100647584627*^9}, {
   3.82310071987878*^9, 3.823100728822584*^9}, {3.8231007907816315`*^9, 
   3.8231008049567423`*^9}, {3.8231008531344414`*^9, 
   3.8231008622813935`*^9}, {3.823100942333535*^9, 3.8231010641222153`*^9}, {
   3.823178841321891*^9, 3.823178853385052*^9}, {3.823179250142287*^9, 
   3.823179252435254*^9}, {3.8231793590117054`*^9, 3.823179406400276*^9}, {
   3.8231794642909203`*^9, 3.823179473841975*^9}, {3.82317958440681*^9, 
   3.8231796163688817`*^9}, 3.823179776189436*^9, {3.8231798157340665`*^9, 
   3.823179894878375*^9}, {3.8231801373786516`*^9, 3.823180178419283*^9}, {
   3.8231802160050154`*^9, 3.8231803251535625`*^9}, {3.823180367414541*^9, 
   3.823180407041745*^9}, 3.823180529654594*^9, {3.8231817771011024`*^9, 
   3.8231817798247414`*^9}, {3.8231823643199034`*^9, 
   3.8231823781096287`*^9}, {3.8232433076476307`*^9, 3.823243323146572*^9}, {
   3.823243353863224*^9, 3.823243383048979*^9}, {3.8232448398366985`*^9, 
   3.8232448492991066`*^9}, {3.8232449030106573`*^9, 
   3.8232449109512873`*^9}, {3.8232481335096703`*^9, 
   3.8232482068347907`*^9}, {3.8232483225305257`*^9, 
   3.8232483408156424`*^9}, {3.823248835367284*^9, 3.823248856708933*^9}, {
   3.8232488985954456`*^9, 3.8232489528591337`*^9}, {3.823248997395363*^9, 
   3.8232490529272823`*^9}, {3.823249125077532*^9, 3.823249132648445*^9}, {
   3.8232491736818924`*^9, 3.8232491866843896`*^9}, {3.8232493043465815`*^9, 
   3.8232493447309628`*^9}, 3.823249381232456*^9, {3.823359019239974*^9, 
   3.8233590197038856`*^9}, {3.823695203308715*^9, 3.8236952114882574`*^9}, {
   3.823695823901023*^9, 3.8236958251726217`*^9}, {3.8236993801965666`*^9, 
   3.823699463144787*^9}, {3.823699544456874*^9, 3.8236997071120033`*^9}, 
   3.8236997769442487`*^9, {3.823699869108048*^9, 3.8236998694458413`*^9}, {
   3.8237008062987347`*^9, 3.823700810389919*^9}, {3.8244580805471773`*^9, 
   3.8244581659114265`*^9}, 3.824458322095458*^9, {3.8244782019675813`*^9, 
   3.824478205881116*^9}, {3.8285373466948786`*^9, 3.8285373470153913`*^9}, {
   3.828538059415137*^9, 3.8285380791146545`*^9}, 3.8290409253147774`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[267]:=",ExpressionUUID->"8364b443-e1d6-4c82-a34b-4f609527996f"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDDraw", "Subsection",
 CellChangeTimes->{{3.8230144742625413`*^9, 
  3.823014483115279*^9}},ExpressionUUID->"51cb89dd-7aeb-44ea-a317-\
5ad1203e5d64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idDraw", "[", 
   RowBox[{
   "typeID_", ",", "gap_", ",", "nPeriods_", ",", "periodL_", ",", 
    "blockGeo_", ",", "blockThick_", ",", "blockGap_", ",", "magnetizations_",
     ",", "terminations_", ",", "mode_", ",", "subdiv_", " ", ",", 
    RowBox[{"posErrors_", " ", ":", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"gap2_", " ", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "device", ",", "cassette", ",", "mag", ",", "cassetteD", ",", 
        "modeslist", ",", "phase", ",", "i", ",", "displacement", ",", 
        "cassPos"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"device", "=", 
        RowBox[{"radObjCnt", "[", 
         RowBox[{"{", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cassette", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"=", " ", 
          RowBox[{
           RowBox[{"Generate", " ", "Cassettes"}], " ", "===", "=="}]}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "magnetizations", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"cassette", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"idCassetteDraw", "[", 
            RowBox[{
             RowBox[{"magnetizations", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "blockGeo", ",", 
             "posErrors", ",", 
             RowBox[{"terminations", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "periodL", ",", 
             "blockThick", ",", "gap", ",", "blockGap", ",", "subdiv"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Apply", " ", "Gap"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"radTrfOrnt", "[", 
           RowBox[{
            RowBox[{"cassette", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"radTrfTrsl", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "gap"}], "/", "2"}]}], "}"}], "]"}]}], "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"typeID", "\[Equal]", "\"\<DeltaUndulator\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Apply", " ", "Phase"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"modeslist", "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", "0", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", "0", ",", 
                   RowBox[{"1", "/", "4"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", "0", ",", "0"}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", "0", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}]}], "}"}]}], "}"}], "*", 
               "periodL"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"phase", "=", 
              RowBox[{"modeslist", "[", 
               RowBox[{"[", "mode", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"radTrfOrnt", "[", 
              RowBox[{
               RowBox[{"cassette", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"radTrfTrsl", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"phase", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "0"}], 
                 "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Apply", " ", "Rotation"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"radTrfOrnt", "[", 
              RowBox[{
               RowBox[{"cassette", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"radTrfRot", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "-", "1"}], ")"}], "*", 
                  RowBox[{"Pi", "/", "2"}]}]}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"typeID", "\[Equal]", "\"\<PlanarUndulator\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Apply", " ", "Phase"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"modeslist", "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"1", "/", "2"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"1", "/", "4"}]}], "}"}]}], "}"}], "*", 
               "periodL"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"phase", "=", 
              RowBox[{"modeslist", "[", 
               RowBox[{"[", "mode", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"radTrfOrnt", "[", 
              RowBox[{
               RowBox[{"cassette", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"radTrfTrsl", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"phase", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "0"}], 
                 "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Apply", " ", "Rotation"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"radTrfOrnt", "[", 
              RowBox[{
               RowBox[{"cassette", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"radTrfRot", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "-", "1"}], ")"}], "*", "Pi"}]}], "]"}]}], 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"typeID", "\[Equal]", "\"\<EPU\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Apply", " ", "Phase"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"modeslist", "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", "0", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", "0", ",", 
                   RowBox[{"1", "/", "4"}], ",", "0"}], "}"}]}], "}"}], "*", 
               "periodL"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"phase", "=", 
              RowBox[{"modeslist", "[", 
               RowBox[{"[", "mode", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"radTrfOrnt", "[", 
              RowBox[{
               RowBox[{"cassette", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"radTrfTrsl", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"phase", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "0"}], 
                 "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Apply", " ", "Position"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"zdesloc", "=", 
              RowBox[{"gap", "+", 
               RowBox[{"50", "/", "2"}]}]}], ";", " ", 
             RowBox[{"ydesloc", "=", 
              RowBox[{"gap2", "+", "22"}]}], ";", " ", 
             RowBox[{"a", "=", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"blockGeo", ",", "1"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"cassPos", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "ydesloc"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "ydesloc", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "ydesloc", ",", 
                  RowBox[{"2", "*", "zdesloc"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "ydesloc"}], ",", 
                  RowBox[{"2", "*", "zdesloc"}]}], "}"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"radTrfOrnt", "[", 
              RowBox[{
               RowBox[{"cassette", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"radTrfTrsl", "[", 
                RowBox[{"cassPos", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"radObjAddToCnt", "[", 
           RowBox[{"device", ",", 
            RowBox[{"{", 
             RowBox[{"cassette", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"typeID", "\[Equal]", "\"\<DeltaUndulator\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Rotate", " ", "ID"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"radTrfOrnt", "[", 
           RowBox[{"device", ",", 
            RowBox[{"radTrfRot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{
               RowBox[{"-", "Pi"}], "/", "4"}]}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Adjust", " ", "Axis"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"device", "=", 
        RowBox[{"radTrfOrnt", "[", 
         RowBox[{"device", ",", 
          RowBox[{"radTrfRot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"device", "=", 
        RowBox[{"radTrfOrnt", "[", 
         RowBox[{"device", ",", 
          RowBox[{"radTrfRot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "device", "]"}], ";"}]}], "\[IndentingNewLine]",
      "]"}], ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.823014490528303*^9, 3.823014495190384*^9}, 
   3.823014707120387*^9, {3.8230147394315567`*^9, 3.823014785859255*^9}, {
   3.823014818123419*^9, 3.8230148551524277`*^9}, {3.8230149320362606`*^9, 
   3.8230151595401454`*^9}, {3.82301523515401*^9, 3.82301523930616*^9}, {
   3.8230153011625757`*^9, 3.8230153145790586`*^9}, {3.823015346426852*^9, 
   3.823015440912756*^9}, {3.8230154952048936`*^9, 3.823015589046316*^9}, {
   3.8230156389647827`*^9, 3.8230157093066587`*^9}, {3.8230157950208683`*^9, 
   3.823015818196389*^9}, {3.8230158550310273`*^9, 3.823015856899197*^9}, {
   3.82301589655589*^9, 3.8230160287926226`*^9}, {3.8230160954748096`*^9, 
   3.8230161430772486`*^9}, {3.8230161801045313`*^9, 
   3.8230162482305756`*^9}, {3.823017155552719*^9, 3.8230172618963366`*^9}, {
   3.8230173103204737`*^9, 3.823017324386885*^9}, {3.8230173578961453`*^9, 
   3.8230173770036907`*^9}, {3.823017429167453*^9, 3.823017441546076*^9}, {
   3.823017483875223*^9, 3.82301752294746*^9}, {3.82301757528824*^9, 
   3.8230175797173977`*^9}, {3.8230177133598576`*^9, 
   3.8230177271661406`*^9}, {3.8230180977030983`*^9, 3.823018132647981*^9}, {
   3.8230181708706784`*^9, 3.823018175451013*^9}, {3.8230182431548653`*^9, 
   3.8230182896014776`*^9}, {3.8230183297746067`*^9, 
   3.8230183849770937`*^9}, {3.8230730107420397`*^9, 
   3.8230730172046647`*^9}, {3.8230732903664494`*^9, 
   3.8230732907830653`*^9}, {3.823073399916271*^9, 3.8230734317880983`*^9}, 
   3.82307641002911*^9, {3.8230790666214886`*^9, 3.823079157390439*^9}, {
   3.8230792483506145`*^9, 3.823079288653741*^9}, {3.823080036259123*^9, 
   3.8230800377466817`*^9}, {3.8230804430590997`*^9, 3.823080468732545*^9}, {
   3.8230805936560154`*^9, 3.8230806036822357`*^9}, 3.8230807563088036`*^9, {
   3.823081091620064*^9, 3.823081192747587*^9}, {3.823081249030183*^9, 
   3.823081251031911*^9}, {3.823081283186428*^9, 3.823081361560978*^9}, {
   3.823081422224709*^9, 3.8230814760419393`*^9}, {3.8230815214337473`*^9, 
   3.823081596012384*^9}, {3.8230816519042425`*^9, 3.8230816617535725`*^9}, {
   3.8230816960983267`*^9, 3.8230816963301363`*^9}, {3.823081748309551*^9, 
   3.8230817960507383`*^9}, {3.8230822982380047`*^9, 3.823082298886798*^9}, {
   3.823082501468274*^9, 3.8230825091576753`*^9}, {3.823082579775588*^9, 
   3.8230825817976885`*^9}, {3.8230845182345076`*^9, 3.823084523880671*^9}, {
   3.8230845885099297`*^9, 3.8230846169247503`*^9}, {3.823084775516531*^9, 
   3.8230848379621525`*^9}, {3.8230850106974773`*^9, 
   3.8230850110313435`*^9}, {3.8230854741424036`*^9, 3.82308549624289*^9}, {
   3.82308553454288*^9, 3.823085733791171*^9}, 3.8230857754642315`*^9, {
   3.823085942270505*^9, 3.8230859753670526`*^9}, {3.8230860569396567`*^9, 
   3.823086151936844*^9}, {3.8230861964494*^9, 3.823086220073099*^9}, {
   3.823086893731286*^9, 3.823086917140793*^9}, {3.823086986042081*^9, 
   3.8230869863271856`*^9}, {3.8230870601118565`*^9, 3.8230870980640497`*^9}, 
   3.8230872651509314`*^9, {3.8230872973277087`*^9, 3.823087298478788*^9}, {
   3.823087343849225*^9, 3.823087346920844*^9}, {3.8230873845062685`*^9, 
   3.8230874088892193`*^9}, {3.8230874455451107`*^9, 3.823087473723867*^9}, {
   3.823087644038024*^9, 3.823087652666995*^9}, {3.8231034321711636`*^9, 
   3.8231034421704855`*^9}, {3.823103481402172*^9, 3.823103481886513*^9}, {
   3.8231035368312464`*^9, 3.823103538503008*^9}, {3.8231036109116964`*^9, 
   3.823103619661087*^9}, {3.823103713682832*^9, 3.8231037713038635`*^9}, {
   3.823168861505064*^9, 3.8231689034284477`*^9}, {3.8231691962251987`*^9, 
   3.8231692084623184`*^9}, {3.8231823843128624`*^9, 
   3.8231824027705107`*^9}, {3.823244810978146*^9, 3.8232448126824713`*^9}, 
   3.8232503842222996`*^9, {3.82369579806024*^9, 3.8236958319185133`*^9}, {
   3.823699725112361*^9, 3.823699750229452*^9}, {3.8237002284251795`*^9, 
   3.823700259842938*^9}, {3.8237004123451843`*^9, 3.823700435842682*^9}, {
   3.823700502604678*^9, 3.8237005407020674`*^9}, {3.8237011231462526`*^9, 
   3.8237011364352756`*^9}, {3.8238695375441523`*^9, 3.823869623684075*^9}, {
   3.823869738790733*^9, 3.823869824804019*^9}, {3.823870282071589*^9, 
   3.8238702964543147`*^9}, {3.8242172745836697`*^9, 
   3.8242174546706605`*^9}, {3.8242979128342113`*^9, 3.824297926820832*^9}, {
   3.8242981713154306`*^9, 3.824298173668084*^9}, {3.8242982142912807`*^9, 
   3.8242984128209863`*^9}, {3.8243099003526206`*^9, 
   3.8243099031280775`*^9}, {3.824310262362854*^9, 3.82431026578313*^9}, 
   3.824310731425861*^9, {3.824310855324407*^9, 3.824310857346639*^9}, {
   3.8244781087101817`*^9, 3.8244781131225805`*^9}, {3.824478155107996*^9, 
   3.8244781555564613`*^9}, {3.8244784078094225`*^9, 3.824478408511223*^9}, {
   3.824478459389422*^9, 3.82447846433222*^9}, 3.8285390453156333`*^9, 
   3.828716951768239*^9, {3.8287173339237537`*^9, 3.828717335534828*^9}, {
   3.828717663052723*^9, 3.8287176686674976`*^9}, {3.8287177022302227`*^9, 
   3.828717713992471*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[269]:=",ExpressionUUID->"95243fa1-4b54-4745-9acb-bc07d15f3e54"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Block Mag", "Subsection",
 CellChangeTimes->{{3.82307344716663*^9, 3.823073449705731*^9}, {
  3.8244833140919976`*^9, 
  3.8244833161836033`*^9}},ExpressionUUID->"815dbba2-f00e-4ce5-b85c-\
2e5cdeff26df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idGenerateMag", "[", 
   RowBox[{
   "typeID_", ",", "nPeriods_", ",", "periodL_", ",", "blockThick_", ",", 
    "blockGap_", ",", "symmetry_", ",", "magnAmp_", ",", 
    RowBox[{"magError_", " ", ":", "0"}], ",", 
    RowBox[{"magAmpError_", " ", ":", "0.02"}], ",", 
    RowBox[{"magTheta_", " ", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mag", ",", "magnetization", ",", "j", ",", "i", ",", "termination", 
        ",", "phi", ",", "theta", ",", "dmag"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"===", 
        RowBox[{"==", " ", 
         RowBox[{"ID", " ", "Type"}]}], " ", "===", "=="}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"typeID", "\[Equal]", "\"\<DeltaUndulator\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mag", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}]}], 
            "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"typeID", "\[Equal]", "\"\<PlanarUndulator\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mag", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}]}], 
            "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"typeID", "\[Equal]", "\"\<EPU\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mag", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}]}], 
            "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", 
          RowBox[{"Create", " ", "Cassette", " ", "Magnetizations"}]}], " ", "===",
          "=="}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"magnetization", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"Length", "[", "mag", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "mag", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"magnetization", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "=", 
           RowBox[{"Nest", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"mag", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "#", ",", "1"}], "]"}], 
              "&"}], ",", 
             RowBox[{"mag", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{"nPeriods", "-", "1"}], ")"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"symmetry", "\[Equal]", "\"\<symmetric\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"magnetization", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"magnetization", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"magnetization", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"magnetization", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"magnetization", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", 
          RowBox[{"Generate", " ", "Errors"}]}], " ", "===", "=="}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"phi", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"2", "*", "Pi"}]}], "}"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"magnetization", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"phi", "=", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{"phi", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "magnetization", "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"magnetization", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"theta", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomVariate", "[", 
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"magTheta", "*", 
                RowBox[{"Pi", "/", "180"}]}], ")"}], "/", "3"}]}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"magnetization", ",", "1"}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"theta", "=", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{"theta", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "magnetization", "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"magnetization", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"magError", "\[GreaterEqual]", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dmag", "=", 
           RowBox[{"1", "+", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RandomVariate", "[", 
               RowBox[{"NormalDistribution", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"magAmpError", "/", "3"}]}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"magnetization", ",", "1"}], "]"}], "]"}]}], 
               "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"dmag", "=", 
           RowBox[{"ArrayReshape", "[", 
            RowBox[{"dmag", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Length", "[", "magnetization", "]"}], ",", 
               RowBox[{"Length", "[", 
                RowBox[{"magnetization", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          ";"}], " ", "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dmag", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Length", "[", "magnetization", "]"}], ",", 
               RowBox[{"Length", "[", 
                RowBox[{"magnetization", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"phi", "=", 
           RowBox[{"phi", "*", "0"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"theta", "=", 
           RowBox[{"theta", "*", "0"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", 
          RowBox[{"Apply", " ", "Errors"}]}], " ", "===", "=="}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "magnetization", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"magnetization", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"magnetization", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"dmag", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", " ", 
             RowBox[{"Length", "[", 
              RowBox[{"magnetization", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"j", ",", "2"}], "]"}], "\[LessEqual]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"magnetization", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"RotationMatrix", "[", 
                   RowBox[{
                    RowBox[{"phi", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
                  RowBox[{"RotationMatrix", "[", 
                   RowBox[{
                    RowBox[{"theta", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ".", 
                  RowBox[{"magnetization", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"magnetization", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"RotationMatrix", "[", 
                   RowBox[{
                    RowBox[{"phi", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ".", 
                  RowBox[{"RotationMatrix", "[", 
                   RowBox[{
                    RowBox[{"theta", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ".", 
                  RowBox[{"magnetization", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "magnetization", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.8230734534311275`*^9, 3.823073498743161*^9}, {
   3.823075016818911*^9, 3.823075044652527*^9}, {3.8230751290188866`*^9, 
   3.8230752098574543`*^9}, {3.8230752693348317`*^9, 3.82307540483144*^9}, {
   3.8230757221025333`*^9, 3.823075756273844*^9}, {3.8230757939158564`*^9, 
   3.8230758700511312`*^9}, {3.82307590252705*^9, 3.823075933758606*^9}, {
   3.823076257369628*^9, 3.823076364633091*^9}, {3.823076453604336*^9, 
   3.8230765781781797`*^9}, {3.823076644979904*^9, 3.823076695274355*^9}, {
   3.8230770058948307`*^9, 3.8230770084077177`*^9}, {3.823077349822297*^9, 
   3.8230773514441357`*^9}, {3.8230820484647884`*^9, 
   3.8230820946947174`*^9}, {3.823082181483632*^9, 3.823082236344793*^9}, {
   3.8230824247981653`*^9, 3.823082486133391*^9}, {3.8230839381123133`*^9, 
   3.823083996799473*^9}, {3.823084274437377*^9, 3.8230842854884768`*^9}, {
   3.8230843243364267`*^9, 3.823084333174412*^9}, {3.8231634883441477`*^9, 
   3.8231634901329365`*^9}, {3.823164409635227*^9, 3.823164427347066*^9}, {
   3.823164887253832*^9, 3.823164994738323*^9}, {3.823165084312823*^9, 
   3.8231651458201084`*^9}, {3.823165264273618*^9, 3.8231653688733187`*^9}, {
   3.8231662766432533`*^9, 3.8231662976834583`*^9}, {3.823166331113245*^9, 
   3.8231663484899426`*^9}, {3.823166433319851*^9, 3.8231664587339535`*^9}, {
   3.823166808686659*^9, 3.8231668551448126`*^9}, {3.8231673321944437`*^9, 
   3.823167336637915*^9}, 3.823167507385802*^9, {3.8231676818278546`*^9, 
   3.8231679035181074`*^9}, {3.8231679338007607`*^9, 
   3.8231679505746174`*^9}, {3.823168014143445*^9, 3.823168021969261*^9}, {
   3.823168053681142*^9, 3.823168152061553*^9}, {3.823168198572253*^9, 
   3.8231682193498983`*^9}, {3.8231682608542705`*^9, 3.823168310397355*^9}, {
   3.823168397219083*^9, 3.8231684132232447`*^9}, {3.823168497846359*^9, 
   3.823168504014089*^9}, {3.823168535380496*^9, 3.8231685712377386`*^9}, {
   3.8231686370672607`*^9, 3.823168678721874*^9}, {3.8231694448479834`*^9, 
   3.823169455466977*^9}, {3.8231694887802706`*^9, 3.823169491706731*^9}, {
   3.8231702639630156`*^9, 3.823170274526148*^9}, {3.823170377886963*^9, 
   3.8231703870855613`*^9}, 3.823182407012419*^9, {3.823186139758232*^9, 
   3.8231861559214954`*^9}, {3.8231862021673145`*^9, 3.823186202486143*^9}, {
   3.8231867584713717`*^9, 3.8231867636927443`*^9}, {3.8236950985149264`*^9, 
   3.823695100003189*^9}, {3.8237002832307777`*^9, 3.8237002885744967`*^9}, {
   3.823700435858307*^9, 3.823700435889533*^9}, {3.823700744763332*^9, 
   3.823700773077844*^9}, {3.823703471995745*^9, 3.8237034728533893`*^9}, {
   3.824298734968963*^9, 3.824298874507926*^9}, {3.8242989265188913`*^9, 
   3.824298979826383*^9}, {3.82429901300655*^9, 3.824299013576806*^9}, {
   3.8243094972665167`*^9, 3.8243095009805183`*^9}, {3.824309581832575*^9, 
   3.824309583351427*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[270]:=",ExpressionUUID->"c6e471c8-d370-41aa-b90d-ea83ddd693a5"]
}, Closed]],

Cell[CellGroupData[{

Cell["GenerateTermination Mag", "Subsection",
 CellChangeTimes->{{3.823077365329194*^9, 3.823077385215308*^9}, {
  3.824483321113908*^9, 
  3.8244833238509316`*^9}},ExpressionUUID->"2471c28d-facd-48e0-9fe9-\
b02242a87935"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idGenerateTerm", "[", 
   RowBox[{
   "termType_", ",", "blockThick_", ",", "blockGap_", ",", "periodL_", ",", 
    "magnAmp_", ",", 
    RowBox[{"magFront_", " ", ":", 
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}]}], ",", 
    RowBox[{"magBack_", " ", ":", 
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"(", "\n", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "termination", ",", "termMagFront", ",", "termMagBack", ",", 
        "termBlockThick", ",", "termBlockGap"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", "ThreeBlocksAntiSym"}]}]}], " ", 
         RowBox[{
          RowBox[{"Termination", " ", "--"}], "--"}]}], "-"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"termType", "\[Equal]", "\"\<ThreeBlocksAntiSym\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"magFront", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             "3"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagFront", "=", "magFront"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagFront", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}]}], 
               "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"magBack", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             "3"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagBack", "=", "magBack"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagBack", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}]}], 
               "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"termBlockThick", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "4"}], ",", 
              RowBox[{"1", "/", "2"}], ",", 
              RowBox[{"3", "/", "4"}]}], "}"}], "*", "blockThick"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"termBlockGap", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"0.875", "*", 
               RowBox[{"periodL", "/", "4"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.25", "+", "0.5"}], ")"}], "/", "2"}], "*", 
                "blockThick"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"0.875", "*", 
               RowBox[{"periodL", "/", "4"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.5", "+", "0.75"}], ")"}], "/", "2"}], "*", 
                "blockThick"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"0.875", "*", 
               RowBox[{"periodL", "/", "4"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.75", "+", "1"}], ")"}], "/", "2"}], "*", 
                "blockThick"}], ")"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"termination", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"termMagFront", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "termBlockThick", ",", 
               "termBlockGap", ",", 
               RowBox[{"termMagBack", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"Reverse", "[", "termBlockThick", "]"}], ",", 
               RowBox[{"Reverse", "[", "termBlockGap", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "termMagFront", "]"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", 
            RowBox[{
             RowBox[{"ThreeBlocksAntiSymReal", " ", "--"}], "--"}]}]}]}], 
         "-"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"termType", "\[Equal]", "\"\<ThreeBlocksAntiSymReal\>\""}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"magFront", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             "6"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagFront", "=", "magFront"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagFront", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}]}], 
               "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"magBack", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             "6"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagBack", "=", "magBack"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagBack", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}]}], 
               "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"termBlockThick", "=", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0.25", ",", "6"}], "]"}], "*", "blockThick"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"termBlockGap", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"0.875", "*", 
               RowBox[{"periodL", "/", "4"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.25", "+", "0.5"}], ")"}], "/", "2"}], "*", 
                "blockThick"}], ")"}]}], ",", "0.0", ",", 
             RowBox[{
              RowBox[{"0.875", "*", 
               RowBox[{"periodL", "/", "4"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.5", "+", "0.75"}], ")"}], "/", "2"}], "*", 
                "blockThick"}], ")"}]}], ",", "0.0", ",", "0.0", ",", 
             RowBox[{
              RowBox[{"0.875", "*", 
               RowBox[{"periodL", "/", "4"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.75", "+", "1"}], ")"}], "/", "2"}], "*", 
                "blockThick"}], ")"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"termination", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"termMagFront", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "termBlockThick", ",", 
               "termBlockGap", ",", 
               RowBox[{"termMagBack", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"Reverse", "[", "termBlockThick", "]"}], ",", 
               RowBox[{"Reverse", "[", "termBlockGap", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "termMagFront", "]"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", 
            RowBox[{
             RowBox[{"FourBlocksAntiSym", " ", "--"}], "--"}]}]}]}], "-"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"termType", "\[Equal]", "\"\<FourBlocksAntiSym\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"magFront", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             "4"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagFront", "=", "magFront"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagFront", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}]}], 
               "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"magBack", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             "4"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagBack", "=", "magBack"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagBack", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}]}], 
                 "}"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"termBlockThick", "=", 
           RowBox[{"{", 
            RowBox[{"3.25", ",", "3.25", ",", "9.75", ",", "9.75"}], "}"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"termBlockGap", "=", 
           RowBox[{"{", 
            RowBox[{"8.7", ",", "2.0", ",", "3.3", ",", "1.0"}], "}"}]}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"termination", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"termMagFront", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "termBlockThick", ",", 
               "termBlockGap", ",", 
               RowBox[{"termMagBack", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"Reverse", "[", "termBlockThick", "]"}], ",", 
               RowBox[{"Reverse", "[", "termBlockGap", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "termMagFront", "]"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", 
            RowBox[{
             RowBox[{"FourBlocksAntiSymReal", " ", "--"}], "--"}]}]}]}], 
         "-"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"termType", "\[Equal]", "\"\<FourBlocksAntiSymReal\>\""}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"magFront", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             "8"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagFront", "=", "magFront"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagFront", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}]}], 
               "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"magBack", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             "8"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagBack", "=", "magBack"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagBack", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}]}], 
                 "}"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"termBlockThick", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"3.25", ",", "8"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"termBlockGap", "=", 
           RowBox[{"{", 
            RowBox[{
            "8.7", ",", "2", ",", "0", ",", "0", ",", "3.3", ",", "0", ",", 
             "0", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"termination", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"termMagFront", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "termBlockThick", ",", 
               "termBlockGap", ",", 
               RowBox[{"termMagBack", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"Reverse", "[", "termBlockThick", "]"}], ",", 
               RowBox[{"Reverse", "[", "termBlockGap", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "termMagFront", "]"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", " ", "Three"}]}]}], " ", "Blocks", " ", "Symmetric", 
          " ", 
          RowBox[{
           RowBox[{"Termination", " ", "--"}], "--"}]}], "-"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"termType", "\[Equal]", "\"\<ThreeBlockSym\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"magFront", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             "3"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagFront", "=", "magFront"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagFront", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}]}], 
               "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"magBack", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
             "3"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagBack", "=", "magBack"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"termMagBack", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"magnAmp", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "magnAmp"}], ",", "0", ",", "0"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "magnAmp"}]}], "}"}]}], "}"}]}], "}"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"termBlockThick", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "4"}], ",", 
              RowBox[{"1", "/", "2"}], ",", 
              RowBox[{"3", "/", "4"}]}], "}"}], "*", "blockThick"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"termBlockGap", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"0.875", "*", 
               RowBox[{"periodL", "/", "4"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.25", "+", "0.5"}], ")"}], "/", "2"}], "*", 
                "blockThick"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"0.875", "*", 
               RowBox[{"periodL", "/", "4"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.5", "+", "0.75"}], ")"}], "/", "2"}], "*", 
                "blockThick"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"0.875", "*", 
               RowBox[{"periodL", "/", "4"}]}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.75", "+", "1"}], ")"}], "/", "2"}], "*", 
                "blockThick"}], ")"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"termination", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"termMagFront", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "termBlockThick", ",", 
               "termBlockGap", ",", 
               RowBox[{"termMagBack", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"Reverse", "[", "termBlockThick", "]"}], ",", 
               RowBox[{"Reverse", "[", "termBlockGap", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "termMagFront", "]"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", " ", "Simple"}]}]}], " ", "Half", " ", "Block", " ", 
          RowBox[{
           RowBox[{"Termination", " ", "--"}], "--"}]}], "-"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"termType", "\[Equal]", "\"\<Simple-Half\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"termination", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], "}"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", "/", "2"}], "}"}], "*", "blockThick"}], ",", 
             RowBox[{"{", "blockGap", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "magnAmp"}], "}"}], "}"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", "/", "2"}], "}"}], "*", "blockThick"}], ",", 
             RowBox[{"{", "blockGap", "}"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "termination", "]"}]}]}], "\[IndentingNewLine]",
      "]"}], ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.823077388324053*^9, 3.8230775391130724`*^9}, {
   3.8230777224241376`*^9, 3.82307772312562*^9}, {3.8230777539262333`*^9, 
   3.8230777676816993`*^9}, {3.8230778168795457`*^9, 3.823077821286316*^9}, {
   3.823077882487821*^9, 3.8230780000171394`*^9}, {3.8230780734814634`*^9, 
   3.823078115911222*^9}, {3.823078161927266*^9, 3.823078215057619*^9}, {
   3.823078459139248*^9, 3.8230784675215654`*^9}, 3.823078961415109*^9, 
   3.8230790019678316`*^9, {3.8230825164479275`*^9, 3.8230825600754433`*^9}, {
   3.823182410528599*^9, 3.82318242401606*^9}, 3.823182492143036*^9, {
   3.8231891579553156`*^9, 3.823189183599577*^9}, {3.8231895867537727`*^9, 
   3.8231896174089127`*^9}, {3.8231896778652077`*^9, 3.823189688726184*^9}, {
   3.823189737114155*^9, 3.823189791330197*^9}, {3.8232430751026955`*^9, 
   3.823243171912265*^9}, {3.823243769112008*^9, 3.8232437720961933`*^9}, {
   3.823243820686617*^9, 3.823243966423137*^9}, {3.8232440100296216`*^9, 
   3.8232441953904905`*^9}, {3.8232442827027864`*^9, 
   3.8232442874681225`*^9}, {3.8232444097488794`*^9, 3.82324443945625*^9}, {
   3.823244570602457*^9, 3.823244574569581*^9}, {3.823244657773608*^9, 
   3.8232446668667994`*^9}, {3.8232447237219286`*^9, 3.823244768820605*^9}, {
   3.8232459233613625`*^9, 3.8232459491328554`*^9}, {3.8232512039111924`*^9, 
   3.823251249200403*^9}, {3.823254204920805*^9, 3.823254217787286*^9}, {
   3.823254398026204*^9, 3.8232544561325765`*^9}, {3.8236950906935635`*^9, 
   3.82369509228386*^9}, {3.824456494012184*^9, 3.8244565016029377`*^9}, {
   3.8244565440917025`*^9, 3.8244566121689973`*^9}, {3.8244566453900905`*^9, 
   3.8244567855934877`*^9}, {3.8244568546066084`*^9, 
   3.8244568881108236`*^9}, {3.824457284128724*^9, 3.8244573137597127`*^9}, {
   3.824474927357209*^9, 3.824475172172876*^9}, {3.824475216200239*^9, 
   3.8244753413548307`*^9}, {3.824475385717245*^9, 3.824475425665414*^9}, {
   3.8244755599814577`*^9, 3.8244755758302746`*^9}, {3.8244756849089127`*^9, 
   3.824475788955386*^9}, {3.8244763523070498`*^9, 3.8244764033822184`*^9}, {
   3.8248030472881613`*^9, 3.8248030500654383`*^9}, {3.8284494050049953`*^9, 
   3.8284495089094315`*^9}, {3.8284495720771713`*^9, 
   3.8284495729743443`*^9}, {3.828449616962294*^9, 3.8284496532272396`*^9}, {
   3.828449685457864*^9, 3.8284496986825743`*^9}, {3.828449733183283*^9, 
   3.828449878987145*^9}, {3.8284499336834383`*^9, 3.8284499809514394`*^9}, {
   3.828450018589729*^9, 3.8284500188660975`*^9}, {3.8284500992815876`*^9, 
   3.828450179300597*^9}, {3.828450303698753*^9, 3.8284503638169703`*^9}, {
   3.828450434682233*^9, 3.8284504425680375`*^9}, {3.8284504761337643`*^9, 
   3.828450536989496*^9}, {3.8284505745322504`*^9, 3.828450648671833*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[271]:=",ExpressionUUID->"9755bac4-8b7b-40fc-b78a-09929cccd3e6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8232443463650265`*^9, 3.823244350895966*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"d71f2df0-3388-4b01-93c1-90c27c360ae1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sorting Import Mag", "Subsection",
 CellChangeTimes->{{3.8243777668672123`*^9, 3.824377768615138*^9}, {
  3.8251689798236084`*^9, 
  3.825168981042043*^9}},ExpressionUUID->"3bfd9293-4ca8-4015-8a66-\
b17a4bc25a6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idSortingImportMag", "[", 
   RowBox[{
    RowBox[{"fileName_", " ", ":", "\"\<Magnetizations.xlsx\>\""}], ",", 
    RowBox[{"headLine_", " ", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dir", ",", "M", ",", "file", ",", "listMag0", ",", "listMag"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dir", "=", 
        RowBox[{"NotebookDirectory", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"fileName", "=", "\"\<Magnetizations.xlsx\>\""}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"file", "=", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"dir", ",", "fileName"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Import", "[", "file", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"M", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"listMag0", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"headLine", "+", "1"}], ";;", 
                RowBox[{"-", "1"}]}], ",", "5"}], "]"}], "]"}], ",", 
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"headLine", "+", "1"}], ";;", 
                RowBox[{"-", "1"}]}], ",", "7"}], "]"}], "]"}], ",", 
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"headLine", "+", "1"}], ";;", 
                RowBox[{"-", "1"}]}], ",", "8"}], "]"}], "]"}], ",", 
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"headLine", "+", "1"}], ";;", 
                RowBox[{"-", "1"}]}], ",", "9"}], "]"}], "]"}]}], "}"}], ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"listMag", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"listMag0", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"listMag0", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"listMag0", "[", 
               RowBox[{"[", 
                RowBox[{"4", ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"listMag0", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"listMag0", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "listMag", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.824377496478594*^9, 3.824377643408783*^9}, {
  3.824377689786902*^9, 3.824377695751958*^9}, {3.8243777877705154`*^9, 
  3.824377794723044*^9}, {3.825168931620708*^9, 3.825168932493845*^9}, {
  3.828451384493122*^9, 3.828451410241861*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[273]:=",ExpressionUUID->"26df87e0-4b9c-40b2-8c5e-2095ecb2f30b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sorting Export Mag", "Subsection",
 CellChangeTimes->{{3.824377815753742*^9, 3.8243778173061824`*^9}, {
  3.8251690181532774`*^9, 
  3.825169019127555*^9}},ExpressionUUID->"bbdc4e46-8c0c-4894-9793-\
c9ffaa8c8176"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idExportMag", "[", 
   RowBox[{"listMag_", ",", 
    RowBox[{"expFileName_", " ", ":", "\"\<Magnetizations.xlsx\>\""}]}], 
   "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dir", ",", "exportMtx"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dir", "=", 
        RowBox[{"NotebookDirectory", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"exportMtx", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<B-\>\"", ",", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"listMag", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "listMag", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{"dir", ",", "expFileName"}], "]"}], ",", "exportMtx"}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.8243773569906626`*^9, 3.82437747434363*^9}, {
  3.824377828350154*^9, 3.8243778591083345`*^9}, {3.824386626566094*^9, 
  3.824386630744977*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[274]:=",ExpressionUUID->"dbd358d7-3966-4297-8250-9e95954ad690"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solve", "Subsection",
 CellChangeTimes->{{3.823101241444908*^9, 
  3.823101241946697*^9}},ExpressionUUID->"617a9e25-d1cf-4046-96f6-\
8268964adeef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idSolve", "[", 
   RowBox[{"device_", ",", 
    RowBox[{"randomization_", " ", ":", 
     RowBox[{"{", 
      RowBox[{"1*^-9", ",", "1*^-9", ",", "1*^-9"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "abs", ",", "rel", ",", "zero", ",", "re", ",", "t0", ",", "t1"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"radFldLenTol", "[", 
       RowBox[{
        RowBox[{"randomization", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"randomization", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"randomization", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"re", "=", 
       RowBox[{"RadSolve", "[", 
        RowBox[{"device", ",", "1*^-9", ",", "10000"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.8231012542546206`*^9, 3.823101475857891*^9}, {
   3.8231015672653685`*^9, 3.8231015836798697`*^9}, {3.823101804028384*^9, 
   3.8231018202029514`*^9}, {3.823101852520878*^9, 3.823101890771188*^9}, {
   3.8236947126690063`*^9, 3.823694713433855*^9}, {3.8236950828901577`*^9, 
   3.8236950831981707`*^9}, {3.8236992735182495`*^9, 
   3.8236992747378654`*^9}, {3.82369995944013*^9, 3.823699960073349*^9}, {
   3.823700548099455*^9, 3.8237005735050817`*^9}, {3.823700729427281*^9, 
   3.8237007325052023`*^9}, {3.8242895354587684`*^9, 3.8242895408484125`*^9}, 
   3.8243780423600035`*^9, {3.828628936935359*^9, 3.82862896404826*^9}, {
   3.8286289979030275`*^9, 3.8286290200623665`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[275]:=",ExpressionUUID->"e2ff82c5-dc8b-4a3a-b2dc-2a85fef9fa01"]
}, Closed]],

Cell[CellGroupData[{

Cell["Field Calc", "Subsection",
 CellChangeTimes->{{3.8070274156221814`*^9, 
  3.80702741715819*^9}},ExpressionUUID->"0bd4213d-5884-4c30-aab9-\
17fbbdf212a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idField", "[", 
   RowBox[{"undulator_", ",", "li_", ",", "lf_", ",", "lNpts_", ",", 
    RowBox[{"{", 
     RowBox[{"posV_", ",", "posH_"}], "}"}], ",", "display_", ",", 
    "oneplot_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lstep", ",", "t0", ",", "t1", ",", "baxis", ",", "btotal", ",", 
        "axispoints", ",", "plot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lstep", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"lf", "-", "li"}], ")"}], "/", "lNpts"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t0", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", " ", "Axis"}]}]}], " ", "Field", " ", 
          RowBox[{
           RowBox[{"Calc", " ", "--"}], "--"}]}], "-"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"baxis", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"radFld", "[", 
           RowBox[{"undulator", ",", "\"\<b\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"posH", ",", "posV", ",", "z"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "li", ",", 
            RowBox[{"lf", "-", "lstep"}], ",", "lstep"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"t1", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<> Field Components: (elapsed time: \>\"", ",", 
           RowBox[{"t1", "-", "t0"}], " ", ",", "\"\<[s])\>\""}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", 
            RowBox[{
             RowBox[{"Plots", " ", "--"}], "--"}]}]}]}], "-"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"display", "\[GreaterEqual]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plot", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", "3"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Axis", " ", "Plot"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"axispoints", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"li", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}], "*", "lstep"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", "lNpts"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"plot", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"axispoints", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"baxis", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "lNpts"}], "}"}]}], "]"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Z [mm]\>\"", ",", "12"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Magnetic Field [T]\>\"", ",", "12"}], "]"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"{", "\"\<Bx\>\"", "}"}], ",", "Above"}], "]"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"plot", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"axispoints", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"baxis", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "lNpts"}], "}"}]}], "]"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Z [mm]\>\"", ",", "12"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Magnetic Field [T]\>\"", ",", "12"}], "]"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", "Orange", "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"{", "\"\<By\>\"", "}"}], ",", "Above"}], "]"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"plot", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "=", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"axispoints", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"baxis", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "lNpts"}], "}"}]}], "]"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Z [mm]\>\"", ",", "12"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Magnetic Field [T]\>\"", ",", "12"}], "]"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", "Green", "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"{", "\"\<Bz\>\"", "}"}], ",", "Above"}], "]"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"oneplot", "\[GreaterEqual]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"maxims", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"baxis", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"plotOrder", "=", 
              RowBox[{"SortBy", "[", 
               RowBox[{"maxims", ",", "Last"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"Show", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"plot", "[", 
                  RowBox[{"[", 
                   RowBox[{"plotOrder", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "i"}], ",", "1"}], "]"}], "]"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], 
              "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"GraphicsRow", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"plot", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"plot", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"plot", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"Spacings", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "10"}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"1200", ",", "300"}], "}"}]}], ",", 
                RowBox[{"AspectRatio", "\[Rule]", "Full"}]}], "]"}], "]"}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "baxis", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.807021601830374*^9, 3.8070216773569517`*^9}, {
   3.807021740669018*^9, 3.8070217427074785`*^9}, {3.8070219464604225`*^9, 
   3.8070219686498995`*^9}, {3.807027460652296*^9, 3.807027544157159*^9}, {
   3.8070276421693325`*^9, 3.8070276425165777`*^9}, {3.8070276912558517`*^9, 
   3.807027704213709*^9}, {3.8070323107786245`*^9, 3.807032375602537*^9}, 
   3.8070327114498105`*^9, {3.807032863171875*^9, 3.8070328649457016`*^9}, {
   3.8070328976293025`*^9, 3.8070328977452354`*^9}, {3.807033015423561*^9, 
   3.807033015762494*^9}, {3.8070333677594614`*^9, 3.807033370758465*^9}, {
   3.8070341000936403`*^9, 3.8070341100237904`*^9}, {3.807034177639553*^9, 
   3.8070341787814217`*^9}, {3.8194469942722526`*^9, 3.819446994522252*^9}, {
   3.8194470278451247`*^9, 3.8194470523151627`*^9}, {3.8194674188594513`*^9, 
   3.8194674192906275`*^9}, {3.8195394042588143`*^9, 3.819539434664993*^9}, {
   3.8231870748067555`*^9, 3.8231870801366234`*^9}, {3.823187314238055*^9, 
   3.8231873210731883`*^9}, {3.8231873536805687`*^9, 
   3.8231873840152335`*^9}, {3.823187417400039*^9, 3.823187517278927*^9}, {
   3.823187552114496*^9, 3.823187563147745*^9}, {3.82318760058611*^9, 
   3.8231876260825243`*^9}, {3.8231877078144464`*^9, 3.823187725129961*^9}, {
   3.8231879045592556`*^9, 3.823187931896818*^9}, {3.8232513833748417`*^9, 
   3.8232514195547705`*^9}, {3.823251497810341*^9, 3.8232514994936705`*^9}, {
   3.8232515364914045`*^9, 3.823251597789898*^9}, 3.823591182639825*^9, {
   3.8236878454585176`*^9, 3.823687854520048*^9}, 3.823694762646657*^9, 
   3.8236962514318132`*^9, {3.823696360981367*^9, 3.823696480996597*^9}, {
   3.8236965553748913`*^9, 3.8236965670363555`*^9}, 3.8236966216015263`*^9, {
   3.8237043866839724`*^9, 3.823704437544327*^9}, {3.8237045083803515`*^9, 
   3.8237045826236615`*^9}, {3.8237046303449583`*^9, 3.8237046307197495`*^9}, 
   3.8237046806966157`*^9, {3.8237047552280135`*^9, 3.8237048088535647`*^9}, {
   3.8237049077224045`*^9, 3.823704942624758*^9}, {3.8237049756552896`*^9, 
   3.823705086703352*^9}, {3.823705206613536*^9, 3.823705263296739*^9}, {
   3.823705347657188*^9, 3.823705353686869*^9}, {3.8237053977027655`*^9, 
   3.8237053995608683`*^9}, {3.823705438733055*^9, 3.823705520061475*^9}, {
   3.8237056668621016`*^9, 3.823705739843643*^9}, {3.8237062931455593`*^9, 
   3.8237063045510206`*^9}, 3.8243780575048585`*^9, {3.824560310124625*^9, 
   3.8245603368090415`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[276]:=",ExpressionUUID->"7b07522a-1392-4257-a7c0-1c250cb2558d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Field Integral", "Subsection",
 CellChangeTimes->{{3.814026445667639*^9, 3.814026469231636*^9}, {
  3.8233349297908735`*^9, 3.823334930948099*^9}, {3.823340078829421*^9, 
  3.823340079713853*^9}},ExpressionUUID->"ff06735a-5dcd-4af4-b5d1-\
524b67fccf9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idFieldInt", "[", 
   RowBox[{
   "undulator_", ",", "li_", ",", "lf_", ",", "lstep_", ",", "baxis_", ",", 
    "display_", ",", "oneplot_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "dz", ",", "area", ",", "area2", ",", "integral", ",", 
        "integral2", ",", "firstInt", ",", "secondInt", ",", "axispoints", 
        ",", "plot", ",", "t0", ",", "t1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", "First"}]}]}], " ", 
         RowBox[{
          RowBox[{"Integral", " ", "--"}], "--"}]}], "-"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t0", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dz", "=", "lstep"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"area", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"baxis", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
                RowBox[{"baxis", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}],
               "/", "2"}], "*", "dz"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"baxis", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                RowBox[{"baxis", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], ")"}],
               "/", "2"}], "*", "dz"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"baxis", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], "+", 
                RowBox[{"baxis", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "3"}], "]"}], "]"}]}], ")"}],
               "/", "2"}], "*", "dz"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "baxis", "]"}], "-", "1"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"integral", "=", 
        RowBox[{"Accumulate", "[", "area", "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"T", ".", "mm"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"firstInt", "=", 
        RowBox[{"integral", "*", 
         RowBox[{
          RowBox[{"10", "^", "4"}], "/", "10"}]}]}], " ", ";", 
       RowBox[{"(*", 
        RowBox[{"G", ".", "cm"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", " ", "Second"}]}]}], " ", 
          RowBox[{
           RowBox[{"Integral", " ", "--"}], "--"}]}], "-"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"area2", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"integral", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
                RowBox[{"integral", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}],
               "/", "2"}], "*", "dz"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"integral", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                RowBox[{"integral", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], ")"}],
               "/", "2"}], "*", "dz"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"integral", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], "+", 
                RowBox[{"integral", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "3"}], "]"}], "]"}]}], ")"}],
               "/", "2"}], "*", "dz"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "integral", "]"}], "-", "1"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"integral2", "=", 
        RowBox[{"Accumulate", "[", "area2", "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"T", ".", "mm\.b2"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"secondInt", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"integral2", "*", 
           RowBox[{
            RowBox[{"10", "^", "4"}], "/", "100"}]}], ")"}], "/", "1000"}]}], 
       ";", " ", 
       RowBox[{"(*", 
        RowBox[{"kG", ".", "cm\.b2"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"t1", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<> Field Integrals: elapsed time = \>\"", ",", 
           RowBox[{"(", 
            RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< [s]\>\""}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<First integrals : \>\"", ",", " ", 
           RowBox[{"firstInt", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", "\"\< [G.cm]\>\""}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Second integrals : \>\"", ",", " ", 
           RowBox[{"secondInt", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", "\"\< [kG.cm\.b2]\>\""}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", 
            RowBox[{
             RowBox[{"Plots", " ", "--"}], "--"}]}]}]}], "-"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"display", "\[GreaterEqual]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plot", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", "3"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"axispoints", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"li", "+", 
                RowBox[{"lstep", "/", "2"}]}], ")"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}], "*", "lstep"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", 
               RowBox[{
                RowBox[{"Length", "[", "baxis", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"plot", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"axispoints", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"firstInt", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "firstInt", "]"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Z [mm]\>\"", ",", "12"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Field Integral [G.cm]\>\"", ",", "12"}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"{", "\"\<Bx\>\"", "}"}], ",", "Above"}], "]"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"plot", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"axispoints", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"firstInt", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "firstInt", "]"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Z [mm]\>\"", ",", "12"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Field integral [G.cm]\>\"", ",", "12"}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", "Orange", "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"{", "\"\<By\>\"", "}"}], ",", "Above"}], "]"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"plot", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "=", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"axispoints", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"firstInt", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "firstInt", "]"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Z [mm]\>\"", ",", "12"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Field integral [G.cm]\>\"", ",", "12"}], 
                 "]"}]}], "}"}]}], ",", 
             RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", "Green", "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"{", "\"\<Bz\>\"", "}"}], ",", "Above"}], "]"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"oneplot", "\[GreaterEqual]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"maxims", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"firstInt", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"plotOrder", "=", 
              RowBox[{"SortBy", "[", 
               RowBox[{"maxims", ",", "Last"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"Show", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"plot", "[", 
                  RowBox[{"[", 
                   RowBox[{"plotOrder", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "i"}], ",", "1"}], "]"}], "]"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], 
              "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"GraphicsRow", "[", 
               RowBox[{"plot", ",", 
                RowBox[{"Spacings", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "10"}], "}"}]}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"1200", ",", "300"}], "}"}]}], ",", 
                RowBox[{"AspectRatio", "\[Rule]", "Full"}]}], "]"}], "]"}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"firstInt", ",", "secondInt"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.8140831822358985`*^9, 3.8140831876421633`*^9}, {
   3.814086465640315*^9, 3.8140865066842995`*^9}, {3.8140865964970884`*^9, 
   3.8140865981532955`*^9}, {3.814086641081032*^9, 3.814086745326576*^9}, {
   3.814091940740308*^9, 3.81409216828543*^9}, {3.8140922070042057`*^9, 
   3.814092211910432*^9}, {3.8140922845491157`*^9, 3.81409229812846*^9}, {
   3.8140923644442186`*^9, 3.814092402186119*^9}, {3.814092442050935*^9, 
   3.8140925391396513`*^9}, {3.8140925886417274`*^9, 3.814092786016214*^9}, {
   3.814092830172215*^9, 3.814092831750367*^9}, {3.8140989604331417`*^9, 
   3.8140990283194375`*^9}, {3.8141904990742135`*^9, 
   3.8141905074645224`*^9}, {3.8141905462993636`*^9, 3.814190576361436*^9}, {
   3.818847692695892*^9, 3.818847728759572*^9}, {3.818847799042203*^9, 
   3.818847821133772*^9}, {3.81955032845391*^9, 3.8195503504551272`*^9}, 
   3.8195504519073086`*^9, {3.819550526202839*^9, 3.819550526890369*^9}, 
   3.820662992112262*^9, {3.8232580185147114`*^9, 3.8232580213808613`*^9}, {
   3.8233345165429583`*^9, 3.8233345209211493`*^9}, {3.823334659889905*^9, 
   3.823334733835789*^9}, {3.82333476894271*^9, 3.823334801012831*^9}, {
   3.823334869528743*^9, 3.8233349144518986`*^9}, {3.82333494728961*^9, 
   3.8233349479068537`*^9}, {3.8233349789943514`*^9, 3.823335018022991*^9}, {
   3.8233350527305984`*^9, 3.823335090140766*^9}, {3.823335165354349*^9, 
   3.823335166820796*^9}, {3.8233352039459114`*^9, 3.823335258897461*^9}, {
   3.823335300779319*^9, 3.8233353011492014`*^9}, 3.8233361506222687`*^9, {
   3.8233363710789537`*^9, 3.8233363736177607`*^9}, {3.823338572724375*^9, 
   3.8233387668264074`*^9}, {3.823340224739589*^9, 3.823340231024663*^9}, {
   3.8233431300198727`*^9, 3.823343132608755*^9}, {3.8233437850270348`*^9, 
   3.8233437857604227`*^9}, {3.82334389459583*^9, 3.823343937511688*^9}, {
   3.8233440492960243`*^9, 3.8233440594352922`*^9}, 3.823678669078288*^9, {
   3.82368779374298*^9, 3.823687804359678*^9}, 3.823694798563027*^9, {
   3.8236949090853324`*^9, 3.8236949097027383`*^9}, 3.823696675945222*^9, {
   3.8236967476201906`*^9, 3.8236967643927984`*^9}, 3.8237022017126327`*^9, {
   3.8237023062168875`*^9, 3.823702307791808*^9}, {3.8237027123281775`*^9, 
   3.823702847650258*^9}, {3.8237028995525503`*^9, 3.823702980286729*^9}, {
   3.823703014403739*^9, 3.82370313180005*^9}, {3.8237031629721427`*^9, 
   3.8237032327293696`*^9}, {3.8237048869268303`*^9, 
   3.8237048872965193`*^9}, {3.823705908630597*^9, 3.823705922049883*^9}, {
   3.823705953270815*^9, 3.8237061057848186`*^9}, {3.8237061415715723`*^9, 
   3.8237061899482*^9}, {3.8237062408564777`*^9, 3.8237062757072315`*^9}, {
   3.8237065148813705`*^9, 3.8237065187673683`*^9}, {3.8237066527201214`*^9, 
   3.823706661287065*^9}, {3.823707024443328*^9, 3.823707026124913*^9}, {
   3.8237072395921*^9, 3.8237073522592216`*^9}, 3.8242895932247677`*^9, 
   3.824378065819078*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[277]:=",ExpressionUUID->"73ac0523-c825-4dd5-895d-2be8aa0fefb6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trajectory - RungeKutta4", "Subsection",
 CellChangeTimes->{{3.822492471052125*^9, 3.822492484522397*^9}, {
  3.823354560814218*^9, 
  3.8233545659300737`*^9}},ExpressionUUID->"42ae1a74-4d7c-492c-8b4c-\
7549d31deb5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"idTrajectory", "::", "usage"}], " ", "=", " ", 
    "\"\<IDRungeKuttaTrajectory[device, energy, r0, smax, rkstep]: Calculates \
the particle trajectory using the Runge-Kutta algorithm. The particle energy \
must be in GeV, r0 is the initial position and normalized momentum vector \
{x0, y0, z0, dx0ds, dy0ds, dz0ds}, smax and rkstep are the final longitudinal \
position and the Runge-Kutta step. All positions are in millimeters.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"idTrajectory", "[", 
    RowBox[{
    "device_", ",", " ", "energy_", ",", "r0_", ",", "smax_", ",", "rkstep_", 
     ",", "display_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "trajectory", ",", " ", "ElectronRestEnergy", ",", " ", "LightSpeed", 
       ",", " ", "beta", ",", " ", "brho", ",", " ", "a", ",", " ", "b", ",", 
       " ", "b1", ",", " ", "b2", ",", " ", "b3", ",", " ", "r", ",", "rp", 
       ",", " ", "r1", ",", " ", "r2", ",", " ", "r3", ",", " ", "drds1", ",",
        " ", "drds2", ",", " ", "drds3", ",", " ", "drds4", ",", " ", "i", 
       ",", " ", "sm", ",", " ", "step", ",", " ", "t0", ",", " ", "t1", ",", 
       "p1", ",", "p2"}], "}"}], ",", "\n", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ElectronRestEnergy", "=", "510998.92811"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"[", "eV", "]"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LightSpeed", "=", "299792458"}], ";", 
      RowBox[{"(*", 
       RowBox[{"[", 
        RowBox[{"m", "/", "s"}], "]"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"beta", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1.0", "-", 
         RowBox[{"(", 
          RowBox[{"1.0", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"energy", "*", 
               RowBox[{"1000000000", "/", "ElectronRestEnergy"}]}], ")"}], 
             "^", "2"}], ")"}]}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"brho", "=", 
       RowBox[{"(", 
        RowBox[{"beta", "*", "energy", "*", 
         RowBox[{"1000000000", "/", "LightSpeed"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"1.0", "/", "brho"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r1", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r2", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r3", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", "=", " ", "r0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"from", " ", "mm", " ", "to", " ", "m"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "1000"}]}], ";", " ", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", "1000"}]}], ";", " ", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "1000"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sm", " ", "=", " ", 
       RowBox[{"smax", "/", "1000"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"step", " ", "=", " ", 
       RowBox[{"rkstep", "/", "1000"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trajectory", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"trajectory", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", "1000"}], ",", " ", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", "1000"}], ",", " ", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "*", "1000"}], ",", " ", 
          RowBox[{"r", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
          RowBox[{"r", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
          RowBox[{"r", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"While", " ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "<", "sm"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rp", " ", "=", "r"}], ";", "\[IndentingNewLine]", 
         RowBox[{"b", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"device", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"rp", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", "\n", 
         "\t", 
         RowBox[{"drds1", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r", ",", "b"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"r1", "=", 
          RowBox[{"rp", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"step", "/", "2.0"}], ")"}], "*", "drds1"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"b1", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"device", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r1", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", "\n", 
         "\t", 
         RowBox[{"drds2", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r1", ",", "b1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"r2", "=", 
          RowBox[{"rp", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"step", "/", "2.0"}], ")"}], "*", "drds2"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"b2", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"device", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r2", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"drds3", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r2", ",", "b2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"r3", "=", 
          RowBox[{"rp", "+", 
           RowBox[{"step", "*", "drds3"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"b3", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"device", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r3", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"drds4", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r3", ",", "b3"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"r", "=", 
          RowBox[{"rp", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"step", "/", "6.0"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"drds1", "+", 
              RowBox[{"2.0", "*", "drds2"}], "+", 
              RowBox[{"2.0", "*", "drds3"}], "+", "drds4"}], ")"}]}]}]}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"trajectory", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", "1000"}], ",", " ", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", "1000"}], ",", " ", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", "1000"}], ",", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<> IDRungeKuttaTrajectory: elapsed time = \>\"", ",", 
          RowBox[{"(", 
           RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"display", "\[GreaterEqual]", " ", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "Plots", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"trajectory", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
                RowBox[{"trajectory", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "trajectory", "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<Z [mm]\>\"", ",", "12"}], "]"}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<X [mm]\>\"", ",", "12"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<X Direction Trajectory\>\"", ",", "Bold", ",", "12"}], 
              "]"}]}], ",", 
            RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p2", "=", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"trajectory", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
                RowBox[{"trajectory", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "trajectory", "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<Z [mm]\>\"", ",", "12"}], "]"}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<Y [mm]\>\"", ",", "12"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<Y Direction Trajectory\>\"", ",", "Bold", ",", "12"}], 
              "]"}]}], ",", 
            RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"p1", ",", "p2"}], "}"}], ",", "\"\<\\t\\t\>\""}], "]"}],
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "trajectory", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.76744770185725*^9, 3.767447715061404*^9}, {
   3.7674478894725156`*^9, 3.7674478930665445`*^9}, {3.782655720566373*^9, 
   3.782655720941368*^9}, 3.821198370332193*^9, {3.8211989209357195`*^9, 
   3.821198946853913*^9}, {3.8211990277470274`*^9, 3.8211991616885953`*^9}, {
   3.8218660850976667`*^9, 3.8218660880108*^9}, {3.821970797130686*^9, 
   3.8219708160740128`*^9}, {3.8219712921125784`*^9, 3.8219713017398825`*^9}, 
   3.821971381322256*^9, {3.821972769605554*^9, 3.821972770044639*^9}, {
   3.8219730908819094`*^9, 3.8219731497491355`*^9}, {3.821973223683874*^9, 
   3.8219732453369694`*^9}, {3.8220407771958113`*^9, 
   3.8220407850000906`*^9}, {3.8223838530702477`*^9, 3.822383854027481*^9}, 
   3.8224918463941603`*^9, {3.82335466103051*^9, 3.823354663051179*^9}, {
   3.8233547381085415`*^9, 3.82335473837449*^9}, {3.823354933768151*^9, 
   3.823354976219185*^9}, {3.823355034146756*^9, 3.823355036629574*^9}, {
   3.8233577978428044`*^9, 3.8233579030437803`*^9}, {3.823357950633753*^9, 
   3.823357977032151*^9}, {3.823358048140832*^9, 3.823358058318604*^9}, {
   3.8233582164042816`*^9, 3.8233582224374027`*^9}, {3.8233583481937137`*^9, 
   3.8233583686849365`*^9}, {3.8233584079316053`*^9, 
   3.8233584091356525`*^9}, {3.823687657134842*^9, 3.823687657388418*^9}, {
   3.823694951227759*^9, 3.823694989889847*^9}, {3.8237006005087557`*^9, 
   3.8237006215187845`*^9}, {3.823701655968274*^9, 3.823701671759482*^9}, 
   3.8243780907471137`*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[278]:=",ExpressionUUID->"025bc5ab-4637-489a-906f-8dab98922eda"]
}, Closed]],

Cell[CellGroupData[{

Cell["AuxRungeKutta", "Subsection",
 CellChangeTimes->{{3.8224924968846164`*^9, 
  3.8224925096046734`*^9}},ExpressionUUID->"b0078541-74f5-4ab7-855f-\
61a5f4c15790"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"auxIDNewtonLorentzEquation", "[", 
     RowBox[{"a_", ",", "r_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "drds", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"drds", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"r", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"drds", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"r", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"drds", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{"r", "[", 
         RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"drds", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "a"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", "5", "]"}], "]"}], "*", 
            RowBox[{"b", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "*", 
            RowBox[{"b", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"drds", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "a"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "*", 
            RowBox[{"b", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "*", 
            RowBox[{"b", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"drds", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"-", "a"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "*", 
            RowBox[{"b", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", "5", "]"}], "]"}], "*", 
            RowBox[{"b", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "drds", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.76744770185725*^9, 3.767447715061404*^9}, {
   3.7674478894725156`*^9, 3.7674478930665445`*^9}, {3.782655720566373*^9, 
   3.782655720941368*^9}, 3.821198370332193*^9, {3.8211989209357195`*^9, 
   3.821198946853913*^9}, {3.8211990277470274`*^9, 3.8211991616885953`*^9}, {
   3.8218660850976667`*^9, 3.8218660880108*^9}, {3.821970797130686*^9, 
   3.8219708160740128`*^9}, {3.8219712921125784`*^9, 3.8219713017398825`*^9}, 
   3.821971381322256*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[280]:=",ExpressionUUID->"93a67c47-a1a5-45b6-be01-ef92e823a81a"]
}, Closed]],

Cell[CellGroupData[{

Cell["PhaseError - RungeKutta", "Subsection",
 CellChangeTimes->{{3.822554809301333*^9, 3.8225548221540318`*^9}, {
  3.822579285924861*^9, 3.822579286074135*^9}, {3.823354572888997*^9, 
  3.823354575941679*^9}},ExpressionUUID->"9c04e01e-677d-4fc8-96ac-\
fb04bbe32cbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idPhaseError", "[", 
   RowBox[{
   "baxis_", ",", "xo_", ",", "xf_", ",", "nx_", ",", "Trajetoria_", ",", 
    "eEnergy_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "eletron", ",", "mo", ",", "eRestEnergy", ",", "bfield", ",", 
        "bfieldT", ",", "longAxis", ",", "ampX", ",", "ampY", ",", "ampZ", 
        ",", "ampT", ",", "peakX", ",", "peakY", ",", "peakZ", ",", "peakT", 
        ",", "longPeak", ",", "longPeakX", ",", "longPeakY", ",", "longPeakZ",
         ",", "longPeakT", ",", "periods", ",", "nperiods", ",", "periodL", 
        ",", "kparam", ",", "gamma", ",", "lambda", ",", "intField0", ",", 
        "intField", ",", "drop", ",", "phaseError", ",", "phase", ",", "j", 
        ",", "jmin", ",", "rmsError", ",", "fitData", ",", "fitLin", ",", 
        "linearFit", ",", "linearizedPhase", ",", "p3", ",", "a", ",", "b", 
        ",", "I00", ",", "I0", ",", "p0", ",", "btotal", ",", "dx", ",", "c", 
        ",", "s", ",", "errorP", ",", "t0", ",", "t1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t0", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Check", " ", "Inputs"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"baxis", "\[NotEqual]", " ", 
           RowBox[{"Length", "[", "Trajetoria", "]"}]}], "]"}], ",", 
         RowBox[{
         "Return", "[", 
          "\"\<[ERROR] : Field vector and Trajectory Vector have not the same \
lenght.\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"eEnergy", ">", "100"}], ",", 
         RowBox[{
         "Return", "[", 
          "\"\<[ERROR] : Electron beam energy to high. Check if the input \
energy is in Gev.\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Total", " ", "Field"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"btotal", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"baxis", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"baxis", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"baxis", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "3"}], "]"}], "]"}], "^", "2"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", "Parameters"}], " ", "===", "=="}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"eletron", "=", "1.60217662*^-19"}], ";", " ", 
       RowBox[{"mo", "=", "9.10938356*^-31"}], ";", "\[IndentingNewLine]", 
       RowBox[{"eRestEnergy", "=", "510998.92811"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"[", "eV", "]"}], "*)"}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{"==", " ", 
         RowBox[{"mo", "*", 
          RowBox[{"c", "^", 
           RowBox[{"2", "[", "J", "]"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"c", "=", "299792458"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"m", "/", "s"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"bfield", "=", "baxis"}], ";", "\[IndentingNewLine]", 
       RowBox[{"bfieldT", "=", "btotal"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Principal", " ", "Longitudinal", " ", "Axis"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dx", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xf", "-", "xo"}], ")"}], "/", "nx"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"longAxis", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"xo", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "*", "dx"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Longitudinal", " ", "Axis", " ", "from", " ", "0"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"longAxis", "-", 
           RowBox[{"longAxis", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "1000"}]}], ";", 
       "  ", 
       RowBox[{"(*", 
        RowBox[{"[", "m", "]"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", 
          RowBox[{"Find", " ", "Peaks"}]}], " ", "===", "=="}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ampT", "=", 
        RowBox[{"0.1", "*", 
         RowBox[{"Max", "[", "bfieldT", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ampX", "=", 
        RowBox[{"ampY", "=", 
         RowBox[{"ampZ", "=", "ampT"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Find", " ", "Peaks"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"peakX", "=", 
        RowBox[{"FindPeaks", "[", 
         RowBox[{
          RowBox[{"bfield", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "0", " ", ",", "0", 
          ",", " ", "ampX"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"peakY", "=", 
        RowBox[{"FindPeaks", "[", 
         RowBox[{
          RowBox[{"bfield", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "0", " ", ",", "0", 
          ",", " ", "ampY"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"peakZ", "=", 
        RowBox[{"FindPeaks", "[", 
         RowBox[{
          RowBox[{"bfield", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", "0", " ", ",", "0", 
          ",", " ", "ampZ"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"peakT", "=", 
        RowBox[{"FindPeaks", "[", 
         RowBox[{"bfieldT", ",", "0", " ", ",", "0", " ", ",", " ", "ampT"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", 
          RowBox[{
          "Remove", " ", "extremities", " ", "from", " ", "Total", " ", 
           "Field"}]}], " ", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"drop", "=", "4"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "how", " ", "many", " ", "peaks", " ", "to", " ", "drop", " ", "each",
          " ", "side"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"peakT", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"peakT", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "drop"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"peakT", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"peakT", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "drop"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"Drop", " ", "extremity", " ", "peaks"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"longPeakT", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"[", 
            RowBox[{"peakT", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "peakT", "]"}]}], "}"}]}], "]"}]}], ";", 
       " ", 
       RowBox[{"(*", 
        RowBox[{
        "Crate", " ", "longitudinal", " ", "axis", " ", "based", " ", "on", 
         " ", "total", " ", "field"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", 
          RowBox[{
          "Remove", " ", "extremities", " ", "from", " ", "Field", " ", 
           "Components"}]}], " ", "===", "=="}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"drop", "=", "3"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "how", " ", "many", " ", "peaks", " ", "to", " ", "drop", " ", "each",
          " ", "side"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Z", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "peakZ", "]"}], ">", 
          RowBox[{"2", "*", "drop"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"peakZ", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"peakZ", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "drop"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"peakZ", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"peakZ", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "drop"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"longPeakZ", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"longAxis", "[", 
              RowBox[{"[", 
               RowBox[{"peakZ", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "peakZ", "]"}]}], "}"}]}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"peakZ", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"-", "5"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Y", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "peakY", "]"}], ">", 
          RowBox[{"2", "*", "drop"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"peakY", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"peakY", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "drop"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"peakY", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"peakY", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "drop"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"longPeakY", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"longAxis", "[", 
              RowBox[{"[", 
               RowBox[{"peakY", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "peakY", "]"}]}], "}"}]}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"peakY", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"-", "5"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"X", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "peakX", "]"}], ">", 
          RowBox[{"2", "*", "drop"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"peakX", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"peakX", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "drop"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"peakX", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"peakX", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "drop"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"longPeakX", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"longAxis", "[", 
              RowBox[{"[", 
               RowBox[{"peakX", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "peakX", "]"}]}], "}"}]}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"peakX", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"-", "5"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", 
         RowBox[{"==", " ", 
          RowBox[{
          "Find", " ", "the", " ", "Principal", " ", "Field", " ", "Axis"}]}],
          " ", "===", "=="}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mean", "[", 
           RowBox[{"peakX", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ">", 
          RowBox[{"Mean", "[", 
           RowBox[{"peakY", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"peakX", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ">", 
            RowBox[{"Mean", "[", 
             RowBox[{"peakZ", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"longPeak", "=", "longPeakX"}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"longPeak", "=", "longPeakZ"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"peakY", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ">", 
            RowBox[{"Mean", "[", 
             RowBox[{"peakZ", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"longPeak", "=", "longPeakY"}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"longPeak", "=", "longPeakZ"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"periods", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"longPeak", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
           RowBox[{"longPeak", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "longPeak", "]"}], "-", "1"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", "===", "===", " ", 
         RowBox[{"Magnet", " ", "design"}], " ", "===", "===", "==="}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"nperiods", "=", 
        RowBox[{"Length", "[", "periods", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"periodL", "=", 
        RowBox[{"Mean", "[", "periods", "]"}]}], ";", " ", 
       RowBox[{"(*", "mm", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"gamma", "=", 
        RowBox[{"eEnergy", "*", 
         RowBox[{
          RowBox[{"10", "^", "9"}], "/", "eRestEnergy"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kparam", "=", 
        RowBox[{"0.0934", "*", "periodL", "*", 
         RowBox[{"Mean", "[", 
          RowBox[{"peakT", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]}], ";", "  ", 
       RowBox[{"(*", 
        RowBox[{"!!", 
         RowBox[{"!!", 
          RowBox[{"!!", 
           RowBox[{"!!", 
            RowBox[{"!!", 
             RowBox[{"!!", 
              RowBox[{"!", " ", 
               RowBox[{
               "Todas", " ", "componentes", " ", "ou", " ", "s\[OAcute]", " ", 
                RowBox[{"1", "?"}]}]}]}]}]}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"lambda", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Mean", "[", "periods", "]"}], "/", "1000"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"gamma", "^", "2"}], ")"}]}], ")"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"kparam", "^", "2"}], ")"}], "/", "2"}]}], ")"}]}]}], 
       ";", " ", 
       RowBox[{"(*", "m", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"===", "===", "===", " ", 
         RowBox[{"Phase", " ", "Function"}], " ", "===", "===", "==="}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"jmin", "=", 
        RowBox[{"peakT", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"phase", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"I0", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Trajetoria", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "4"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"Trajetoria", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "4"}], "]"}], "]"}], "^", 
                  "2"}]}], ")"}], "/", "2"}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Trajetoria", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "5"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"Trajetoria", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "5"}], "]"}], "]"}], "^", 
                  "2"}]}], ")"}], "/", "2"}], ")"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
             RowBox[{"s", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "jmin"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p0", "=", 
        RowBox[{
         RowBox[{"Pi", "/", "lambda"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"[", "jmin", "]"}], "]"}], "/", 
            RowBox[{"gamma", "^", "2"}]}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"I0", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "I0", "]"}]}], "}"}]}], "]"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"phase", ",", "p0"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", 
          RowBox[{"jmin", "+", "1"}]}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"peakT", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Length", "[", "peakT", "]"}], ",", "1"}], "]"}], 
             "]"}], "-", "2"}], ")"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"I00", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Trajetoria", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "4"}], "]"}], "]"}], "^", "2"}], "+", 
                  RowBox[{
                   RowBox[{"Trajetoria", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", "4"}], "]"}], "]"}], "^", 
                   "2"}]}], ")"}], "/", "2"}], ")"}], "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Trajetoria", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "5"}], "]"}], "]"}], "^", "2"}], "+", 
                  RowBox[{
                   RowBox[{"Trajetoria", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", "5"}], "]"}], "]"}], "^", 
                   "2"}]}], ")"}], "/", "2"}], ")"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
              RowBox[{"s", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"I0", ",", "I00"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"p0", "=", 
           RowBox[{
            RowBox[{"Pi", "/", "lambda"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "/", 
               RowBox[{"gamma", "^", "2"}]}], "+", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"I0", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "I0", "]"}]}], "}"}]}], "]"}]}], 
             ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"phase", ",", "p0"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "===", "===", "===", " ", "Fitting", " ", "===", "===", "==="}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"fitData", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"longPeakT", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"phase", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "phase", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fitLin", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"fitData", ",", 
          RowBox[{
           RowBox[{"a", "*", "x"}], "+", "b"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"linearFit", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"longPeakT", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"fitLin", "[", 
             RowBox[{
              RowBox[{"s", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", 
              RowBox[{"longPeakT", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "phase", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"linearizedPhase", "=", 
        RowBox[{"phase", "-", 
         RowBox[{"linearFit", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p3", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"linearizedPhase", "*", 
           RowBox[{"180", "/", "Pi"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Linearized Phase\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"300", ",", "200"}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\< \>\"", ",", "\"\<[deg]\>\""}], "}"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"errorP", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"linearizedPhase", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"peakT", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"peakT", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ";;", 
               RowBox[{
                RowBox[{"peakT", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"peakT", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "]"}], 
             "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "[", "peakT", "]"}], "-", "1"}]}], "}"}]}], 
          "]"}], "*", 
         RowBox[{"180", "/", "Pi"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"t1", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<> Phase solved: elapsed time = \>\"", ",", 
           RowBox[{"t1", "-", "t0"}], ",", "\"\<[s]\>\""}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "errorP", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{
  3.822492878602187*^9, {3.8224930058589163`*^9, 3.822493006645373*^9}, 
   3.8224931499238806`*^9, {3.8224932709041376`*^9, 3.822493273550139*^9}, {
   3.822493393889518*^9, 3.8224934241633096`*^9}, {3.822493658862978*^9, 
   3.822493715139911*^9}, {3.8224937959188914`*^9, 3.8224938292100077`*^9}, {
   3.822494067978244*^9, 3.8224940903923903`*^9}, {3.8224942311685205`*^9, 
   3.8224942448412*^9}, {3.8224943487069073`*^9, 3.822494416549449*^9}, {
   3.8224944663065987`*^9, 3.8224944666923013`*^9}, 3.822494618506987*^9, {
   3.8224948072681203`*^9, 3.8224948133060055`*^9}, {3.822554294814774*^9, 
   3.822554295949778*^9}, {3.822562743046319*^9, 3.8225627567715144`*^9}, {
   3.8225640500135937`*^9, 3.822564069603611*^9}, {3.8225641104411306`*^9, 
   3.8225641147016373`*^9}, {3.822579290119934*^9, 3.8225792902671766`*^9}, {
   3.8225795705124936`*^9, 3.8225797061936975`*^9}, {3.822579862484825*^9, 
   3.8225799177198734`*^9}, {3.82257998360664*^9, 3.8225800320515375`*^9}, {
   3.822580223157029*^9, 3.822580251401943*^9}, {3.822580367301899*^9, 
   3.822580372200272*^9}, {3.82258092787403*^9, 3.822580964173089*^9}, {
   3.8225809999787884`*^9, 3.822581033047849*^9}, {3.822581199123309*^9, 
   3.8225812002266455`*^9}, {3.8225812356899796`*^9, 
   3.8225812430822277`*^9}, {3.8225815973017206`*^9, 3.822581650579686*^9}, {
   3.8225816922731586`*^9, 3.8225817463103495`*^9}, {3.822581988682259*^9, 
   3.82258199305827*^9}, {3.8225821513124104`*^9, 3.822582272507353*^9}, {
   3.822582498389442*^9, 3.8225825011803017`*^9}, {3.8225829894426737`*^9, 
   3.8225830090647397`*^9}, {3.822583073372199*^9, 3.822583073795903*^9}, {
   3.8225831444470987`*^9, 3.822583145913085*^9}, {3.822583228897163*^9, 
   3.8225832405599875`*^9}, {3.822583323428615*^9, 3.822583323698162*^9}, 
   3.8233545805077934`*^9, {3.823354685901331*^9, 3.823354693856892*^9}, {
   3.823358857459176*^9, 3.823358869167984*^9}, {3.823596979461104*^9, 
   3.8235969875166793`*^9}, {3.823598524453189*^9, 3.823598639899991*^9}, {
   3.8235986982823*^9, 3.8235988327271934`*^9}, {3.823598929304826*^9, 
   3.8235989522734785`*^9}, {3.823599641906768*^9, 3.823599659431821*^9}, {
   3.823599733062941*^9, 3.823599745971265*^9}, {3.8236008180558214`*^9, 
   3.823600882347562*^9}, {3.8236136081340604`*^9, 3.82361361296128*^9}, {
   3.823681707257349*^9, 3.823681708994249*^9}, {3.823686918814213*^9, 
   3.823686938422887*^9}, {3.823687016844222*^9, 3.823687224626627*^9}, {
   3.823687303126145*^9, 3.8236873549926453`*^9}, {3.8236873892866344`*^9, 
   3.823687472849032*^9}, {3.8236875352302847`*^9, 3.8236875838014793`*^9}, {
   3.823687620059818*^9, 3.8236876287413497`*^9}, {3.8236876660438004`*^9, 
   3.82368766627575*^9}, {3.8236958816471524`*^9, 3.823695908488454*^9}, {
   3.8237017448030853`*^9, 3.823701750591502*^9}, {3.8237076438214817`*^9, 
   3.8237076631608815`*^9}, {3.8237077399448967`*^9, 3.8237077550061064`*^9}, 
   3.824378105726492*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[281]:=",ExpressionUUID->"6b381c11-3d63-4a60-9e9e-44371b356054"]
}, Closed]],

Cell[CellGroupData[{

Cell["Shuffle Blocks", "Subsection",
 CellChangeTimes->{{3.824218784933979*^9, 
  3.824218806631343*^9}},ExpressionUUID->"14ced6b7-8500-4c18-b83b-\
0dfbc2296d22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"listMag", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1", ",", "m2", ",", "m3"}], "}"}], " ", ",", " ", "Name"}], 
     "}"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"idSortingShuffle", "[", 
    RowBox[{"listMag_", ",", "typeID_", ",", "nPeriods_", ",", "symmetry_"}], 
    "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "blockType", ",", "newBlockType", ",", "mag", ",", "bType1", ",", 
         "bType2", ",", "bType3", ",", "magHrotated", ",", "magnetization", 
         ",", "magnetizationIdx", ",", "i", ",", "j"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"ID", " ", "Type"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"typeID", "\[Equal]", "\"\<DeltaUndulator\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"magPos", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "2"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "2"}], "}"}]}], 
             "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"typeID", "\[Equal]", "\"\<PlanarUndulator\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"magPos", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "2"}], "}"}]}], 
             "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"typeID", "\[Equal]", "\"\<EPU\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"magPos", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "2"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "2"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"(*", 
          RowBox[{"Check", " ", "Inputs"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "magPos", "]"}], "*", 
              RowBox[{"Length", "[", 
               RowBox[{"magPos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "nPeriods"}], ">", 
             RowBox[{"Length", "[", "listMag2", "]"}]}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<[Error] Insufficient number of blocks for \>\"", ",", 
               "nPeriods", ",", "\"\< periods.\>\""}], "]"}], "]"}]}], "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"randRot", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"180", "Degree"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Separate"}]}]}], " ", "Blocks", " ", "by", 
           " ", "Type", " ", "of", " ", 
           RowBox[{
            RowBox[{"Magnetization", " ", "--"}], "--"}]}], "-"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"blockType", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "listMag", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"listMag", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"listMag", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "3"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"listMag", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], ">", "0"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"blockType", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"listMag", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{
                 RowBox[{"blockType", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", 
                 RowBox[{"listMag", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"blockType", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"listMag", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Create"}]}]}], " ", "a", " ", "new", " ", 
           "Random", " ", "magnetization", " ", 
           RowBox[{
            RowBox[{"vector", " ", "--"}], "--"}]}], "-"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newBlockType", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RandomSample", "[", 
            RowBox[{"blockType", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"RandomSample", "[", 
            RowBox[{"blockType", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"RandomSample", "[", 
            RowBox[{"blockType", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Check"}]}]}], " ", 
           RowBox[{
            RowBox[{"Inputs", " ", "--"}], "--"}]}], "-"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"symmetry", "\[Equal]", "\"\<symmetric\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"newBlockType", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
              RowBox[{"(", 
               RowBox[{"nPeriods", "*", "8"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<[ERROR] Insufficient number of Horizontal Magnetization \
blocks.\>\"", "]"}], ";", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"newBlockType", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "<", 
              RowBox[{"(", 
               RowBox[{"nPeriods", "*", "4"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<[ERROR] Insufficient number of Vertical (Up) \
Magnetization blocks.\>\"", "]"}], ";", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"newBlockType", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"nPeriods", "*", "4"}], "-", "4"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<[ERROR] Insufficient number of Vertical (Down) \
Magnetization blocks.\>\"", "]"}], ";", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"symmetry", "\[Equal]", "\"\<antisymmetric\>\""}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"newBlockType", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"nPeriods", "*", "8"}], "+", "4"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<[ERROR] Insufficient number of Horizontal Magnetization \
blocks.\>\"", "]"}], ";", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"newBlockType", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "<", 
              RowBox[{"(", 
               RowBox[{"nPeriods", "*", "4"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<[ERROR] Insufficient number of Vertical (Up) \
Magnetization blocks.\>\"", "]"}], ";", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"newBlockType", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", 
              RowBox[{"(", 
               RowBox[{"nPeriods", "*", "4"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<[ERROR] Insufficient number of Vertical (Down) \
Magnetization blocks.\>\"", "]"}], ";", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Create"}]}]}], " ", "The", " ", "list", " ", 
           "of", " ", "magnetizations", " ", "used", " ", "to", " ", "draw", 
           " ", "the", " ", 
           RowBox[{
            RowBox[{"ID", " ", "--"}], "--"}]}], "-"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Creating", " ", "the", " ", "Magnetization", " ", "Vector", " ", 
          "for", " ", "Drawing", " ", "Format"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mag", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"Length", "[", "magPos", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"magCass", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"Length", "[", "magPos", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bType1", "=", "0"}], ";", 
        RowBox[{"bType2", "=", "0"}], ";", 
        RowBox[{"bType3", "=", "0"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "magPos", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"j", " ", "=", " ", 
            RowBox[{"Cassette", " ", "Number"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Magnetization", " ", "orientation", " ", "for", " ", "one", " ", 
            "cassette"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"magCass", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"Nest", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"magPos", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", "#", ",", "1"}], "]"}],
                "&"}], ",", 
              RowBox[{"magPos", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"(", 
               RowBox[{"nPeriods", "-", "1"}], ")"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Symmetry", " ", "Adjust"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"symmetry", "\[Equal]", "\"\<symmetric\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"magCass", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"magCass", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"magCass", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"magCass", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"magCass", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Pick", " ", "a", " ", "magnetization", " ", "for", " ", "each", 
             " ", "block", " ", "of", " ", "the", " ", "cassette"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", " ", 
              RowBox[{"Length", "[", 
               RowBox[{"magCass", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "  ", 
             RowBox[{"(*", " ", 
              RowBox[{"i", " ", "=", " ", 
               RowBox[{"Block", " ", "Number"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"magCass", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", 
                "3"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bType3", "=", 
                 RowBox[{"bType3", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"magRot", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"randRot", "[", 
                    RowBox[{"[", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "]"}], ".", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magCass", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType3", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magCass", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType3", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"mag", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "magRot"}], "]"}]}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"magCass", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", 
                "2"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bType2", "=", 
                 RowBox[{"bType2", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"magRot", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"randRot", "[", 
                    RowBox[{"[", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "]"}], ".", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magCass", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType2", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magCass", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType2", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"mag", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "magRot"}], "]"}]}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"magCass", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", 
                "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bType1", "=", 
                 RowBox[{"bType1", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"magCass", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magCass", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1", ",", "1", ",", "1"}], "]"}], "]"}]}], ">", 
                   "0"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{
                    RowBox[{"mag", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magCass", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"magHrotated", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{"Pi", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magCass", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magCass", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"mag", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "magHrotated"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
            "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"magnetization", "=", 
         RowBox[{"mag", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"magnetizationIdx", "=", 
         RowBox[{"mag", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"magnetization", ",", "magnetizationIdx"}], "}"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}]}]], "Input",
 CellChangeTimes->{{3.82421884412298*^9, 3.8242188756221085`*^9}, {
   3.8242189166220717`*^9, 3.8242189528175907`*^9}, 3.82422326219156*^9, {
   3.8242234388811007`*^9, 3.824223480949898*^9}, {3.8242235929942327`*^9, 
   3.824223593341138*^9}, {3.8242236492290034`*^9, 3.824223694309307*^9}, {
   3.8242237791984997`*^9, 3.8242238662905016`*^9}, {3.8242239042807198`*^9, 
   3.8242239273397093`*^9}, {3.824223978722506*^9, 3.824223999358909*^9}, {
   3.824224330773941*^9, 3.824224390678156*^9}, 3.824224514519779*^9, {
   3.824224551446821*^9, 3.8242246284975443`*^9}, {3.8242247022617517`*^9, 
   3.824224739220576*^9}, {3.824224771034546*^9, 3.8242247951029873`*^9}, {
   3.82422506972085*^9, 3.8242250728375206`*^9}, {3.824225112181482*^9, 
   3.824225170810827*^9}, {3.8242252036119113`*^9, 3.8242252064376926`*^9}, {
   3.82422545027078*^9, 3.8242254561677837`*^9}, {3.824225802681007*^9, 
   3.8242258030355206`*^9}, {3.8242267154870234`*^9, 
   3.8242267238161297`*^9}, {3.8242267607975245`*^9, 
   3.8242267662018747`*^9}, {3.8242268568826*^9, 3.824226883597783*^9}, {
   3.8242270313100667`*^9, 3.824227044929228*^9}, {3.8242271752874975`*^9, 
   3.824227175632395*^9}, {3.8242272335875416`*^9, 3.8242272360502415`*^9}, {
   3.8242792251498547`*^9, 3.824279252020328*^9}, {3.824284773921209*^9, 
   3.8242847744674263`*^9}, {3.8242849870736313`*^9, 3.824285000878022*^9}, {
   3.8242850680885115`*^9, 3.824285083408368*^9}, {3.8242851923489943`*^9, 
   3.82428519308715*^9}, {3.824285435176093*^9, 3.8242854359789867`*^9}, {
   3.824285972613068*^9, 3.824285973400806*^9}, {3.82428626398131*^9, 
   3.824286264502846*^9}, {3.8243060337315273`*^9, 3.8243060820104976`*^9}, {
   3.8243061144602222`*^9, 3.8243061748733187`*^9}, {3.824306235568616*^9, 
   3.8243062622536497`*^9}, {3.8243062939932537`*^9, 
   3.8243063074686966`*^9}, {3.8243063880236745`*^9, 3.82430641680632*^9}, {
   3.824306715539843*^9, 3.8243067201673756`*^9}, {3.824383943467682*^9, 
   3.8243839496255655`*^9}, {3.824383988008916*^9, 3.8243839906995306`*^9}, {
   3.8243840226014585`*^9, 3.8243840479236975`*^9}, {3.8243841771021686`*^9, 
   3.8243842864932814`*^9}, {3.824384457820462*^9, 3.8243845674291615`*^9}, {
   3.824384603764206*^9, 3.8243847303957434`*^9}, {3.824384808500452*^9, 
   3.8243849159098444`*^9}, {3.8243849553979125`*^9, 
   3.8243849579440756`*^9}, {3.824385001223293*^9, 3.824385016448095*^9}, {
   3.8243850600472193`*^9, 3.8243850899548364`*^9}, {3.824393261482541*^9, 
   3.82439330379891*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[282]:=",ExpressionUUID->"83085b5e-7bf9-4cee-8c85-4eaad9ea737e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Shuffle Term", "Subsection",
 CellChangeTimes->{{3.824218784933979*^9, 3.824218806631343*^9}, {
  3.8244561545120244`*^9, 
  3.8244561567519417`*^9}},ExpressionUUID->"d4e2c33d-f22b-4238-9163-\
8e69154b75fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"listMag", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1", ",", "m2", ",", "m3"}], "}"}], " ", ",", " ", "Name"}], 
     "}"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"idSortingShuffleTerm", "[", 
    RowBox[{
    "listMag_", ",", "typeID_", ",", "nPeriods_", ",", "symmetry_", ",", 
     "termType_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "blockType", ",", "newBlockType", ",", "mag", ",", "bType1", ",", 
         "bType2", ",", "bType3", ",", "magHrotated", ",", "magnetization", 
         ",", "magnetizationIdx", ",", "i", ",", "j", ",", "magPosIn", ",", 
         "magPosOut", ",", "randRot", ",", "termMagFront", ",", "termMagBack",
          ",", "magRot"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Define", " ", "Type", " ", "of", " ", "Termination"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"termType", "\[Equal]", "\"\<ThreeBlocksAntiSymReal\>\""}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"typeID", "\[Equal]", "\"\<DeltaUndulator\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"magPosIn", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", "3", ",", "3", ",", "3"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", "3", ",", "3", ",", "3"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "3", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2"}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "3", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2"}], 
                  "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"magPosOut", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", "2", ",", "2", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "2", ",", "2", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "3", ",", "3", ",", "3", ",", "1", ",", "1", ",", "2"}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "3", ",", "3", ",", "3", ",", "1", ",", "1", ",", "2"}], 
                  "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<There are no Termination definitions for other types of \
undulator besides the Delta yet\>\"", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
           ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"termType", "\[Equal]", "\"\<ThreeBlocksAntiSym\>\""}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"typeID", "\[Equal]", "\"\<DeltaUndulator\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"magPosIn", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"magPosOut", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "}"}]}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<There are no Termination definitions for other types of \
undulator besides the Delta yet\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"termType", "\[Equal]", "\"\<FourBlocksAntiSym\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"typeID", "\[Equal]", "\"\<DeltaUndulator\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"magPosIn", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", 
                   RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", 
                   RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "2"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "2"}], 
                  "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"magPosOut", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}], ",", "3", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}], ",", "3", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "1", ",", "2", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "1", ",", "2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<There are no Termination definitions for other types of \
undulator besides the Delta yet\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"termType", "\[Equal]", "\"\<FourBlocksAntiSymReal\>\""}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"typeID", "\[Equal]", "\"\<DeltaUndulator\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"magPosIn", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", "3", ",", "3", ",", "3"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", "3", ",", "3", ",", "3"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", "1",
                    ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "3", ",", "1", ",", "1", ",", "1",
                    ",", "2", ",", "2", ",", "2"}], "}"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"magPosOut", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", "2", ",", "2", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", "3", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "2", ",", "2", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}], ",", "3", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "3", ",", "3", ",", "3", ",", "1", ",", "1", ",", "1", ",", 
                   "2", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "3", ",", "3", ",", "3", ",", "1", ",", "1", ",", "1", ",", 
                   "2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<There are no Termination definitions for other types of \
undulator besides the Delta yet\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"randRot", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"180", "Degree"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Separate"}]}]}], " ", "Blocks", " ", "by", 
           " ", "Type", " ", "of", " ", 
           RowBox[{
            RowBox[{"Magnetization", " ", "--"}], "--"}]}], "-"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"blockType", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "listMag", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"listMag", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"listMag", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "3"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"listMag", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], ">", "0"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"blockType", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"listMag", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{
                 RowBox[{"blockType", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", 
                 RowBox[{"listMag", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"blockType", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"listMag", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Create"}]}]}], " ", "a", " ", "new", " ", 
           "Random", " ", "magnetization", " ", 
           RowBox[{
            RowBox[{"vector", " ", "--"}], "--"}]}], "-"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newBlockType", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RandomSample", "[", 
            RowBox[{"blockType", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"RandomSample", "[", 
            RowBox[{"blockType", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"RandomSample", "[", 
            RowBox[{"blockType", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Check"}]}]}], " ", 
           RowBox[{
            RowBox[{"Inputs", " ", "--"}], "--"}]}], "-"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"symmetry", "\[Equal]", "\"\<symmetric\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"newBlockType", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
                RowBox[{"(", 
                 RowBox[{"nPeriods", "*", "8"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<[ERROR] Insufficient number of Horizontal Magnetization \
blocks.\>\"", "]"}], ";", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"newBlockType", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "<", 
                RowBox[{"(", 
                 RowBox[{"nPeriods", "*", "4"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<[ERROR] Insufficient number of Vertical (Up) \
Magnetization blocks.\>\"", "]"}], ";", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"newBlockType", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"nPeriods", "*", "4"}], "-", "4"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<[ERROR] Insufficient number of Vertical (Down) \
Magnetization blocks.\>\"", "]"}], ";", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"symmetry", "\[Equal]", "\"\<antisymmetric\>\""}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"newBlockType", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"nPeriods", "*", "8"}], "+", "4"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<[ERROR] Insufficient number of Horizontal Magnetization \
blocks.\>\"", "]"}], ";", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"newBlockType", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "<", 
                RowBox[{"(", 
                 RowBox[{"nPeriods", "*", "4"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<[ERROR] Insufficient number of Vertical (Up) \
Magnetization blocks.\>\"", "]"}], ";", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"newBlockType", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", 
                RowBox[{"(", 
                 RowBox[{"nPeriods", "*", "4"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<[ERROR] Insufficient number of Vertical (Down) \
Magnetization blocks.\>\"", "]"}], ";", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Create"}]}]}], " ", "The", " ", "list", " ", 
           "of", " ", "magnetizations", " ", "used", " ", "to", " ", "draw", 
           " ", "the", " ", 
           RowBox[{
            RowBox[{"Terminations", " ", "--"}], "--"}]}], "-"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Creating", " ", "the", " ", "Magnetization", " ", "Vector", " ", 
          "for", " ", "Drawing", " ", "Format"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"termMagFront", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"Length", "[", "magPosIn", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"termMagBack", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"Length", "[", "magPosOut", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bType1", "=", "0"}], ";", 
        RowBox[{"bType2", "=", "0"}], ";", 
        RowBox[{"bType3", "=", "0"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "magPosIn", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"j", " ", "=", " ", 
            RowBox[{"Cassette", " ", "Number"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Pick", " ", "a", " ", "magnetization", " ", "for", " ", "each", 
            " ", "block", " ", "of", " ", "the", " ", "cassette"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", " ", 
             RowBox[{"Length", "[", 
              RowBox[{"magPosIn", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "  ", 
            RowBox[{"(*", " ", 
             RowBox[{"i", " ", "=", " ", 
              RowBox[{"Block", " ", "Number"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"magPosIn", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", 
                "3"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bType3", "=", 
                 RowBox[{"bType3", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"magRot", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"randRot", "[", 
                    RowBox[{"[", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "]"}], ".", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosIn", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType3", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosIn", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType3", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"termMagFront", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "magRot"}], "]"}]}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"magPosIn", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", 
                "2"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bType2", "=", 
                 RowBox[{"bType2", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"magRot", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"randRot", "[", 
                    RowBox[{"[", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "]"}], ".", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosIn", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType2", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosIn", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType2", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"termMagFront", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "magRot"}], "]"}]}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"magPosIn", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", 
                "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bType1", "=", 
                 RowBox[{"bType1", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"magPosIn", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosIn", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1", ",", "1", ",", "1"}], "]"}], "]"}]}], ">", 
                   "0"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{
                    RowBox[{"termMagFront", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosIn", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"magHrotated", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{"Pi", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosIn", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosIn", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"termMagFront", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "magHrotated"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Out", " ", "Termination"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"magPosOut", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", 
                "3"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bType3", "=", 
                 RowBox[{"bType3", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"magRot", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"randRot", "[", 
                    RowBox[{"[", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "]"}], ".", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosOut", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType3", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosOut", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType3", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"termMagBack", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "magRot"}], "]"}]}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"magPosOut", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", 
                "2"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bType2", "=", 
                 RowBox[{"bType2", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"magRot", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"randRot", "[", 
                    RowBox[{"[", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "]"}], ".", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosOut", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType2", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosOut", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType2", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"termMagBack", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "magRot"}], "]"}]}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"magPosOut", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], "\[Equal]", 
                "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bType1", "=", 
                 RowBox[{"bType1", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"magPosOut", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosOut", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1", ",", "1", ",", "1"}], "]"}], "]"}]}], ">", 
                   "0"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{
                    RowBox[{"termMagBack", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosOut", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"magHrotated", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{"Pi", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosOut", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{"newBlockType", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"magPosOut", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}], ",", 
                    "bType1", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"termMagBack", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "magHrotated"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"termMagFront", ",", "termMagBack"}], "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.82421884412298*^9, 3.8242188756221085`*^9}, {
   3.8242189166220717`*^9, 3.8242189528175907`*^9}, 3.82422326219156*^9, {
   3.8242234388811007`*^9, 3.824223480949898*^9}, {3.8242235929942327`*^9, 
   3.824223593341138*^9}, {3.8242236492290034`*^9, 3.824223694309307*^9}, {
   3.8242237791984997`*^9, 3.8242238662905016`*^9}, {3.8242239042807198`*^9, 
   3.8242239273397093`*^9}, {3.824223978722506*^9, 3.824223999358909*^9}, {
   3.824224330773941*^9, 3.824224390678156*^9}, 3.824224514519779*^9, {
   3.824224551446821*^9, 3.8242246284975443`*^9}, {3.8242247022617517`*^9, 
   3.824224739220576*^9}, {3.824224771034546*^9, 3.8242247951029873`*^9}, {
   3.82422506972085*^9, 3.8242250728375206`*^9}, {3.824225112181482*^9, 
   3.824225170810827*^9}, {3.8242252036119113`*^9, 3.8242252064376926`*^9}, {
   3.82422545027078*^9, 3.8242254561677837`*^9}, {3.824225802681007*^9, 
   3.8242258030355206`*^9}, {3.8242267154870234`*^9, 
   3.8242267238161297`*^9}, {3.8242267607975245`*^9, 
   3.8242267662018747`*^9}, {3.8242268568826*^9, 3.824226883597783*^9}, {
   3.8242270313100667`*^9, 3.824227044929228*^9}, {3.8242271752874975`*^9, 
   3.824227175632395*^9}, {3.8242272335875416`*^9, 3.8242272360502415`*^9}, {
   3.8242792251498547`*^9, 3.824279252020328*^9}, {3.824284773921209*^9, 
   3.8242847744674263`*^9}, {3.8242849870736313`*^9, 3.824285000878022*^9}, {
   3.8242850680885115`*^9, 3.824285083408368*^9}, {3.8242851923489943`*^9, 
   3.82428519308715*^9}, {3.824285435176093*^9, 3.8242854359789867`*^9}, {
   3.824285972613068*^9, 3.824285973400806*^9}, {3.82428626398131*^9, 
   3.824286264502846*^9}, {3.8243060337315273`*^9, 3.8243060820104976`*^9}, {
   3.8243061144602222`*^9, 3.8243061748733187`*^9}, {3.824306235568616*^9, 
   3.8243062622536497`*^9}, {3.8243062939932537`*^9, 
   3.8243063074686966`*^9}, {3.8243063880236745`*^9, 3.82430641680632*^9}, {
   3.824306715539843*^9, 3.8243067201673756`*^9}, {3.824383943467682*^9, 
   3.8243839496255655`*^9}, {3.824383988008916*^9, 3.8243839906995306`*^9}, {
   3.8243840226014585`*^9, 3.8243840479236975`*^9}, {3.8243841771021686`*^9, 
   3.8243842864932814`*^9}, {3.824384457820462*^9, 3.8243845674291615`*^9}, {
   3.824384603764206*^9, 3.8243847303957434`*^9}, {3.824384808500452*^9, 
   3.8243849159098444`*^9}, {3.8243849553979125`*^9, 
   3.8243849579440756`*^9}, {3.824385001223293*^9, 3.824385016448095*^9}, {
   3.8243850600472193`*^9, 3.8243850899548364`*^9}, {3.824393261482541*^9, 
   3.82439330379891*^9}, {3.8244588993840265`*^9, 3.8244589278496857`*^9}, {
   3.8244590114483414`*^9, 3.8244590561298923`*^9}, {3.8244591519902115`*^9, 
   3.8244591897664623`*^9}, {3.824459221599516*^9, 3.8244592477306776`*^9}, {
   3.824459282987933*^9, 3.824459338851412*^9}, {3.8244594362793474`*^9, 
   3.8244597164990473`*^9}, {3.8244597768067656`*^9, 
   3.8244598001683693`*^9}, {3.824459916867694*^9, 3.8244599332967987`*^9}, {
   3.824459963902954*^9, 3.8244599920256186`*^9}, 3.824460027932289*^9, {
   3.824463160775008*^9, 3.824463247555231*^9}, {3.824463278292591*^9, 
   3.8244633023968444`*^9}, {3.8244652945381756`*^9, 3.824465302460589*^9}, {
   3.8244653822694173`*^9, 3.8244657445003176`*^9}, {3.824465777430231*^9, 
   3.8244657955520954`*^9}, {3.8244734187255397`*^9, 3.824473434507756*^9}, {
   3.8244745192560863`*^9, 3.8244745211466208`*^9}, {3.8244747097507534`*^9, 
   3.8244747367268777`*^9}, {3.8244747784643793`*^9, 3.824474872040993*^9}, {
   3.828446147033305*^9, 3.8284461544426546`*^9}, {3.828446186362589*^9, 
   3.828446249666959*^9}, {3.828447054940486*^9, 3.8284471073650756`*^9}, {
   3.8284472276560936`*^9, 3.8284472585577006`*^9}, {3.8284487486482034`*^9, 
   3.8284487928909197`*^9}, {3.8284488372342606`*^9, 3.8284489730409403`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[283]:=",ExpressionUUID->"735b04ef-a913-4cc2-918a-6cdc6904136f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sorting Results", "Subsection",
 CellChangeTimes->{{3.8243773113291616`*^9, 
  3.8243773157991724`*^9}},ExpressionUUID->"f69734b6-2902-4ff2-bc69-\
28e6345a5ad1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idSortingResults", "[", 
   RowBox[{
   "costTotal_", ",", "firstGenSize_", ",", "errorMtx_", ",", "weight1Int_", 
    ",", "weight2Int_", ",", "weightPh_", ",", 
    RowBox[{"range_", " ", ":", 
     RowBox[{"{", 
      RowBox[{"0", ",", "20"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "p1", ",", "p11", ",", "p12", ",", "p13", ",", "p21", ",", "p22", ",", 
        "p23", ",", "p31", ",", "p32", ",", "p33", ",", "imgSize"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p1", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"costTotal", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"PlotTheme", "\[Rule]", " ", "\"\<Detailed\>\""}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.8", ",", 
               RowBox[{"firstGenSize", "+", "0.2"}]}], "}"}], ",", "All"}], 
            "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Total Cost\>\""}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "\"\<Individuals\>\"", "}"}], ",", 
             RowBox[{"{", "\"\<Total Cost\>\"", "}"}]}], "}"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"imgSize", "=", 
        RowBox[{"{", 
         RowBox[{"300", ",", "300"}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p11", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"errorMtx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1", ",", "1"}], "]"}], "]"}], "*",
            "weight1Int"}], ",", 
          RowBox[{"PlotTheme", "\[Rule]", " ", "\"\<Detailed\>\""}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase 1\>\""}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", "\"\<Int1\>\"", "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.8", ",", 
               RowBox[{"firstGenSize", "+", "0.2"}]}], "}"}], ",", "range"}], 
            "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "imgSize"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "\"\<Individuals\>\"", "}"}], ",", 
             RowBox[{"{", "\"\<Cost\>\"", "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p12", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"errorMtx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1", ",", "2"}], "]"}], "]"}], "*",
            "weight2Int"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase 1\>\""}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", "\"\<Int2\>\"", "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Orange"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p13", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"errorMtx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1", ",", "3"}], "]"}], "]"}], "*",
            "weightPh"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase 1\>\""}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", "\"\<Phase\>\"", "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p21", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"errorMtx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "2", ",", "1"}], "]"}], "]"}], "*",
            "weight1Int"}], ",", 
          RowBox[{"PlotTheme", "\[Rule]", " ", "\"\<Detailed\>\""}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase 2\>\""}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", "\"\<Int1\>\"", "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.8", ",", 
               RowBox[{"firstGenSize", "+", "0.2"}]}], "}"}], ",", "range"}], 
            "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "imgSize"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "\"\<Individuals\>\"", "}"}], ",", 
             RowBox[{"{", "\"\<Cost\>\"", "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p22", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"errorMtx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "2", ",", "2"}], "]"}], "]"}], "*",
            "weight2Int"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase 2\>\""}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", "\"\<Int2\>\"", "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Orange"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p23", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"errorMtx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "2", ",", "3"}], "]"}], "]"}], "*",
            "weightPh"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase 2\>\""}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", "\"\<Phase\>\"", "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p31", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"errorMtx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "3", ",", "1"}], "]"}], "]"}], "*",
            "weight1Int"}], ",", 
          RowBox[{"PlotTheme", "\[Rule]", " ", "\"\<Detailed\>\""}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase 3\>\""}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", "\"\<Int1\>\"", "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.8", ",", 
               RowBox[{"firstGenSize", "+", "0.2"}]}], "}"}], ",", "range"}], 
            "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "imgSize"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "\"\<Individuals\>\"", "}"}], ",", 
             RowBox[{"{", "\"\<Cost\>\"", "}"}]}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p32", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"errorMtx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "3", ",", "2"}], "]"}], "]"}], "*",
            "weight2Int"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase 3\>\""}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", "\"\<Int2\>\"", "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Orange"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p33", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"errorMtx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "3", ",", "3"}], "]"}], "]"}], "*",
            "weightPh"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Phase 3\>\""}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", "\"\<Phase\>\"", "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Show", "[", "p1", "]"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Row", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{"{", 
              RowBox[{"p11", ",", "p12", ",", "p13"}], "}"}], "]"}], ",", 
            RowBox[{"Show", "[", 
             RowBox[{"{", 
              RowBox[{"p21", ",", "p22", ",", "p23"}], "}"}], "]"}], ",", 
            RowBox[{"Show", "[", 
             RowBox[{"{", 
              RowBox[{"p31", ",", "p32", ",", "p33"}], "}"}], "]"}]}], "}"}], 
          ",", "\"\<\\t\>\""}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.8243767924761925`*^9, 3.8243771488360157`*^9}, {
  3.824377200575694*^9, 3.8243772370926676`*^9}, {3.8245465530567055`*^9, 
  3.824546554597972*^9}, {3.824556477193039*^9, 3.824556517195887*^9}, {
  3.824556572075884*^9, 3.8245565829195833`*^9}, {3.8245566824510856`*^9, 
  3.824556688029193*^9}, {3.828714619024868*^9, 3.828714706486249*^9}, {
  3.828714775414894*^9, 3.8287148057154884`*^9}, {3.8287148436022806`*^9, 
  3.8287148558845234`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[284]:=",ExpressionUUID->"38353bdc-6d56-44d9-ac89-35561fb445cb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Display Device", "Subsection",
 CellChangeTimes->{{3.8284410831757836`*^9, 3.828441085757975*^9}, {
  3.828441146296292*^9, 
  3.828441152084961*^9}},ExpressionUUID->"9fc6b17a-fc2f-4c11-bf14-\
5d8d67218b95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idDisplay", "[", "device_", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"radObjDrw", "[", "device", "]"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<3D Plot\>\""}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"14", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "}"}]}]}], 
        "]"}], ",", 
       RowBox[{"ImageMargins", "\[Rule]", "5"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"600", ",", "350"}], "}"}]}]}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.828441156567846*^9, 3.828441268240058*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[285]:=",ExpressionUUID->"16c69f02-5cd9-4b85-91c9-c48b70d2c245"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sorting Create Indiv", "Subsection",
 CellChangeTimes->{{3.8292198178017488`*^9, 
  3.829219825171417*^9}},ExpressionUUID->"16bbfc3b-c9f7-4e7c-88be-\
9fedc606ae0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idSortingCreateIndiv", "[", 
   RowBox[{
   "termType_", ",", "blockThick_", ",", "blockGap_", ",", "periodL_", ",", 
    "magnAmp_", ",", "magMtx_", ",", "idx_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "magTermFront", ",", "magTermBack", ",", "terminations", ",", "magList",
        ",", "nameList"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"magTermFront", "=", 
       RowBox[{"magMtx", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "idx", ",", "All", ",", 
          RowBox[{"1", ";;", "8"}], ",", "1"}], "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"magTermBack", "=", 
       RowBox[{"magMtx", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "idx", ",", "All", ",", 
          RowBox[{
           RowBox[{"-", "8"}], ";;", 
           RowBox[{"-", "1"}]}], ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"terminations", "=", 
       RowBox[{"idGenerateTerm", "[", 
        RowBox[{
        "termType", ",", "blockThick", ",", "blockGap", ",", "periodL", ",", 
         "magnAmp", ",", "magTermFront", ",", "magTermBack"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"magList", "=", 
       RowBox[{"magMtx", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "idx", ",", "All", ",", 
          RowBox[{"9", ";;", 
           RowBox[{"-", "9"}]}], ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nameList", "=", 
       RowBox[{"magMtx", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "idx", ",", "All", ",", "All", ",", "2"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"magList", ",", "terminations", ",", "nameList"}], "}"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.829219068610056*^9, 3.829219083937037*^9}, {
  3.82921914901527*^9, 3.8292192070956287`*^9}, {3.8292192794354916`*^9, 
  3.829219494287897*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[286]:=",ExpressionUUID->"7a603409-2e67-4a60-ab11-bdb2cecbd8c7"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculation", "Section",
 CellChangeTimes->{{3.8292154195925198`*^9, 
  3.8292154209673386`*^9}},ExpressionUUID->"ad3b45f7-eb85-4cfe-93ad-\
7fc761086791"],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.8233405764015217`*^9, 
  3.8233405780702906`*^9}},ExpressionUUID->"4279ff7f-278c-41f2-8ff7-\
03254173c71a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"===", 
    RowBox[{"==", " ", 
     RowBox[{"Magnetic", " ", "Design"}]}], " ", "===", "=="}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"periodL", "=", "52.5"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Period", " ", 
     RowBox[{"Length", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gap", "=", "13.6"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Minimum", " ", "ID", " ", 
     RowBox[{"gap", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nPeriods", "=", "21"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "number", " ", "of", " ", "periods", " ", "without", " ", 
     "terminations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blockGap", "=", "0.125"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"space", " ", "between", " ", 
     RowBox[{"blocks", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eEnergy", " ", "=", " ", "3"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Particle", " ", 
     RowBox[{"energy", " ", "[", "GeV", "]"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"===", 
     RowBox[{"=", " ", 
      RowBox[{
       RowBox[{"Magnetic", " ", "Blocks"}], " ", "===", "=="}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blockGeo", "=", 
     RowBox[{"idBlockGeometry", "[", "1", "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Blocks", " ", 
      RowBox[{"Geometry", ":", " ", "1"}]}], "=", "A1"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blockThick", "=", "13"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Block", " ", 
     RowBox[{"Thickness", " ", "[", "mm", "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"magInput", "=", "1"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Type", " ", "of", " ", "input", " ", "for", " ", 
        RowBox[{"Magnetizations", ":", " ", 
         RowBox[{
          RowBox[{"[", "1", "]"}], "Import", " ", "from", " ", "File"}]}]}], 
       " ", ";"}], " ", "[", "2", "]"}], "Aleatory", " ", "Generation"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fileNameB", "=", "\"\<Blocks_B_V3.xlsx\>\""}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Magnetizations", " ", "File", " ", "name", " ", 
      RowBox[{"(", 
       RowBox[{"with", " ", "extension"}], ")"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"headLineB", "=", "1"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Number", " ", "of", " ", "Head", " ", "Lines", " ", "on", " ", "the", 
      " ", "File"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"fileNameT", "=", "\"\<Blocks_T_V3.xlsx\>\""}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Magnetizations", " ", "File", " ", "name", " ", 
      RowBox[{"(", 
       RowBox[{"with", " ", "extension"}], ")"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"headLineT", "=", "1"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Number", " ", "of", " ", "Head", " ", "Lines", " ", "on", " ", "the", 
      " ", "File"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"magnAmp", "=", "1.37"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Remanent", " ", "Block", " ", 
      RowBox[{"Magnetization", " ", "[", "T", "]"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"magAmpError", "=", 
     RowBox[{"0.005", "*", "magnAmp"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Magnetization", " ", "Amplitude", " ", 
      RowBox[{"Error", " ", "[", "T", "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"magTheta", "=", "0.6"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Magnetization", " ", "Angle", " ", 
      RowBox[{"Error", " ", "[", "deg", "]"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"magError", "=", "0"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Include", 
      RowBox[{"(", "1", ")"}], " ", "or", " ", "not", 
      RowBox[{"(", "0", ")"}], " ", "magnetization", " ", "errors"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"posErrors", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Position", " ", "Error", " ", "Limit", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], "+", 
      RowBox[{"-", 
       RowBox[{"[", "mm", "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"===", 
      RowBox[{"==", " ", 
       RowBox[{"Other", " ", "Parameters"}]}], " ", "===", "=="}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"mode", "=", "1"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Phase", ":", " ", "1"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Linear", " ", 
         RowBox[{"Hor", "."}]}], " ", "|", " ", "2"}], "=", "?"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"symmetry", "=", "\"\<antisymmetric\>\""}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"ID", " ", 
      RowBox[{"symmetry", ":", " ", 
       RowBox[{
       "\"\<symmetric\>\"", " ", "or", " ", "\"\<antisymmetric\>\""}]}]}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"termType", "=", "\"\<FourBlocksAntiSymReal\>\""}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Termination", " ", 
      RowBox[{"Type", ":", " ", 
       RowBox[{
       "\"\<FourBlocksAntiSymReal\>\"", "|", "\"\<FourBlocksAntiSym\>\"", 
        "|", "\"\<ThreeBlocksAntiSym\>\"", "|", 
        "\"\<ThreeBlocksAntiSymReal\>\"", "|", "\"\<ThreeBlockSym\>\""}]}]}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"typeID", "=", "\"\<DeltaUndulator\>\""}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "\"\<DeltaUndulator\>\"", " ", "|", " ", "\"\<PlanarUndulator\>\"", " ", 
      "|", " ", "\"\<EPU\>\""}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gap2", "=", "0"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Horizontal", " ", "gap", " ", "in", " ", "case", " ", "of", " ", "EPU", 
      " ", 
      RowBox[{"undulator", " ", "[", "mm", "]"}]}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"===", 
      RowBox[{"==", " ", 
       RowBox[{"Calculation", " ", "Parameters"}]}], " ", "===", "=="}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"subdiv", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "subdivisons", " ", "on", " ", "each", " ", "part", " ", "of", " ", 
       "the", " ", "block", "  ", "geometry"}], ",", " ", 
      RowBox[{
       RowBox[{"for", " ", "each", " ", "direction", " ", 
        RowBox[{"(", 
         RowBox[{"nx", ",", "ny", ",", "nz"}], ")"}]}], ":", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], "}"}]}]}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Longitudinal", " ", 
      RowBox[{"Range", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"lstep", " ", "=", " ", "1"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Longitudinal", " ", 
      RowBox[{"Step", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"oversize", "=", "200"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Excess", " ", "on", " ", "each", " ", "side", " ", "to", " ", "start", 
      " ", "and", " ", "finish", " ", "the", " ", 
      RowBox[{"computations", " ", "[", "mm", "]"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"li", " ", "=", " ", 
     RowBox[{"-", "oversize"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lf", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"nPeriods", "+", "2"}], ")"}], "*", "periodL"}], "+", 
      "oversize"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lNpts", " ", "=", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"lf", " ", "-", "li"}], ")"}], "/", "lstep"}], " ", "]"}], 
      "+", " ", "1"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"===", 
     RowBox[{"==", " ", 
      RowBox[{"Sorting", " ", "Parameters"}]}], " ", "===", "=="}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nphase", "=", "3"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "number", " ", "of", " ", "phases", " ", "to", " ", "consider", " ", 
      "on", " ", 
      RowBox[{"Otimization", ":", " ", 
       RowBox[{"{", 
        RowBox[{
        "LinearHoriz", ",", " ", "LinearCirc", ",", " ", "LinearVert"}], 
        "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"firstGenSize", "=", "50"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "size", " ", "of", " ", "the", " ", "1", "st", " ", "generation"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bestList", "=", 
     RowBox[{"Subsets", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"19", ",", "30", ",", "10"}], "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "inserir", " ", "indices", " ", "dos", " ", "\"\<n\>\"", " ", "melhores", 
     " ", "individuos", " ", "do", " ", "teste", " ", "aleatorio"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nGen", "=", "9"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"gera\[CCedilla]\[OTilde]es", "+", "1"}], " ", "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.823006846322488*^9, 3.8230069060026283`*^9}, {
   3.823006941388849*^9, 3.8230069449799857`*^9}, {3.8230082923411474`*^9, 
   3.823008314869647*^9}, {3.8230083450346365`*^9, 3.8230085448784738`*^9}, {
   3.8230086058259954`*^9, 3.8230086213355737`*^9}, {3.8230087795682364`*^9, 
   3.823008785430538*^9}, {3.823008965891283*^9, 3.8230089992300415`*^9}, {
   3.8230094345273604`*^9, 3.82300949823573*^9}, {3.8230095512221775`*^9, 
   3.8230095520246325`*^9}, {3.8230095880543385`*^9, 3.823009601378403*^9}, {
   3.8230097311227455`*^9, 3.8230097578939714`*^9}, {3.823009807584254*^9, 
   3.8230098079696226`*^9}, {3.8230098428570642`*^9, 
   3.8230098468359966`*^9}, {3.823010010032849*^9, 3.8230100110343122`*^9}, {
   3.823010068984992*^9, 3.8230100879384785`*^9}, 3.8230102456885505`*^9, {
   3.8230104537277174`*^9, 3.823010454861856*^9}, {3.8230115432182617`*^9, 
   3.823011544168775*^9}, {3.8230116950258036`*^9, 3.8230117275651274`*^9}, {
   3.8230121502150497`*^9, 3.8230121680581884`*^9}, {3.8230126556711683`*^9, 
   3.823012658354679*^9}, {3.8230127168048267`*^9, 3.823012720145299*^9}, {
   3.8230128898960905`*^9, 3.8230129139649982`*^9}, {3.823013340726514*^9, 
   3.8230133465499244`*^9}, {3.823014861839714*^9, 3.823014887224802*^9}, 
   3.823014924421611*^9, 3.823015041881649*^9, {3.8230161642488713`*^9, 
   3.8230161743607426`*^9}, {3.823069516343995*^9, 3.82306969735824*^9}, {
   3.8230750570907884`*^9, 3.823075066587857*^9}, {3.8230751138885283`*^9, 
   3.823075121688725*^9}, {3.82307638514458*^9, 3.8230763913553643`*^9}, {
   3.8230767561550055`*^9, 3.8230767799497075`*^9}, {3.823076972005566*^9, 
   3.8230769726897955`*^9}, {3.823077093492547*^9, 3.823077123329562*^9}, {
   3.8230782723367176`*^9, 3.823078326605771*^9}, {3.8230812564981112`*^9, 
   3.8230812763505397`*^9}, {3.823081878241911*^9, 3.823081893386614*^9}, {
   3.823081924242709*^9, 3.823081955419917*^9}, {3.823082348054599*^9, 
   3.823082350590667*^9}, {3.82308381754845*^9, 3.8230838203767347`*^9}, {
   3.8230844145254054`*^9, 3.823084415041471*^9}, {3.8230848960481567`*^9, 
   3.8230849457792377`*^9}, {3.8230849781146765`*^9, 3.823085002122597*^9}, {
   3.823086962379418*^9, 3.823086962965016*^9}, {3.8230871113184395`*^9, 
   3.8230871139724236`*^9}, {3.823087144121188*^9, 3.8230871442528434`*^9}, {
   3.823087536933833*^9, 3.8230875403277884`*^9}, {3.8231010904696217`*^9, 
   3.8231011029430857`*^9}, {3.8231012026900797`*^9, 
   3.8231012215897465`*^9}, {3.8231031700030828`*^9, 
   3.8231031708937235`*^9}, {3.8231036474560947`*^9, 3.823103656580575*^9}, {
   3.823103805598419*^9, 3.823103815425969*^9}, {3.823103849234745*^9, 
   3.823103849609619*^9}, {3.823155572024024*^9, 3.823155576936425*^9}, {
   3.823169264835227*^9, 3.8231692710026717`*^9}, {3.8231693036017895`*^9, 
   3.823169340798465*^9}, {3.823169512809606*^9, 3.8231696333324413`*^9}, {
   3.823169677220273*^9, 3.823169765590374*^9}, {3.8231698277417507`*^9, 
   3.8231698878781633`*^9}, {3.8231699587880535`*^9, 
   3.8231700621037383`*^9}, {3.8231792859140596`*^9, 3.823179322539444*^9}, {
   3.8231819841366043`*^9, 3.8231821287743945`*^9}, {3.8231822857761173`*^9, 
   3.8231823344137163`*^9}, {3.8231824770813413`*^9, 
   3.8231824822671156`*^9}, {3.8231825228968573`*^9, 3.823182599333346*^9}, {
   3.8231826857036486`*^9, 3.8231827034896803`*^9}, {3.82318281990605*^9, 
   3.823182829500688*^9}, {3.8231829231504393`*^9, 3.8231830064309025`*^9}, {
   3.82318305488713*^9, 3.8231830765853043`*^9}, {3.823183112287979*^9, 
   3.823183147433326*^9}, {3.8231832040936003`*^9, 3.823183204664452*^9}, {
   3.8231852755965004`*^9, 3.823185278712427*^9}, {3.8231853893563633`*^9, 
   3.823185399354042*^9}, {3.8231857889341755`*^9, 3.823185790138307*^9}, {
   3.8231858580869827`*^9, 3.823185886365016*^9}, {3.8231859551904635`*^9, 
   3.823185967509987*^9}, {3.823186868199523*^9, 3.823186870173813*^9}, {
   3.823189511216112*^9, 3.823189516886362*^9}, 3.8232510714137216`*^9, {
   3.8232544917746634`*^9, 3.8232545094261303`*^9}, 3.8236774137198853`*^9, {
   3.8236774662021503`*^9, 3.8236774750625668`*^9}, {3.823677531087967*^9, 
   3.8236775527372704`*^9}, {3.82369999214837*^9, 3.823700004607412*^9}, {
   3.823700043710389*^9, 3.823700133937516*^9}, 3.8237002156291656`*^9, {
   3.823700392424648*^9, 3.82370039260953*^9}, 3.823700435905157*^9, {
   3.823703508507747*^9, 3.8237035106662517`*^9}, {3.8238664376058016`*^9, 
   3.8238664428184543`*^9}, {3.8238694120178137`*^9, 3.823869439996934*^9}, {
   3.823869634716196*^9, 3.823869681495384*^9}, {3.823872538179695*^9, 
   3.823872582563346*^9}, {3.8238726238316603`*^9, 3.8238726850192604`*^9}, {
   3.8242163670488667`*^9, 3.824216380910941*^9}, {3.824216440433897*^9, 
   3.824216463273857*^9}, {3.824216562877821*^9, 3.8242165897804356`*^9}, {
   3.824216621755506*^9, 3.824216626650219*^9}, {3.8242167192384005`*^9, 
   3.824216752347666*^9}, {3.8242175298929205`*^9, 3.824217589618078*^9}, {
   3.8242191570413933`*^9, 3.8242191903356256`*^9}, {3.8242901811746426`*^9, 
   3.824290183744201*^9}, {3.824298697135277*^9, 3.824298703184602*^9}, 
   3.824309094007413*^9, {3.8243779103701487`*^9, 3.824377917289545*^9}, {
   3.824385296570845*^9, 3.8243853424770327`*^9}, {3.82438573272908*^9, 
   3.8243857330449786`*^9}, {3.824457473878018*^9, 3.824457481148875*^9}, {
   3.8244592080639653`*^9, 3.824459210823598*^9}, {3.824478991219679*^9, 
   3.824479063525276*^9}, {3.8245443612090173`*^9, 3.824544363490386*^9}, {
   3.824548984555977*^9, 3.824548992277047*^9}, {3.828447305926165*^9, 
   3.8284473493394012`*^9}, {3.82845100379799*^9, 3.828451059132148*^9}, {
   3.828451104462695*^9, 3.828451161087073*^9}, {3.8292156591671963`*^9, 
   3.829215659354645*^9}, {3.829842157656287*^9, 3.8298421591406603`*^9}, {
   3.8314650851525927`*^9, 3.8314650870083637`*^9}, {3.8314652917988195`*^9, 
   3.8314652925060005`*^9}, {3.8314657693157225`*^9, 3.8314658426140566`*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"e09f2ade-ef71-487b-ac8d-afecef8816b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Crossover Function", "Subsection",
 CellChangeTimes->{{3.8296625155635643`*^9, 
  3.8296625201990614`*^9}},ExpressionUUID->"7b203568-8089-4ab8-85b5-\
2c02e1f62e16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"idSortingCrossover", "[", 
   RowBox[{
   "termType_", ",", "blockThick_", ",", "blockGap_", ",", "periodL_", ",", 
    "magnAmp_", ",", "magMtx_", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"idx1_", " ", ":", "0"}], ",", 
      RowBox[{"idx2_", " ", ":", "0"}]}], "}"}], ",", 
    RowBox[{"mag1_", " ", ":", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"mag2_", " ", ":", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"term1_", " ", ":", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"term2_", " ", ":", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"names1_", " ", ":", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"names2_", " ", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "magnetization1", ",", "magnetization2", ",", "termination1", ",", 
       "termination2", ",", "nameList1", ",", "nameList2", ",", "nup", ",", 
       "ndown", ",", "upIdxBottom", ",", "upMagBottom", ",", "downIdxBottom", 
       ",", "downMagBottom", ",", "upIdxTop", ",", "upMagTop", ",", 
       "downIdxTop", ",", "downMagTop", ",", "upIdx1", ",", "upMag1", ",", 
       "downIdx1", ",", "downMag1", ",", "upIdx2", ",", "upMag2", ",", 
       "downIdx2", ",", "downMag2", ",", "rptUp1", ",", "rptUp2", ",", 
       "rptDown1", ",", "rptDown2", ",", "offupIdx1", ",", "offupIdx2", ",", 
       "offupMag1", ",", "offupMag2", ",", "offdownIdx1", ",", "offdownIdx2", 
       ",", "offdownMag1", ",", "offdownMag2", ",", "off1", ",", "off1m", ",",
        "off2", ",", "off2m", ",", "prob", ",", "missupIdx1", ",", "idxmiss", 
       ",", "missupMag1", ",", "missupIdx2", ",", "missupMag2", ",", 
       "missdownIdx1", ",", "missdownMag1", ",", "missdownIdx2", ",", 
       "missdownMag2", ",", "offspring1", ",", "offspring2", ",", 
       "offspringIdx1", ",", "offspringIdx2", ",", "i", ",", "j"}], "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "magMtx", "]"}], "\[GreaterEqual]", " ", 
         "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Generate", " ", "Magnetizations", " ", "and", " ", "Terminations"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"magnetization1", ",", "termination1", ",", "nameList1"}], 
           "}"}], "=", 
          RowBox[{"idSortingCreateIndiv", "[", 
           RowBox[{
           "termType", ",", "blockThick", ",", "blockGap", ",", "periodL", 
            ",", "magnAmp", ",", "magMtx", ",", "idx1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"magnetization2", ",", "termination2", ",", "nameList2"}], 
           "}"}], "=", 
          RowBox[{"idSortingCreateIndiv", "[", 
           RowBox[{
           "termType", ",", "blockThick", ",", "blockGap", ",", "periodL", 
            ",", "magnAmp", ",", "magMtx", ",", "idx2"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"magnetization1", "=", "mag1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"magnetization2", "=", "mag2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"termination1", "=", "term1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"termination2", "=", "term2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"nameList1", "=", "names1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"nameList2", "=", "names2"}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", "Divide"}]}]}], " ", "by", " ", 
         RowBox[{
          RowBox[{"Types", " ", "--"}], "--"}]}], "-"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Get", " ", "index", " ", "and", " ", 
        RowBox[{"mag", ".", " ", "of"}], " ", "the", " ", "blocks", " ", 
        "with", " ", "vertical", " ", "magnetization", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"up", " ", "&"}], " ", "down"}], ")"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"nup", "=", "10"}], ";", " ", 
      RowBox[{"ndown", "=", "12"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Individual", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"upIdxBottom", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"nameList1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"nup", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"nameList1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "nup", "-", 
               "8"}], ")"}], "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"upMagBottom", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"magnetization1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"2", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"magnetization1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
             "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"downIdxBottom", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"nameList1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"ndown", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"nameList1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "ndown", "-", 
               "8"}], ")"}], "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"downMagBottom", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"magnetization1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"4", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"magnetization1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "4"}], ")"}], 
             "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"upIdxTop", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"nameList1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"ndown", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"nameList1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "nup", "-", 
               "8"}], ")"}], "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"upMagTop", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"magnetization1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"4", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"magnetization1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
             "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"downIdxTop", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"nameList1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"nup", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"nameList1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "ndown", "-", 
               "8"}], ")"}], "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"downMagTop", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"magnetization1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"2", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"magnetization1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "4"}], ")"}], 
             "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"upIdx1", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"upIdxBottom", ",", "upIdxTop"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"upMag1", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"upMagBottom", ",", "upMagTop"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"downIdx1", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"downIdxBottom", ",", "downIdxTop"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"downMag1", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"downMagBottom", ",", "downMagTop"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Individual", " ", "2"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"upIdxBottom", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"nameList2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"nup", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"nameList2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "nup", "-", 
               "8"}], ")"}], "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"upMagBottom", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"magnetization2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"2", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"magnetization2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
             "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"downIdxBottom", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"nameList2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"ndown", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"nameList2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "ndown", "-", 
               "8"}], ")"}], "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"downMagBottom", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"magnetization2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"4", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"magnetization2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "4"}], ")"}], 
             "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"upIdxTop", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"nameList2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"ndown", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"nameList2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "nup", "-", 
               "8"}], ")"}], "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"upMagTop", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"magnetization2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"4", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"magnetization2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
             "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"downIdxTop", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"nameList2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"nup", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"nameList2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "ndown", "-", 
               "8"}], ")"}], "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"downMagTop", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"magnetization2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"2", "+", 
             RowBox[{"4", "*", "j"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"magnetization2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "4"}], ")"}], 
             "/", "4"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"upIdx2", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"upIdxBottom", ",", "upIdxTop"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"upMag2", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"upMagBottom", ",", "upMagTop"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"downIdx2", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"downIdxBottom", ",", "downIdxTop"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"downMag2", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"downMagBottom", ",", "downMagTop"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Plain", " ", "Lists"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"upIdx1", " ", "=", " ", 
       RowBox[{"Flatten", "[", "upIdx1", "]"}]}], ";", 
      RowBox[{"upIdx2", " ", "=", " ", 
       RowBox[{"Flatten", "[", "upIdx2", "]"}]}], ";", 
      RowBox[{"downIdx1", "=", 
       RowBox[{"Flatten", "[", "downIdx1", "]"}]}], ";", 
      RowBox[{"downIdx2", "=", 
       RowBox[{"Flatten", "[", "downIdx2", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"upMag1", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"upMag1", ",", "1"}], "]"}]}], ";", 
      RowBox[{"upMag2", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"upMag2", ",", "1"}], "]"}]}], ";", 
      RowBox[{"downMag1", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"downMag1", ",", "1"}], "]"}]}], ";", 
      RowBox[{"downMag2", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"downMag2", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", "Uniform"}]}]}], " ", 
         RowBox[{
          RowBox[{"Crossover", " ", "--"}], "--"}]}], "-"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"==", " ", "Initialization", " ", "=="}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rptUp1", "=", 
       RowBox[{"rptUp2", "=", 
        RowBox[{"rptDown1", "=", 
         RowBox[{"rptDown2", "=", 
          RowBox[{"{", "}"}]}]}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Listas", " ", "com", " ", "indices", " ", "dos", " ", "blocos", " ", 
        "repetidos"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"offupIdx1", "=", 
       RowBox[{"offupIdx2", "=", 
        RowBox[{"offupMag1", "=", 
         RowBox[{"offupMag2", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "upIdx1", "]"}]}], "]"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"offdownIdx1", "=", 
       RowBox[{"offdownIdx2", " ", "=", 
        RowBox[{"offdownMag1", "=", 
         RowBox[{"offdownMag2", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "downIdx1", "]"}]}], "]"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"==", " ", 
        RowBox[{"Mag", " ", "Up"}], " ", "=="}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "upIdx1", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prob", "=", 
          RowBox[{"RandomSample", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"off1", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"upIdx1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"upIdx2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"off1m", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"upMag1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"upMag2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"off2", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"upIdx1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"upIdx2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"off2m", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"upMag1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"upMag2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"(*", "Check", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"offupIdx1", ",", "off1"}], "]"}], ",", 
           RowBox[{"rptUp1", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"rptUp1", ",", "i"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offupIdx1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "off1"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offupMag1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "off1m"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"offupIdx2", ",", "off2"}], "]"}], ",", 
           RowBox[{"rptUp2", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"rptUp2", ",", "i"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offupIdx2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "off2"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offupMag2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "off2m"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"==", " ", 
        RowBox[{"Mag", " ", "Down"}], " ", "=="}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "downIdx1", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prob", "=", 
          RowBox[{"RandomSample", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"off1", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"downIdx1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"downIdx2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"off1m", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"downMag1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"downMag2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"off2", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"downIdx1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"downIdx2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"off2m", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"downMag1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"prob", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"downMag2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"(*", "Check", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"offdownIdx1", ",", "off1"}], "]"}], ",", 
           RowBox[{"rptDown1", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"rptDown1", ",", "i"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offdownIdx1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "off1"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offdownMag1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "off1m"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"offdownIdx2", ",", "off2"}], "]"}], ",", 
           RowBox[{"rptDown2", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"rptDown2", ",", "i"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offdownIdx2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "off2"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offdownMag2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "off2m"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", "Missing"}]}]}], " ", 
         RowBox[{
          RowBox[{"Blocks", " ", "--"}], "--"}]}], "-"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"missupIdx1", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"upIdx1", ",", "offupIdx1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxmiss", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"upIdx1", ",", 
            RowBox[{"missupIdx1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "missupIdx1", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"missupMag1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"upMag1", "[", 
          RowBox[{"[", 
           RowBox[{"idxmiss", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "idxmiss", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"missupIdx2", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"upIdx2", ",", "offupIdx2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxmiss", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"upIdx2", ",", 
            RowBox[{"missupIdx2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "missupIdx2", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"missupMag2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"offupMag2", "[", 
          RowBox[{"[", 
           RowBox[{"idxmiss", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "idxmiss", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"missdownIdx1", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"downIdx1", ",", "offdownIdx1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxmiss", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"downIdx1", ",", 
            RowBox[{"missdownIdx1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "missdownIdx1", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"missdownMag1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"offdownMag1", "[", 
          RowBox[{"[", 
           RowBox[{"idxmiss", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "idxmiss", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"missdownIdx2", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"downIdx2", ",", "offdownIdx2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxmiss", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"downIdx2", ",", 
            RowBox[{"missdownIdx2", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "missdownIdx2", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"missdownMag2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"offdownMag2", "[", 
          RowBox[{"[", 
           RowBox[{"idxmiss", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "idxmiss", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "rptUp1", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"offupIdx1", "[", 
           RowBox[{"[", 
            RowBox[{"rptUp1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
          RowBox[{"missupIdx1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offupMag1", "[", 
           RowBox[{"[", 
            RowBox[{"rptUp1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
          RowBox[{"missupMag1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "rptUp2", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"offupIdx2", "[", 
           RowBox[{"[", 
            RowBox[{"rptUp2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
          RowBox[{"missupIdx2", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offupMag2", "[", 
           RowBox[{"[", 
            RowBox[{"rptUp2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
          RowBox[{"missupMag2", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "rptDown1", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"offdownIdx1", "[", 
           RowBox[{"[", 
            RowBox[{"rptDown1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
          RowBox[{"missdownIdx1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offdownMag1", "[", 
           RowBox[{"[", 
            RowBox[{"rptDown1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
          RowBox[{"missdownMag1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "rptDown2", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"offdownIdx2", "[", 
           RowBox[{"[", 
            RowBox[{"rptDown2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
          RowBox[{"missdownIdx2", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"offdownMag2", "[", 
           RowBox[{"[", 
            RowBox[{"rptDown2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
          RowBox[{"missdownMag2", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "Redimension", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"offupIdx1", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"offupIdx1", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", 
           RowBox[{
            RowBox[{"Length", "[", "offupIdx1", "]"}], "/", "4"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"offupIdx2", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"offupIdx2", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", 
           RowBox[{
            RowBox[{"Length", "[", "offupIdx2", "]"}], "/", "4"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"offdownIdx1", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"offdownIdx1", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", 
           RowBox[{
            RowBox[{"Length", "[", "offdownIdx1", "]"}], "/", "4"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"offdownIdx2", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"offdownIdx2", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", 
           RowBox[{
            RowBox[{"Length", "[", "offdownIdx2", "]"}], "/", "4"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"offupMag1", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"offupMag1", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", 
           RowBox[{
            RowBox[{"Length", "[", "offupMag1", "]"}], "/", "4"}], ",", "3"}],
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"offupMag2", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"offupMag2", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", 
           RowBox[{
            RowBox[{"Length", "[", "offupMag2", "]"}], "/", "4"}], ",", "3"}],
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"offdownMag1", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"offdownMag1", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", 
           RowBox[{
            RowBox[{"Length", "[", "offdownMag1", "]"}], "/", "4"}], ",", 
           "3"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"offdownMag2", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"offdownMag2", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", 
           RowBox[{
            RowBox[{"Length", "[", "offdownMag2", "]"}], "/", "4"}], ",", 
           "3"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"offspring1", "=", "magnetization1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"offspring2", "=", "magnetization2"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"offspringIdx1", "=", 
       RowBox[{"nameList1", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"9", ";;", 
           RowBox[{"-", "9"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"offspringIdx2", "=", 
       RowBox[{"nameList2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"9", ";;", 
           RowBox[{"-", "9"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "4"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", " ", 
           RowBox[{
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"magnetization1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "2"}], ")"}], 
              "/", "4"}], "]"}], "+", "1"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"i", "\[LessEqual]", " ", "2"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Cassetes", " ", "de", " ", "baixo"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"offspring1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"2", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offupMag1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspring2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"2", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offupMag2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspring1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"4", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offdownMag1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspring2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"4", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offdownMag2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspringIdx1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"2", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offupIdx1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspringIdx2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"2", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offupIdx2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspringIdx1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"4", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offdownIdx1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspringIdx2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"4", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offdownIdx2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"i", ">", "2"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Cassetes", " ", "de", " ", "cima"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"offspring1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"4", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offupMag1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspring2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"4", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offupMag2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspring1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"2", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offdownMag1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspring2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"2", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offdownMag2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspringIdx1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"4", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offupIdx1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspringIdx2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"4", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offupIdx2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspringIdx1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"2", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offdownIdx1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"offspringIdx2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"2", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}]}]}], "]"}], "]"}], "=", 
              RowBox[{"offdownIdx2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"offspringIdx1", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"nameList1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"1", ";;", "8"}]}], "]"}], "]"}], ",", "offspringIdx1", 
         ",", 
         RowBox[{"nameList1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{
             RowBox[{"-", "8"}], ";;", 
             RowBox[{"-", "1"}]}]}], "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"offspringIdx2", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"nameList2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"1", ";;", "8"}]}], "]"}], "]"}], ",", "offspringIdx2", 
         ",", 
         RowBox[{"nameList2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{
             RowBox[{"-", "8"}], ";;", 
             RowBox[{"-", "1"}]}]}], "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "offspring1", ",", "offspringIdx1", ",", "termination1", ",", 
         "offspring2", ",", "offspringIdx2", ",", "termination2"}], "}"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8296625283349037`*^9, 3.829662807931272*^9}, {
   3.8296628389876647`*^9, 3.8296629570720463`*^9}, {3.829663057152011*^9, 
   3.8296633214828887`*^9}, {3.8296638839502025`*^9, 
   3.8296639065992637`*^9}, {3.8296639476238165`*^9, 3.829664217481922*^9}, {
   3.829665996802315*^9, 3.8296660033483*^9}, {3.8296660412311363`*^9, 
   3.829666050175375*^9}, {3.8296661026665397`*^9, 3.8296661072518*^9}, {
   3.82966862300766*^9, 3.8296686233952036`*^9}, {3.829668978802273*^9, 
   3.829668980595705*^9}, {3.8296693082018147`*^9, 3.82966931305974*^9}, {
   3.829730997808041*^9, 3.82973106567768*^9}, {3.8297311061752925`*^9, 
   3.8297312772814503`*^9}, {3.829753805662339*^9, 3.8297538428973923`*^9}, {
   3.829753888789158*^9, 3.829753907729221*^9}, {3.8297565250498734`*^9, 
   3.829756526944701*^9}, {3.8297567842548485`*^9, 3.8297567967595205`*^9}, {
   3.8297568297490687`*^9, 3.829756838000559*^9}, 3.829756875047163*^9, 
   3.8297569064895487`*^9, {3.829756960772829*^9, 3.829756963594573*^9}, {
   3.8297570194000835`*^9, 3.8297570202680593`*^9}, {3.8297572751531734`*^9, 
   3.829757279805317*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[317]:=",ExpressionUUID->"f951ebae-15ff-40a7-ac07-638e5b6246b0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Looping", "Subsection",
 CellChangeTimes->{{3.829216500037281*^9, 
  3.829216512583295*^9}},ExpressionUUID->"86547095-574a-45c4-9fcc-\
02f0a4eb716e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DumpGet", "[", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<magMtx.mx\>\""}], 
    "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Individuals", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genSize", "=", 
   RowBox[{
    RowBox[{"Length", "[", "bestList", "]"}], "*", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<> Generations: \>\"", ",", " ", 
   RowBox[{"nGen", "-", "1"}], ",", "\"\<\\n> Individual/Gen. : \>\"", ",", 
   "genSize", ",", "\"\<\\n> Total Individuals: \>\"", ",", 
   RowBox[{"genSize", "*", 
    RowBox[{"(", 
     RowBox[{"nGen", "-", "1"}], ")"}]}], ",", 
   "\"\<\\n> Total Simulation Number: \>\"", ",", 
   RowBox[{"nphase", "*", "genSize", "*", 
    RowBox[{"(", 
     RowBox[{"nGen", "-", "1"}], ")"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8245578189937086`*^9, 3.8245584637093277`*^9}, {
   3.824559649911811*^9, 3.824559702056785*^9}, {3.824560223568327*^9, 
   3.8245602288197155`*^9}, {3.828536044692817*^9, 3.82853623127105*^9}, {
   3.8296683171310315`*^9, 3.829668423128566*^9}, {3.8296684761746793`*^9, 
   3.8296684777303843`*^9}, {3.8296685184754725`*^9, 
   3.8296685981970277`*^9}, {3.8296686580699167`*^9, 3.829668747515846*^9}, 
   3.8296688019385076`*^9, {3.8296688516983323`*^9, 3.8296688682734623`*^9}, {
   3.829668965593754*^9, 3.82966915968563*^9}, {3.829669227333377*^9, 
   3.829669229429205*^9}, {3.829669320619213*^9, 3.8296694152206945`*^9}, {
   3.829669980376652*^9, 3.8296699953364954`*^9}, 3.829725456037351*^9, {
   3.8297321208565493`*^9, 3.829732123660103*^9}, {3.8297326052942114`*^9, 
   3.8297326187008133`*^9}, {3.829734921403778*^9, 3.8297349422111597`*^9}, {
   3.8297450732758274`*^9, 3.8297450737318263`*^9}, {3.8297451090081034`*^9, 
   3.8297451094155197`*^9}, {3.829745772607671*^9, 3.829745775820593*^9}, {
   3.8297458450582485`*^9, 3.8297458483401527`*^9}, {3.829754222693959*^9, 
   3.8297542351070175`*^9}, {3.8298157682601943`*^9, 3.829815768601742*^9}, {
   3.829842086980028*^9, 3.8298420921206446`*^9}, {3.8298422195787845`*^9, 
   3.829842220406907*^9}, {3.8298423212779646`*^9, 3.829842321918625*^9}, {
   3.8298426322297335`*^9, 3.8298426560935364`*^9}, {3.8298974908101606`*^9, 
   3.829897512795768*^9}, {3.8298977151522055`*^9, 3.8298977410453835`*^9}, {
   3.829897842330126*^9, 3.8298979845610933`*^9}, {3.8298980897346854`*^9, 
   3.8298981531377535`*^9}, {3.8298981849553146`*^9, 3.829898196924058*^9}, {
   3.8299209621157756`*^9, 3.829920975178347*^9}, {3.830598530125183*^9, 
   3.8305985366095405`*^9}, {3.8314652830984125`*^9, 3.831465284492791*^9}, {
   3.8314658223498116`*^9, 3.831465835905521*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"afa167dc-2d48-4144-954a-1d254cf61099"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"> Generations: \"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"\\n> Individual/Gen. : \"\>", 
   "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"\\n> Total Individuals: \"\>", 
   "\[InvisibleSpace]", "48", 
   "\[InvisibleSpace]", "\<\"\\n> Total Simulation Number: \"\>", 
   "\[InvisibleSpace]", "144"}],
  SequenceForm[
  "> Generations: ", 8, "\n> Individual/Gen. : ", 6, 
   "\n> Total Individuals: ", 48, "\n> Total Simulation Number: ", 144],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8298979850767107`*^9, 3.8298980928722844`*^9, {3.8298981483746977`*^9, 
   3.8298981538721037`*^9}, {3.829898186205302*^9, 3.829898197892771*^9}, 
   3.8298982370578365`*^9, 3.8305985567524815`*^9},
 CellLabel->
  "During evaluation of \
In[318]:=",ExpressionUUID->"c1727a0d-d5f9-46c6-bf5b-105584c501f5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Individuals", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"magMtx2", "=", 
    RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
    "mag1", ",", "idx1", ",", "term1", ",", "mag2", ",", "idx2", ",", 
     "term2"}], "}"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indiv", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"idSortingCrossover", "[", 
       RowBox[{
       "termType", ",", "blockThick", ",", "blockGap", ",", "periodL", ",", 
        "magnAmp", ",", "magMtx", ",", 
        RowBox[{"bestList", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "[", "bestList", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", " ", 
     RowBox[{"Length", "[", "indiv", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"Individuals", ",", 
       RowBox[{"indiv", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"Individuals", ",", 
       RowBox[{"indiv", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", 
          RowBox[{"4", ";;", "6"}]}], "]"}], "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"magMtx2", "=", "Individuals"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8245578189937086`*^9, 3.8245584637093277`*^9}, {
   3.824559649911811*^9, 3.824559702056785*^9}, {3.824560223568327*^9, 
   3.8245602288197155`*^9}, {3.828536044692817*^9, 3.82853623127105*^9}, {
   3.8296683171310315`*^9, 3.829668423128566*^9}, {3.8296684761746793`*^9, 
   3.8296684777303843`*^9}, {3.8296685184754725`*^9, 
   3.8296685981970277`*^9}, {3.8296686580699167`*^9, 3.829668747515846*^9}, 
   3.8296688019385076`*^9, {3.8296688516983323`*^9, 3.8296688682734623`*^9}, {
   3.829668965593754*^9, 3.82966915968563*^9}, {3.829669227333377*^9, 
   3.829669229429205*^9}, {3.829669320619213*^9, 3.8296694152206945`*^9}, {
   3.829669980376652*^9, 3.8296699953364954`*^9}, 3.829725456037351*^9, {
   3.8297255571154137`*^9, 3.8297256941733165`*^9}, {3.8297257653766413`*^9, 
   3.829725789836381*^9}, {3.829725846933897*^9, 3.8297258619644527`*^9}, {
   3.8297259014382367`*^9, 3.829725928673128*^9}, {3.8297259635210896`*^9, 
   3.8297259883079414`*^9}, {3.8297260251770735`*^9, 3.829726105322796*^9}, {
   3.829726167326501*^9, 3.8297262231472597`*^9}, {3.8297262772193146`*^9, 
   3.8297262914608173`*^9}, {3.8297263235214653`*^9, 
   3.8297263315011826`*^9}, {3.8297264225367393`*^9, 
   3.8297264286528616`*^9}, {3.8297264723804045`*^9, 3.8297265073275995`*^9}, 
   3.82972724633954*^9, {3.8297275243847017`*^9, 3.829727526980255*^9}, {
   3.8297275979608173`*^9, 3.82972766465506*^9}, {3.829727745320199*^9, 
   3.8297277573024287`*^9}, {3.829728398246938*^9, 3.829728400080544*^9}, {
   3.8297285254348326`*^9, 3.8297285319752913`*^9}, 3.8297285919321566`*^9, {
   3.8297286455269585`*^9, 3.829728647253047*^9}, {3.8297287582345133`*^9, 
   3.8297287695301547`*^9}, {3.8297288396833477`*^9, 3.829728892269039*^9}, {
   3.8297289252473173`*^9, 3.8297289300149183`*^9}, {3.8297290592517357`*^9, 
   3.8297290779404287`*^9}, {3.8297291504260244`*^9, 
   3.8297291694314556`*^9}, {3.82972936494391*^9, 3.8297293652405806`*^9}, {
   3.829729532952409*^9, 3.829729533315716*^9}, 3.829729619738879*^9, {
   3.8297296913586683`*^9, 3.8297296922122*^9}, {3.8297297303001213`*^9, 
   3.8297297353349543`*^9}, {3.829730229679861*^9, 3.829730268843642*^9}, 
   3.829730964927479*^9, 3.8297313384614987`*^9, {3.8297358790914125`*^9, 
   3.829735883050997*^9}, {3.8297362665392337`*^9, 3.8297362672051573`*^9}, {
   3.829745095553774*^9, 3.8297450957833943`*^9}, {3.8297458527159643`*^9, 
   3.829745856266898*^9}, {3.8297469987004485`*^9, 3.8297469989166627`*^9}, {
   3.8298157655817327`*^9, 3.8298157664472466`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[324]:=",ExpressionUUID->"15379898-1804-4b53-a228-76ea4e41ecf8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"costPhase", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "nphase"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errorMtx2", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nGen", "-", "1"}], ",", "genSize", ",", "nphase"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"costTotal2", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nGen", "-", "1"}], ",", "genSize"}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indicator", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"generation", "=", "1"}], ",", 
      RowBox[{"generation", "\[LessEqual]", " ", 
       RowBox[{"nGen", "-", "1"}]}], ",", 
      RowBox[{"generation", "++"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "Individuals", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"phase", "=", "1"}], ",", 
            RowBox[{"phase", "\[LessEqual]", "nphase"}], ",", 
            RowBox[{"phase", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"indicator", "+=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", "Draw", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"device", "=", 
              RowBox[{"idDraw", "[", 
               RowBox[{
                RowBox[{"typeID", "=", "\"\<DeltaUndulator\>\""}], ",", "gap",
                 ",", "nPeriods", ",", "periodL", ",", "blockGeo", ",", 
                "blockThick", ",", "blockGap", ",", 
                RowBox[{"Individuals", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"Individuals", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "phase", ",", 
                "subdiv"}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"status", "=", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<[Gen.\>\"", ",", 
                RowBox[{"ToString", "[", "generation", "]"}], ",", 
                "\"\< , Indiv.\>\"", ",", 
                RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<, Phase \>\"", 
                ",", 
                RowBox[{"ToString", "[", "phase", "]"}], ",", 
                "\"\<] (Solving...)\>\""}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", "Solve", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"idSolve", "[", "device", "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"status", "=", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<[Gen.\>\"", ",", 
                RowBox[{"ToString", "[", "generation", "]"}], ",", 
                "\"\< , Indiv.\>\"", ",", 
                RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<, Phase \>\"", 
                ",", 
                RowBox[{"ToString", "[", "phase", "]"}], ",", 
                "\"\<] (Calc. Field...)\>\""}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", "Field", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"baxis", "=", 
              RowBox[{"idField", "[", 
               RowBox[{"device", ",", "li", ",", "lf", ",", "lNpts", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"display", "=", "0"}], ",", 
                RowBox[{"oneplot", "=", "0"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Integral", " ", "Error"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"integral", "=", 
              RowBox[{"idFieldInt", "[", 
               RowBox[{
               "device", ",", "li", ",", "lf", ",", "lstep", ",", "baxis", 
                ",", 
                RowBox[{"display", "=", "0"}], ",", 
                RowBox[{"oneplot", "=", "0"}]}], "]"}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"Int1Error", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"integral", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ")"}], "^", 
                   "2"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"integral", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ")"}], "^", 
                   "2"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"integral", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], ")"}], "^", 
                   "2"}]}], ")"}], "/", "3"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Int2Error", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"integral", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ")"}], "^", 
                   "2"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"integral", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ")"}], "^", 
                   "2"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"integral", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], ")"}], "^", 
                   "2"}]}], ")"}], "/", "3"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"status", "=", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<[Gen.\>\"", ",", 
                RowBox[{"ToString", "[", "generation", "]"}], ",", 
                "\"\< , Indiv.\>\"", ",", 
                RowBox[{"ToString", "[", "i", "]"}], ",", "\"\<, Phase \>\"", 
                ",", 
                RowBox[{"ToString", "[", "phase", "]"}], ",", 
                "\"\<] (Trajectory...)\>\""}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", "Trajetoria", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Trajetoria", "=", 
              RowBox[{"idTrajectory", "[", 
               RowBox[{"device", ",", " ", "eEnergy", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "li", ",", "0", ",", "0", ",", "1"}], 
                 "}"}], ",", "lf", ",", "lstep", ",", 
                RowBox[{"display", "=", "0"}]}], "]"}]}], " ", ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Phase", " ", "Error"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"phError", "=", 
              RowBox[{"idPhaseError", "[", 
               RowBox[{
               "baxis", ",", "li", ",", "lf", ",", "lNpts", ",", "Trajetoria",
                 ",", "eEnergy"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Error", " ", "Function"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"weight1Int", "=", 
              RowBox[{"1", "/", "77"}]}], ";", " ", 
             RowBox[{"weight2Int", "=", 
              RowBox[{"1", "/", "7.6"}]}], ";", " ", 
             RowBox[{"weightPh", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"costPhase", "[", 
               RowBox[{"[", "phase", "]"}], "]"}], "=", " ", 
              RowBox[{
               RowBox[{"Int1Error", "*", "weight1Int"}], "+", 
               RowBox[{"Int2Error", "*", "weight2Int"}], "+", 
               RowBox[{
                RowBox[{"RootMeanSquare", "[", "phError", "]"}], "*", 
                "weightPh"}]}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"errorMtx2", "[", 
               RowBox[{"[", 
                RowBox[{"generation", ",", "i", ",", "phase"}], "]"}], "]"}], 
              "=", 
              RowBox[{"{", 
               RowBox[{"Int1Error", ",", "Int2Error", ",", 
                RowBox[{"RootMeanSquare", "[", "phError", "]"}]}], "}"}]}], 
             ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
          ";", 
          RowBox[{"(*", "Phase", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"costTotal2", "[", 
            RowBox[{"[", 
             RowBox[{"generation", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"costPhase", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "nphase"}], "}"}]}], "]"}], "/", 
            "nphase"}]}], ";"}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], ";", 
       RowBox[{"(*", "Individuals", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"generation", "<", " ", 
          RowBox[{"nGen", "-", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Define", " ", "the", " ", "Best", " ", "individuals"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"idxMin", "=", 
           RowBox[{"Ordering", "[", 
            RowBox[{"costTotal2", "[", 
             RowBox[{"[", "generation", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"idSortingCrossover", "[", 
            RowBox[{
            "termType", ",", "blockThick", ",", "blockGap", ",", "periodL", 
             ",", "magnAmp", ",", "magMtx", ",", 
             RowBox[{"{", 
              RowBox[{"idx1", ",", "idx2"}], "}"}], ",", "mag1", ",", "mag2", 
             ",", "term1", ",", "term2", ",", "names1", ",", "names2"}], 
            "]"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"indiv", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"idSortingCrossover", "[", 
              RowBox[{
              "termType", ",", "blockThick", ",", "blockGap", ",", "periodL", 
               ",", "magnAmp", ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"Individuals", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"idxMin", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "k"}], "-", "1"}], "]"}], "]"}], ",", 
                  "1"}], "]"}], "]"}], ",", 
               RowBox[{"Individuals", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"idxMin", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", "*", "k"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", 
               RowBox[{"Individuals", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"idxMin", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "k"}], "-", "1"}], "]"}], "]"}], ",", 
                  "3"}], "]"}], "]"}], ",", 
               RowBox[{"Individuals", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"idxMin", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", "*", "k"}], "]"}], "]"}], ",", "3"}], "]"}], 
                "]"}], ",", 
               RowBox[{"Individuals", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"idxMin", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "k"}], "-", "1"}], "]"}], "]"}], ",", 
                  "2"}], "]"}], "]"}], ",", 
               RowBox[{"Individuals", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"idxMin", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", "*", "k"}], "]"}], "]"}], ",", "2"}], "]"}], 
                "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"genSize", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Individuals", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"crossover", "=", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{
              "offspring1", ",", "offspringIdx1", ",", "termination1", ",", 
               "offspring2", ",", "offspringIdx2", ",", "termination2"}], 
              "}"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", " ", 
             RowBox[{"Length", "[", "indiv", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"Individuals", ",", 
               RowBox[{"indiv", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"Individuals", ",", 
               RowBox[{"indiv", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"4", ";;", "6"}]}], "]"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"magMtx2", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"magMtx2", ",", "Individuals", ",", "1"}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}], 
    RowBox[{"(*", "Generation", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", ",", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProgressIndicator", "[", 
        RowBox[{"indicator", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"genSize", "*", "nGen", "*", "nphase"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"indicator", "/", 
         RowBox[{"(", 
          RowBox[{"genSize", "*", "nGen", "*", "nphase"}], ")"}]}], "*", 
        "100.0"}], ",", "\"\<[%]  \>\"", ",", " ", "status"}], "}"}], "]"}]}],
    "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8245578189937086`*^9, 3.8245584637093277`*^9}, {
   3.824559649911811*^9, 3.824559702056785*^9}, {3.824560223568327*^9, 
   3.8245602288197155`*^9}, {3.828536044692817*^9, 3.82853623127105*^9}, {
   3.8296683171310315`*^9, 3.829668423128566*^9}, {3.8296684761746793`*^9, 
   3.8296684777303843`*^9}, {3.8296685184754725`*^9, 
   3.8296685981970277`*^9}, {3.8296686580699167`*^9, 3.829668747515846*^9}, 
   3.8296688019385076`*^9, {3.8296688516983323`*^9, 3.8296688682734623`*^9}, {
   3.829668965593754*^9, 3.82966915968563*^9}, {3.829669227333377*^9, 
   3.829669229429205*^9}, {3.829669320619213*^9, 3.8296694152206945`*^9}, {
   3.829669980376652*^9, 3.8296699953364954`*^9}, 3.829725456037351*^9, {
   3.8297255571154137`*^9, 3.8297256941733165`*^9}, {3.8297257653766413`*^9, 
   3.829725789836381*^9}, {3.829725846933897*^9, 3.8297258619644527`*^9}, {
   3.8297259014382367`*^9, 3.829725928673128*^9}, {3.8297259635210896`*^9, 
   3.8297259883079414`*^9}, {3.8297260251770735`*^9, 3.829726105322796*^9}, {
   3.829726167326501*^9, 3.8297262231472597`*^9}, {3.8297262772193146`*^9, 
   3.8297262914608173`*^9}, {3.8297263235214653`*^9, 
   3.8297263315011826`*^9}, {3.8297264225367393`*^9, 
   3.8297264286528616`*^9}, {3.8297264723804045`*^9, 3.8297265073275995`*^9}, 
   3.82972724633954*^9, {3.8297275243847017`*^9, 3.829727526980255*^9}, {
   3.8297275979608173`*^9, 3.82972766465506*^9}, {3.829727745320199*^9, 
   3.8297277573024287`*^9}, {3.829728398246938*^9, 3.829728400080544*^9}, {
   3.8297285254348326`*^9, 3.8297285319752913`*^9}, 3.8297285919321566`*^9, {
   3.829729299509204*^9, 3.8297293128891125`*^9}, {3.8297294924697495`*^9, 
   3.8297295317669225`*^9}, {3.829729587847755*^9, 3.8297295883785095`*^9}, {
   3.829729782502267*^9, 3.8297297836116724`*^9}, {3.829729853998835*^9, 
   3.829729907899186*^9}, {3.8297299652041845`*^9, 3.8297300593392553`*^9}, {
   3.829730109011265*^9, 3.829730126112652*^9}, {3.82973035919039*^9, 
   3.8297303807005105`*^9}, {3.829730749457484*^9, 3.8297307949009275`*^9}, {
   3.8297308718171616`*^9, 3.8297308821021395`*^9}, {3.829731360186076*^9, 
   3.8297313728162923`*^9}, {3.8297314075759687`*^9, 3.8297316000377383`*^9}, 
   3.829731660395401*^9, {3.8297318759829845`*^9, 3.829731908048459*^9}, {
   3.829732004216231*^9, 3.82973204508578*^9}, {3.8297321513374057`*^9, 
   3.829732151604883*^9}, {3.829733816143653*^9, 3.829733825278923*^9}, {
   3.829733871183074*^9, 3.8297338728083477`*^9}, {3.82973529726505*^9, 
   3.8297353460417056`*^9}, {3.829735896450473*^9, 3.829735897693061*^9}, {
   3.82973599801724*^9, 3.8297360468978825`*^9}, {3.8297440785539975`*^9, 
   3.8297441188944454`*^9}, {3.829744331664533*^9, 3.8297444409936686`*^9}, {
   3.8297449906127925`*^9, 3.829744995042244*^9}, {3.829745752910314*^9, 
   3.8297457531539793`*^9}, {3.8297502291077237`*^9, 3.829750309510939*^9}, {
   3.82975062014517*^9, 3.8297506642620497`*^9}, {3.829752909291978*^9, 
   3.829752916201804*^9}, {3.829754042242815*^9, 3.82975409465372*^9}, {
   3.8297574164894915`*^9, 3.8297574168414145`*^9}, {3.829840429359511*^9, 
   3.8298405696955194`*^9}, {3.829840607013707*^9, 3.8298408180590677`*^9}, {
   3.829840870607006*^9, 3.8298408918453712`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[329]:=",ExpressionUUID->"4a8c822e-a4e2-40ee-90d0-541035b9a7c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<errorMtx2.mx\>\""}], 
     "]"}], ",", "errorMtx2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<magMtx2.mx\>\""}], 
     "]"}], ",", "magMtx2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<costTotal2.mx\>\""}],
      "]"}], ",", "costTotal2"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8297591425754366`*^9, 3.8297592298563104`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[334]:=",ExpressionUUID->"0e77d0f4-a848-4005-a9dd-06ffe611995a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Post-Processing", "Section",
 CellChangeTimes->{{3.829840078996004*^9, 
  3.829840082290922*^9}},ExpressionUUID->"93aaa47b-a396-4161-91ca-\
49b667c0b840"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", "costTotal2", "]"}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<\[FilledCircle]\>\"", ",", "10"}], "}"}]}], ",", 
   RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<Total Cost: \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"nGen", "-", "1"}], "]"}], ",", "\"\< generations, \>\"", 
        ",", 
        RowBox[{"ToString", "[", "genSize", "]"}], ",", 
        "\"\< individuals\>\""}], "]"}], ",", "Bold", ",", "13"}], "]"}]}], 
   ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"All", ",", "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"nGen", "*", "genSize"}], "]"}], ",", "None"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"300", ",", "100"}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"3", "/", "10"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.829896510234274*^9, 3.829896510827998*^9}, {
  3.8299191794932413`*^9, 3.8299191953323107`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[337]:=",ExpressionUUID->"d316d4ed-54ce-4083-af58-19d4fd0e62f1"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAGIQDQEf7Ff8nFr1SULFASrgsGXipnZeK0Mon8Nh7teQ
zC5vLShfwKFEb6lyVIkylC/iMO/isw/romSgfAkHs7+xzWaHVKF8GYcyzuDD
BT5GUL6Cw6Xkmgz5u6ZQvpJD/3KZ9Tz1SlC+ioOqyaP3/dc0oHw1hx1CC3vc
1GH6NRw2zDic+yROHcrXcrCIvBu5tEoUytdxuMubpvVUShLK13O4VhphurMG
5n4Dh4J2S56ELhMo39Dhapf6t4A8ISjfyOHnbS/eH581oXxjBwGWhUt3ZchC
+SYOc75GMf/+qADlmzq0hLyrWyQjDuWbOSgd+8LYYggLP3MHg713VAV360L5
Fg5dG9UdqoVh7rd0UOFOm3D+rA6Ub+Xww/pVWedsCSjf2oHz51dtjTZYeNk4
1G7gf8XgA7PP1mHOtK+i4jXGUL6dwxa7t+uVD8Dcb+9g9X2zx3oFWHw5OAQd
3O9esBUang0ODg8m8Wz9LApzr6NDkGmznk0i1H0Njg5mzh3ruzbC3OfkcKhJ
rHaWjwFU3slBfvK0zn/zBKHyzg4BmVPXie+Vh8o7O1hovQ+YqAeLPxeHZ5Pu
HPA+CPVPg4uDgSTvXrEJSlB5V4cFtxffN3wA5Te4OsSZRdeH6EpB5d0cFiZH
vuW8BTPfzeFUkaPC7POw8HR3WKdzbMITX5j73B2iAstdFprAwsfDgevh+xNS
V7UcAEkZve4=
       "]]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
     GeometricTransformationBox[InsetBox[
       StyleBox["\<\"\[FilledCircle]\"\>",
        StripOnInput->False,
        FontSize->10], {0., 0.}], CompressedData["
1:eJxTTMoPSmVmYGAwAGJGIGZigIEP9it+Tq36JKHiABVw2DJxUzuvlSGUz+Ew
92tIZpe3FpQv4FCit1Q5qkQZyhdxmHfx2Yd1UTJQvoSD2d/YZrNDqlC+jEMZ
Z/DhAh8jKF/B4VJyTYb8XVMoX8mhf7nMep56JShfxUHV5NH7/msaUL6aww6h
hT1u6jD9Gg4bZhzOfRKnDuVrOVhE3o1cWiUK5es43OVN03oqJQnl6zlcK40w
3VkDc7+BQ0G7JU9ClwmUb+hwtUv9W0CeEJRv5PDzthfvj8+aUL6xgwDLwqW7
MmShfBOHOV+jmH9/VIDyTR1aQt7VLZIRh/LNHJSOfWFsMYSFn7mDwd47qoK7
daF8C4eujeoO1cIw91s6qHCnTTh/VgfKt3L4Yf2qrHO2BJRv7cD586u2Rhss
vGwcajfwv2Lwgdln6zBn2ldR8RpjKN/OYYvd2/XKB2Dut3ew+r7ZY70CLL4c
HIIO7ncv2AoNzwYHhweTeLZ+FoW519EhyLRZzyYR6r4GRwcz5471XRth7nNy
ONQkVjvLxwAq7+QgP3la5795glB5Z4eAzKnrxPfKQ+WdHSy03gdM1IPFn4vD
s0l3DngfhPqnwcXBQJJ3r9gEJai8q8OC24vvGz6A8htcHeLMoutDdKWg8m4O
C5Mj33Legpnv5nCqyFFh9nlYeLo7rNM5NuGJL8x97g5RgeUuC01g4ePhwPXw
/Qmpq1oOAFahvfA=
      "]]}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[
      1.6]}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[
      1.6]}, {}}}, {{}, {}}},
  AspectRatio->NCache[
    Rational[3, 10], 0.3],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Automatic,
  FrameTicks->{{All, None}, {{{1, 
       FormBox["1", TraditionalForm]}, {2, 
       FormBox["2", TraditionalForm]}, {3, 
       FormBox["3", TraditionalForm]}, {4, 
       FormBox["4", TraditionalForm]}, {5, 
       FormBox["5", TraditionalForm]}, {6, 
       FormBox["6", TraditionalForm]}, {7, 
       FormBox["7", TraditionalForm]}, {8, 
       FormBox["8", TraditionalForm]}, {9, 
       FormBox["9", TraditionalForm]}, {10, 
       FormBox["10", TraditionalForm]}, {11, 
       FormBox["11", TraditionalForm]}, {12, 
       FormBox["12", TraditionalForm]}, {13, 
       FormBox["13", TraditionalForm]}, {14, 
       FormBox["14", TraditionalForm]}, {15, 
       FormBox["15", TraditionalForm]}, {16, 
       FormBox["16", TraditionalForm]}, {17, 
       FormBox["17", TraditionalForm]}, {18, 
       FormBox["18", TraditionalForm]}, {19, 
       FormBox["19", TraditionalForm]}, {20, 
       FormBox["20", TraditionalForm]}, {21, 
       FormBox["21", TraditionalForm]}, {22, 
       FormBox["22", TraditionalForm]}, {23, 
       FormBox["23", TraditionalForm]}, {24, 
       FormBox["24", TraditionalForm]}, {25, 
       FormBox["25", TraditionalForm]}, {26, 
       FormBox["26", TraditionalForm]}, {27, 
       FormBox["27", TraditionalForm]}, {28, 
       FormBox["28", TraditionalForm]}, {29, 
       FormBox["29", TraditionalForm]}, {30, 
       FormBox["30", TraditionalForm]}, {31, 
       FormBox["31", TraditionalForm]}, {32, 
       FormBox["32", TraditionalForm]}, {33, 
       FormBox["33", TraditionalForm]}, {34, 
       FormBox["34", TraditionalForm]}, {35, 
       FormBox["35", TraditionalForm]}, {36, 
       FormBox["36", TraditionalForm]}, {37, 
       FormBox["37", TraditionalForm]}, {38, 
       FormBox["38", TraditionalForm]}, {39, 
       FormBox["39", TraditionalForm]}, {40, 
       FormBox["40", TraditionalForm]}, {41, 
       FormBox["41", TraditionalForm]}, {42, 
       FormBox["42", TraditionalForm]}, {43, 
       FormBox["43", TraditionalForm]}, {44, 
       FormBox["44", TraditionalForm]}, {45, 
       FormBox["45", TraditionalForm]}, {46, 
       FormBox["46", TraditionalForm]}, {47, 
       FormBox["47", TraditionalForm]}, {48, 
       FormBox["48", TraditionalForm]}, {49, 
       FormBox["49", TraditionalForm]}, {50, 
       FormBox["50", TraditionalForm]}, {51, 
       FormBox["51", TraditionalForm]}, {52, 
       FormBox["52", TraditionalForm]}, {53, 
       FormBox["53", TraditionalForm]}, {54, 
       FormBox["54", TraditionalForm]}}, None}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.4, 0.5], 
    AbsoluteThickness[1], 
    AbsoluteDashing[{1, 2}]],
  ImageSize->{300, 100},
  Method->{
   "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox[
    "\"Total Cost: 8 generations, 6 individuals\"", Bold, 13, StripOnInput -> 
     False], TraditionalForm],
  PlotRange->{{0., 48.}, {0, 21.86376050030578}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.829840068017898*^9, 3.829896439108531*^9, 
  3.829896511687398*^9, 3.8299167761291323`*^9, 3.82991919623855*^9, 
  3.8306171917952332`*^9},
 CellLabel->
  "Out[337]=",ExpressionUUID->"92141852-aa51-4d6d-98be-30e2b22ba505"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"phase", "=", "1"}], ",", 
   RowBox[{"phase", "\[LessEqual]", " ", "nphase"}], ",", 
   RowBox[{"phase", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"Show", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"errorMtx2", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", "phase", ",", "1"}], "]"}], 
            "]"}], "]"}], "/", "77"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<\[FilledCircle]\>\"", ",", "10"}], "}"}]}], ",", 
         RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<Phase\>\"", ",", 
              RowBox[{"ToString", "[", "phase", "]"}], ",", "\"\< (\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"nGen", "-", "1"}], "]"}], ",", "\"\< gen. , \>\"", 
              ",", 
              RowBox[{"ToString", "[", "genSize", "]"}], ",", 
              "\"\< indiv.)\>\""}], "]"}], ",", "Bold", ",", "13"}], "]"}]}], 
         ",", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"All", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"nGen", "*", "genSize"}], "]"}], ",", "None"}], 
             "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"{", "\"\<1st IntError\>\"", "}"}], ",", "Right"}], 
           "]"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"700", ",", "200"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"2", "/", "10"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"errorMtx2", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", "phase", ",", "2"}], "]"}], 
            "]"}], "]"}], "/", "7.6"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<\[FilledCircle]\>\"", ",", "10"}], "}"}]}], ",", 
         RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"All", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"nGen", "*", "genSize"}], "]"}], ",", "None"}], 
             "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"{", "\"\<2nd IntError\>\"", "}"}], ",", "Right"}], 
           "]"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Orange"}]}], "]"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"errorMtx2", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "All", ",", "phase", ",", "3"}], "]"}], "]"}],
           "]"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<\[FilledCircle]\>\"", ",", "10"}], "}"}]}], ",", 
         RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"All", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"nGen", "*", "genSize"}], "]"}], ",", "None"}], 
             "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"{", "\"\<Phase Error\>\"", "}"}], ",", "Right"}], 
           "]"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.829838760646206*^9, 3.8298391265863037`*^9}, {
  3.8298391584678764`*^9, 3.8298391960950694`*^9}, {3.8298392619767017`*^9, 
  3.82983934112679*^9}, {3.829839371897472*^9, 3.8298396636699433`*^9}, {
  3.829839696089555*^9, 3.8298397655731344`*^9}, {3.8298398044591904`*^9, 
  3.8298398105307465`*^9}, {3.8298398487033463`*^9, 3.829839996253168*^9}, {
  3.8298400525288258`*^9, 3.8298400565517955`*^9}, {3.829840116578006*^9, 
  3.8298403483762913`*^9}, {3.82991933568232*^9, 3.829919395984288*^9}, {
  3.8299194687002544`*^9, 3.829919475903426*^9}, {3.829919513621419*^9, 
  3.829919611682074*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[209]:=",ExpressionUUID->"59fc110c-c743-45ac-a920-c8642c27e866"],

Cell[CellGroupData[{

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1:eJw10FtIk3EYBvA1HKkoLTeaNTe2NucxmTnXPNSenTRLMNZBBLtQiEgMkSwj
NUY3UqMtoVEGXVSQS13lRXMkiUQHRnmRa2isRmmttiBmY9GsrQN7vw/+fPy+
58/3vjzSzh7zETaLxVL+O//f6SeqPay7VGWKJbT0ASOcO86L/ZuQZibM5khf
tG2eci7c4pTSE2NyPry1iRV/joScj/1fFnOrJTJyAUqWvwq6SjlkCeLJ2M/2
MTZ5KxzcpR/nFsRkOdC7cPmzU0hWYLTv9uiwT0QuBkugnrzpZ+aXIkNV1Bn6
FKf9yvFAU+H6mL2e8gr4ruVdn+UUk5WwzV2pcWVtJFci77tj+FSwhLwdFw48
zXFgM7kK3TNvD97YJiCrcGjf+RHp8RjNq4Y2KYqPr3EpV0P1u+3EzLcs8g4E
P5jb+1syyRpM26VCf1cBuQYvJqK8wFo2uRaV3rqh+BJzvw6h1g12USHTbz0e
PxL/CmTzyTsxNRC3NYe2kHdhReZ6+F4mJWvRq2/+o+/JIAN3x6an9iRpPwtw
pkiueBNbR7kO70yri54IzbPoEG0d9C5bmb70EAycPNqRLKRcD593ViMsY/Yx
QKa/n2i6lUz3YzHAtjfoNMqfU19GWOxPQpMW6stiRPdZ38TVBNOfCc8MnlX3
UD7lJqjNvNPWe7mUN6ApzI2l4lH6fwMir9gKaweP8kYcKw+n+K+Z/RsxFw63
1AeYfnZjcL7MLXkpwV+md89A
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         GeometricTransformationBox[
          InsetBox[
           BoxData[
            FormBox[
             StyleBox[
             "\"\[FilledCircle]\"", FontSize -> 10, StripOnInput -> False], 
             TraditionalForm]], {0., 0.}], CompressedData["
1:eJw10FtIk2EYB/C5HOlQWm40a25sbc5jMnOueaj9d9IswVgHEexCISIxRLKM
1BjdSI22hEYZdFFBarrKi+ZIEokOjPIi19BYjdJabUHMxqJZWwk+3wfvxe/9
v3zPw1/W3mU5toHFYqnWTtraYbOYL6o7qr9SYY4ldHSBIc7Y6OXeLVhnBiyW
SE+0ZY5yHtySlMoTY3IBvNWJZX+WlJyLg98WsiulcnIeipa+CzuKOWQp4snY
79YRNnk7nLzFXxfmJWQF0D1/9euoiKzEcM/d4UGfmFwIllAzcdvPzC9Gurqg
PfQlTvuV4pG2zPWZu5HyMvhu5Nyc4RSSVbDPXqtyZW4mlyPnp3PwTLCIvBOX
Dj3PcmIruQKd0+8P39ohJKtx5MDFIdnJGM2rhC4pjt9b5VGugfpvy6npH5nk
XQh+srT2NmWQtZhyyET+jjxyFV6NR/mBVS65GuXemoH4IvO+BqHmTQ5xPtNv
LZ4+kfwJcAXk3Zjsi9sbQ9vIe7Asdz3+KJeRdeg2NP4zdKWTgfsjU5P7krSf
FThXoFC+i6VRrscH88qCJ0LzrHpEm/u9SzamLwOEfaePtyXzKTfA553RikqY
fYyQGx4mGu4k1/uxGmHfHxw1KV5SXyZYHc9CE1bqy2pC53nf+PUE058ZL4ye
FfdALuVmaCz8s7YH2ZTXoSHMi6XiUfp/HSJv2EpbG5/yepwoDacEb5n96zEb
DjfVBph+9qJ/rsQtfS3Ff7P/z0I=
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]]}, {}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]]}, {}}}, {{}, {}}}, {{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAGIQDQEf7JMD3j3tOc3oABVwYL0Zmb9qFheUz+FQ/G3B
ucvWz+whfAGH3tPSz1as5YbKizhkHS/js5wiDOVLOOw82pHuEiQK5cs4cFxf
Lds+A2a+goPHKwe2LamcUL6SQ9j5RXGxUhJQvorDVN60th/dAlC+msNP7Wmi
L/5JQfkaDlK/Pk/h3CsE5Ws5HDDYKPqg7BfUfToOj/U2BHk+g7lPzyFZTzOq
+6U0lG/gELAi9eqTeDYo39Chi3Wm/055dSjfyMHh9fqY50/5oHxjh6LkWd/y
NsD8Y+IQnbHoZul3dijf1CHjzJu7B4JYoXwzB67y5Uv1zL9A3WPucEIu+Pee
kzD3WDgw9a720nkDc4+lw1y3judXWnmgfCuHqcUTovNmwsLH2uFo6iQ11X5e
KN/GoX2SV3/YD1h42zqE8fblNBnJQ/l2DvsvW2cvYlWC8u0dii5fmherCnOf
g4NQiEvfvhho+DU4OOzJCF3C8/8V1L2ODkne3X4bPghC5R0deKeUXbLeAAtv
JweXXUfniderQeWdHMSW125QrWSGyjs7pCbqfpsn+g9iXoOzQ39b1nz+bJj9
Lg6esZW3+w5Cw7/BxeHD7Q57W02Yf1wd9ujkNjz5AI3vBleHphf9Irvb+aHy
bg5fv5XuTb78EWq+m0NVnb9D1w5Y+Lo77FnlnbKkH+Z+dwehrzuMAvJg8e3h
sMEmsHKTqIIDABvyxJQ=
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]], 
         GeometricTransformationBox[
          InsetBox[
           BoxData[
            FormBox[
             StyleBox[
             "\"\[FilledCircle]\"", FontSize -> 10, StripOnInput -> False], 
             TraditionalForm]], {0., 0.}], CompressedData["
1:eJxTTMoPSmVmYGAwAGJGIGZigIEP9skB7572nGZ0gAo4sN6MzF81iwvK53Ao
/rbg3GXrZ/YQvoBD72npZyvWckPlRRyyjpfxWU4RhvIlHHYe7Uh3CRKF8mUc
OK6vlm2fATNfwcHjlQPbllROKF/JIez8orhYKQkoX8VhKm9a249uAShfzeGn
9jTRF/+koHwNB6lfn6dw7hWC8rUcDhhsFH1Q9gvqPh2Hx3obgjyfwdyn55Cs
pxnV/VIayjdwCFiRevVJPBuUb+jQxTrTf6e8OpRv5ODwen3M86d8UL6xQ1Hy
rG95G2D+MXGIzlh0s/Q7O5Rv6pBx5s3dA0GsUL6ZA1f58qV65l+g7jF3OCEX
/HvPSZh7LByYeld76byBucfSYa5bx/MrrTxQvpXD1OIJ0XkzYeFj7XA0dZKa
aj8vlG/j0D7Jqz/sByy8bR3CePtymozkoXw7h/2XrbMXsSpB+fYORZcvzYtV
hbnPwUEoxKVvXww0/BocHPZkhC7h+f8K6l5HhyTvbr8NHwSh8o4OvFPKLllv
gIW3k4PLrqPzxOvVoPJODmLLazeoVjJD5Z0dUhN1v80T/Qcxr8HZob8taz5/
Nsx+FwfP2MrbfQeh4d/g4vDhdoe9rSbMP64Oe3RyG558gMZ3g6tD04t+kd3t
/FB5N4ev30r3Jl/+CDXfzaGqzt+hawcsfN0d9qzyTlnSD3O/u4PQ1x1GAXmw
+PZw2GATWLlJVMEBACl6xJY=
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]]}, {}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]]}, {}}}, {{}, {}}}, {{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAGIQDQEf7D+cibt05P5Pe6iAQ4tJ3B8pGUYHCJfD4dP8
yrjZHV+g8gIOLruKF944zACVF3HojpLKmPaBH8qXcJj/Jvn+BjlBKF/GIYJh
7gmHU1+h+hUc4j6crC/Rh/GVHOYlxPTX6UpB1as4fDjdE+JUBzNfzeGRSVBc
zWEZKF/DIWFrcLbTDDYoX8uBn0/5473dP6Dm6Tj8lzDesyYa5l49hydbZPJ0
vsH0Gzi8rv9gNafiH1Te0CFs5uMninYGUHkjh9BKd5PyDgEo39jhytwyFstd
MPNNHB4v3VAr2/QNyjd1eFVpvPuwE8y9Zg6le6OfiuZ8gMqbO3S5uU7evo0Z
Km/hoL2izGXWJWEo39IhI3t22N+bMPdYObS9kEjZ7vUZyrd2uBfYtifpARNU
vY3DFU+hBZeCYf63dTix1+2TghUHlG/n0ONn++YNgzKUb+8QdS5m946psPB2
cBCsFzmntg1qf4ODw3I90dX3NGHud3SoUm7buuIPC1Te0WGb3LINbNow/zo5
1N+s3bV3vjpU3smh6n3elG/XYe53drBj+/WowQyanhqcHUK95EU9fGDh5+LQ
6XT8XM09qH0NLg5rDNTKX96Xg9rv6rD6ccKO+0b6UHlXhzdtb8Vl2b5D9bs5
bG+v43pwHxo+DW4Oehe2Cj59DEt/7g7bJ65jCEmAhneDu4ORprGrnSzUPwwe
DuJGZxxubDNyAABM+dBK
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]], 
         GeometricTransformationBox[
          InsetBox[
           BoxData[
            FormBox[
             StyleBox[
             "\"\[FilledCircle]\"", FontSize -> 10, StripOnInput -> False], 
             TraditionalForm]], {0., 0.}], CompressedData["
1:eJxTTMoPSmVmYGAwAGJGIGZigIEP9h/OxF06cv+nPVTAocUk7o+UDKMDhMvh
8Gl+Zdzsji9QeQEHl13FC28cZoDKizh0R0llTPvAD+VLOMx/k3x/g5wglC/j
EMEw94TDqa9Q/QoOcR9O1pfow/hKDvMSYvrrdKWg6lUcPpzuCXGqg5mv5vDI
JCiu5rAMlK/hkLA1ONtpBhuUr+XAz6f88d7uH1DzdBz+SxjvWRMNc6+ew5Mt
Mnk632D6DRxe13+wmlPxDypv6BA28/ETRTsDqLyRQ2ilu0l5hwCUb+xwZW4Z
i+UumPkmDo+XbqiVbfoG5Zs6vKo03n3YCeZeM4fSvdFPRXM+QOXNHbrcXCdv
38YMlbdw0F5R5jLrkjCUb+mQkT077O9NmHusHNpeSKRs9/oM5Vs73Ats25P0
gAmq3sbhiqfQgkvBMP/bOpzY6/ZJwYoDyrdz6PGzffOGQRnKt3eIOheze8dU
WHg7OAjWi5xT2wa1v8HBYbme6Op7mjD3OzpUKbdtXfGHBSrv6LBNbtkGNm2Y
f50c6m/W7to7Xx0q7+RQ9T5vyrfrMPc7O9ix/XrUYAZNTw3ODqFe8qIePrDw
c3HodDp+ruYe1L4GF4c1BmrlL+/LQe13dVj9OGHHfSN9qLyrw5u2t+KybN+h
+t0ctrfXcT24Dw2fBjcHvQtbBZ8+hqU/d4ftE9cxhCRAw7vB3cFI09jVThbq
HwYPB3GjMw43thk5AABagdBM
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]]}, {}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]]}, {}}}, {{}, {}}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[
       Rational[1, 5], 0.2], Axes -> {False, False}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0., 0}, DisplayFunction :> 
     Identity, Frame -> {{True, True}, {True, True}}, 
     FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> Automatic, 
     FrameTicks -> {{All, None}, {{{1, 
          FormBox["1", TraditionalForm]}, {2, 
          FormBox["2", TraditionalForm]}, {3, 
          FormBox["3", TraditionalForm]}, {4, 
          FormBox["4", TraditionalForm]}, {5, 
          FormBox["5", TraditionalForm]}, {6, 
          FormBox["6", TraditionalForm]}, {7, 
          FormBox["7", TraditionalForm]}, {8, 
          FormBox["8", TraditionalForm]}, {9, 
          FormBox["9", TraditionalForm]}, {10, 
          FormBox["10", TraditionalForm]}, {11, 
          FormBox["11", TraditionalForm]}, {12, 
          FormBox["12", TraditionalForm]}, {13, 
          FormBox["13", TraditionalForm]}, {14, 
          FormBox["14", TraditionalForm]}, {15, 
          FormBox["15", TraditionalForm]}, {16, 
          FormBox["16", TraditionalForm]}, {17, 
          FormBox["17", TraditionalForm]}, {18, 
          FormBox["18", TraditionalForm]}, {19, 
          FormBox["19", TraditionalForm]}, {20, 
          FormBox["20", TraditionalForm]}, {21, 
          FormBox["21", TraditionalForm]}, {22, 
          FormBox["22", TraditionalForm]}, {23, 
          FormBox["23", TraditionalForm]}, {24, 
          FormBox["24", TraditionalForm]}, {25, 
          FormBox["25", TraditionalForm]}, {26, 
          FormBox["26", TraditionalForm]}, {27, 
          FormBox["27", TraditionalForm]}, {28, 
          FormBox["28", TraditionalForm]}, {29, 
          FormBox["29", TraditionalForm]}, {30, 
          FormBox["30", TraditionalForm]}, {31, 
          FormBox["31", TraditionalForm]}, {32, 
          FormBox["32", TraditionalForm]}, {33, 
          FormBox["33", TraditionalForm]}, {34, 
          FormBox["34", TraditionalForm]}, {35, 
          FormBox["35", TraditionalForm]}, {36, 
          FormBox["36", TraditionalForm]}, {37, 
          FormBox["37", TraditionalForm]}, {38, 
          FormBox["38", TraditionalForm]}, {39, 
          FormBox["39", TraditionalForm]}, {40, 
          FormBox["40", TraditionalForm]}, {41, 
          FormBox["41", TraditionalForm]}, {42, 
          FormBox["42", TraditionalForm]}, {43, 
          FormBox["43", TraditionalForm]}, {44, 
          FormBox["44", TraditionalForm]}, {45, 
          FormBox["45", TraditionalForm]}, {46, 
          FormBox["46", TraditionalForm]}, {47, 
          FormBox["47", TraditionalForm]}, {48, 
          FormBox["48", TraditionalForm]}, {49, 
          FormBox["49", TraditionalForm]}, {50, 
          FormBox["50", TraditionalForm]}, {51, 
          FormBox["51", TraditionalForm]}, {52, 
          FormBox["52", TraditionalForm]}, {53, 
          FormBox["53", TraditionalForm]}, {54, 
          FormBox["54", TraditionalForm]}}, None}}, 
     GridLines -> {Automatic, Automatic}, GridLinesStyle -> Directive[
       GrayLevel[0.4, 0.5], 
       AbsoluteThickness[1], 
       AbsoluteDashing[{1, 2}]], ImageSize -> {700, 200}, 
     Method -> {
      "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, PlotLabel -> FormBox[
       StyleBox[
       "\"Phase1 (8 gen. , 6 indiv.)\"", Bold, 13, StripOnInput -> False], 
       TraditionalForm], PlotRange -> {{0., 48.}, {0, 12.934498059324174`}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    TagBox[
     GridBox[{{
        FormBox[
         TemplateBox[{"\"1st IntError\""}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
                 "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\[FilledCircle]\"", ",", "10"}], "}"}], 
                   "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "True", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}, {
        FormBox[
         TemplateBox[{"\"2nd IntError\""}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0.5, 0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0.5, 0]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0.5, 0]], FontSize -> 10, Plain, StripOnInput -> 
                    False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0.5, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[0.6666666666666666, 0.33333333333333337`, 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0.5`", ",", "0"}], "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0.5, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[1, 0.5, 0], Editable -> False, Selectable -> 
                    False]}], "]"}], "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\[FilledCircle]\"", ",", "10"}], "}"}], 
                   "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "True", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}, {
        FormBox[
         TemplateBox[{"\"Phase Error\""}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 1, 0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 1, 0]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 1, 0]], FontSize -> 10, Plain, StripOnInput -> 
                    False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0, 1, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> RGBColor[0., 0.6666666666666666, 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0, 1, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0, 1, 0], Editable -> False, Selectable -> 
                    False]}], "]"}], "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\[FilledCircle]\"", ",", "10"}], "}"}], 
                   "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "True", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}}, 
      GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> False, 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
      GridBoxSpacings -> {"Columns" -> {{0}}}], "Grid"], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Print",
 CellChangeTimes->{{3.8298402186100535`*^9, 3.8298403060213437`*^9}, {
   3.8298403405185413`*^9, 3.8298403497517333`*^9}, 3.8298965173761387`*^9, {
   3.8299193413854666`*^9, 3.8299193965780153`*^9}, {3.829919471231518*^9, 
   3.8299194766534195`*^9}, {3.829919522449587*^9, 3.8299195269964857`*^9}, {
   3.8299195626818724`*^9, 3.829919612463291*^9}},
 CellLabel->
  "During evaluation of \
In[209]:=",ExpressionUUID->"9e78b900-ba8f-4c91-9077-9601c02c1a99"],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAGIQDQEf7P8EeSnol/+0hwo4rGVUffJPQcwBwuVwUNmz
btXU5hNQeQGHEPm0mxM9YPIiDlsfVgucylWA8iUcnH6+P5BvrAzlyzgsXvRG
JquFBcpXcGBZ7/IoyJwJyldy2FPPO/lbiTyUr+Lw2PbqnZmvpKF8NYcA+5t3
592UhfI1HJKD6xcVTYPZr+Wgxubk6PjzC9R9Og7LvR8Ya4SwQeX1HLY+j6qT
4tWA8g0ckjw4nxdqC0L5hg6+7E8rkoS1oHwjh5YNkb2fvSWhfGMH2aKfy573
wuwzcSh8rjFD5tlHqH2mDn7z+du1ggWg8mYOBZcbqldN44TyzR1e35Q5NZmL
Hcq3cLD8bfzhjYoMlG/psLfW9sWTKVxQvpXD2qvHi4USOaB8a4co9j+7s67D
wsfGIU9du/X1amEo39Zh9v2lmyudpKB8O4dHzyy0ePgUoXx7B2HPX3MWdDBD
+Q4OZpNuNHpOgLqvwcHhIOvWb/VKsPhwdLg7PclFpxwanw2ODq9VTPa5+MDC
y8nhYeZMwYOnVaHyTg6Wldt8Lh6GucfZgX3bg22L/v6GhE+Ds0PFKuZVEtcP
QMPLxUHO3HL+fX9oeDW4OMy4/yb99ANY+Lk69Ozf4TWTDeqfBleHGIdLfHon
eKDybg4t3+d1KV+Hhn+Dm0On5fY9vMoiUHl3h+zT2W1f7sDc7+7QfW+KXXYu
LHw8HDT2mS1NX6LgAACeMMRp
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         GeometricTransformationBox[
          InsetBox[
           BoxData[
            FormBox[
             StyleBox[
             "\"\[FilledCircle]\"", FontSize -> 10, StripOnInput -> False], 
             TraditionalForm]], {0., 0.}], CompressedData["
1:eJxTTMoPSmVmYGAwAGJGIGZigIEP9n+CvBT0y3/aQwUc1jKqPvmnIOYA4XI4
qOxZt2pq8wmovIBDiHzazYkeMHkRh60PqwVO5SpA+RIOTj/fH8g3VobyZRwW
L3ojk9XCAuUrOLCsd3kUZM4E5Ss57KnnnfytRB7KV3F4bHv1zsxX0lC+mkOA
/c27827KQvkaDsnB9YuKpsHs13JQY3NydPz5Beo+HYfl3g+MNULYoPJ6Dluf
R9VJ8WpA+QYOSR6czwu1BaF8Qwdf9qcVScJaUL6RQ8uGyN7P3pJQvrGDbNHP
Zc97YfaZOBQ+15gh8+wj1D5TB7/5/O1awQJQeTOHgssN1aumcUL55g6vb8qc
mszFDuVbOFj+Nv7wRkUGyrd02Ftr++LJFC4o38ph7dXjxUKJHFC+tUMU+5/d
Wddh4WPjkKeu3fp6tTCUb+sw+/7SzZVOUlC+ncOjZxZaPHyKUL69g7DnrzkL
OpihfAcHs0k3Gj0nQN3X4OBwkHXrt3olWHw4OtydnuSiUw6NzwZHh9cqJvtc
fGDh5eTwMHOm4MHTqlB5JwfLym0+Fw/D3OPswL7twbZFf39DwqfB2aFiFfMq
iesHoOHl4iBnbjn/vj80vBpcHGbcf5N++gEs/Fwdevbv8JrJBvVPg6tDjMMl
Pr0TPFB5N4eW7/O6lK9Dw7/BzaHTcvseXmURqLy7Q/bp7LYvd2Dud3fovjfF
LjsXFj4eDhr7zJamL1FwAACruMRr
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]]}, {}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]]}, {}}}, {{}, {}}}, {{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAGIQDQEf7GV5L8w1WcXkABVwKHqhuJnxIDeUz+FwgP1g
ZcDW5/YQvoDD9x07rWLZYPIiDoeO7uCbHy0C5Us4ZLA+XCWoIQrlyzhs4Di6
KbcIZr6Cw+zFz28mf+WE8pUcPq/M2nn6oQSUr+Kg85xZuqlJAMpXc/gqJ8nS
5SoN5Ws4mAm0pP6dIgTlazksKtk5fbfFb6j7dBzMc683aZfwQOX1HI7ueWS1
SVAGyjdwaDl1smpCABuUb+jAMU+Ss65XHco3cnB2i1h8V5ofyjd2cFJiv59x
B+YfEweHUzMrbhVwQPmmDlve/+XRnccC5Zs5/Iy+9zd99jeoe8wdku2mqlT1
wsLLwsE4qjZUzAfmHkuHtuVJT3WbeKF8KweBZHPtVBEuKN/awZ0rOTslGyZv
4yDzluXFAxlYeNs6JKTmfoxwkofy7RweuH3cFeSvBOXbO/SZJP28kMEK5Ts4
CAomXWM4Dw2/BgeHyREz3s0+9wLqXkcHsb0lE7RiBKHyjg7F07efv/cWFt5O
Dj8s3k1t2KMGlXdycN81t1XrFxNU3tlhxzF3mUMX/kHMa3B22KJWzTmZARbe
Lg5bVu+Z5SYNDb8GF4cj2bK7XlrCzHd1uKvH9miLCDR8GlwdQu6kaTgJwtKD
m8PX494Cc2Q/Qc13c2hTnff0mT4sfNwdZvHpt7Avgbnf3cHC1nDHFkeY/R4O
2XPPHHvpruAAACxavKU=
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]], 
         GeometricTransformationBox[
          InsetBox[
           BoxData[
            FormBox[
             StyleBox[
             "\"\[FilledCircle]\"", FontSize -> 10, StripOnInput -> False], 
             TraditionalForm]], {0., 0.}], CompressedData["
1:eJxTTMoPSmVmYGAwAGJGIGZigIEP9rK8F+aarGJygAo4FL1Q3Mx4kBvK53A4
wH6wMmDrc3sIX8Dh+46dVrFsMHkRh0NHd/DNjxaB8iUcMlgfrhLUEIXyZRw2
cBzdlFsEM1/BYfbi5zeTv3JC+UoOn1dm7Tz9UALKV3HQec4s3dQkAOWrOXyV
k2TpcpWG8jUczARaUv9OEYLytRwWleycvtviN9R9Og7mudebtEt4oPJ6Dkf3
PLLaJCgD5Rs4tJw6WTUhgA3KN3TgmCfJWderDuUbOTi7RSy+K80P5Rs7OCmx
38+4A/OPiYPDqZkVtwo4oHxThy3v//LozmOB8s0cfkbf+5s++xvUPeYOyXZT
Vap6YeFl4WAcVRsq5gNzj6VD2/Kkp7pNvFC+lYNAsrl2qggXlG/t4M6VnJ2S
DZO3cZB5y/LigQwsvG0dElJzP0Y4yUP5dg4P3D7uCvJXgvLtHfpMkn5eyGCF
8h0cBAWTrjGch4Zfg4PD5IgZ72afewF1r6OD2N6SCVoxglB5R4fi6dvP33sL
C28nhx8W76Y27FGDyjs5uO+a26r1iwkq7+yw45i7zKEL/yDmNTg7bFGr5pzM
AAtvF4ctq/fMcpOGhl+Di8ORbNldLy1h5rs63NVje7RFBBo+Da4OIXfSNJwE
YenBzeHrcW+BObKfoOa7ObSpznv6TB8WPu4Os/j0W9iXwNzv7mBha7hjiyPM
fg+H7Llnjr10V3AAADnivKc=
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]]}, {}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]]}, {}}}, {{}, {}}}, {{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]], 
         LineBox[{{1., 7.738370244898432}, {2., 8.508277093620125}, {3., 
          6.409368141969228}, {4., 7.4005166939360185`}, {5., 
          7.762706280273663}, {6., 12.069332842707272`}, {7., 
          6.886753427327197}, {8., 8.757855216308903}, {9., 
          11.966483840092724`}, {10., 8.309920229382206}, {11., 
          20.356750901393255`}, {12., 9.956582035146035}, {13., 
          7.736314764627837}, {14., 8.431592900453042}, {15., 
          19.150072507498933`}, {16., 6.772380481362137}, {16.98096142329861, 
          30.277225741716126`}}], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQ7T3n1zZ9VkOHre5qLj/c7BwYwMDIIWOqp+W6PAUo
39ih33hSf3+aKpRv4nCHi2Vi1X9FKN/UQbs+5OUzKyko38yBM03srKGAGJRv
7mA751rc9AqYeguHwAZtPqYYAyjf0qHkkYvXJlZlKN/KwXTPee7gMjko39rh
e7uA8Pt78lC+jYOpaTZD8UeYebYO6iW+cSeW6kP5dg62v29cS3OyhPLtHQ5a
JGwoOwszz8Gh8Okba/VkPQi/wcFh0VIdlTOFIlB5R4dnEvY3fU9BzW9wdPAy
/6O29ivQfRJPDCt/OcLDCwCNiVEl
          "]], 
         LineBox[{{36.036238607260124`, 30.277225741716126`}, {37., 
          5.918586583040395}, {38., 7.585090338424466}, {39., 
          9.356248403668125}, {40., 7.420329615205464}, {41., 
          17.035253392719493`}, {42., 26.679216778677564`}, {43., 
          10.054149549963105`}, {44., 6.435461149935953}, {45., 
          7.080860109141871}, {46., 8.174348785701971}, {47., 
          7.813359224795889}, {47.70607356003016, 30.277225741716126`}}]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]], 
         GeometricTransformationBox[
          InsetBox[
           BoxData[
            FormBox[
             StyleBox[
             "\"\[FilledCircle]\"", FontSize -> 10, StripOnInput -> False], 
             TraditionalForm]], {0., 0.}], CompressedData["
1:eJxTTMoPSmVmYGAwAGJGIGZigIEP9n3bIkLEv8g5QAUcOM/rPLVhUYTyORye
KHxPM1wsCeULOJhfCedRnCUL5Ys4bHzF8YCJVx7Kl3C49E59Rr2yBpQv4/D0
o7o4Z480lK/gsNonaCZrC8x8JQep+V4/rr1Th/JVHKoVne+unacA5as5lPi+
YwuJNoHyNRxSTt6UO/pSGcrXcrjUm1b/5yPM/ToOic4L9/28A9Ov5zBlz321
bDVjKN/AYbLwuhevxGDuMXRgn3Zl94HddlC+kUPGVE/LdXkw/cYO/caT+vvT
VKF8E4c7XCwTq/7D3G/qoF0f8vKZlRSUb+bAmSZ21lBADMo3d7Cdcy1uegVM
vYVDYIM2H1OMAZRv6VDyyMVrEyvMP1YOpnvOcweXwfxj7fC9XUD4/T1Y+No4
mJpmMxR/hJln66Be4ht3Yqk+lG/nYPv7xrU0J0so397hoEXChrKzMPMcHAqf
vrFWT9aD8BscHBYt1VE5UygClXd0eCZhf9P3FNT8BkcHL/M/amu/wtzn5FDM
vnVpoaE9VN7J4eB5oW8L14hD5Z0dkr58eq0YDrWvwdmhhvmaQdo2Jai8i4NI
yu9HWeug6afBxWHx2ROxbJyGUHlXh66A2WoP11pB5V0duuNSandKq0Dl3RzU
54q1v9wLTY8Nbg5PnQT/nQmSgcq7OzyOr7RziYTGX4O7w4XpM20fOsDCz8Mh
7HNWaskFZwcAXQa9og==
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]]}, {}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]]}, {}}}, {{}, {}}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[
       Rational[1, 5], 0.2], Axes -> {False, False}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0., 0}, DisplayFunction :> 
     Identity, Frame -> {{True, True}, {True, True}}, 
     FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> Automatic, 
     FrameTicks -> {{All, None}, {{{1, 
          FormBox["1", TraditionalForm]}, {2, 
          FormBox["2", TraditionalForm]}, {3, 
          FormBox["3", TraditionalForm]}, {4, 
          FormBox["4", TraditionalForm]}, {5, 
          FormBox["5", TraditionalForm]}, {6, 
          FormBox["6", TraditionalForm]}, {7, 
          FormBox["7", TraditionalForm]}, {8, 
          FormBox["8", TraditionalForm]}, {9, 
          FormBox["9", TraditionalForm]}, {10, 
          FormBox["10", TraditionalForm]}, {11, 
          FormBox["11", TraditionalForm]}, {12, 
          FormBox["12", TraditionalForm]}, {13, 
          FormBox["13", TraditionalForm]}, {14, 
          FormBox["14", TraditionalForm]}, {15, 
          FormBox["15", TraditionalForm]}, {16, 
          FormBox["16", TraditionalForm]}, {17, 
          FormBox["17", TraditionalForm]}, {18, 
          FormBox["18", TraditionalForm]}, {19, 
          FormBox["19", TraditionalForm]}, {20, 
          FormBox["20", TraditionalForm]}, {21, 
          FormBox["21", TraditionalForm]}, {22, 
          FormBox["22", TraditionalForm]}, {23, 
          FormBox["23", TraditionalForm]}, {24, 
          FormBox["24", TraditionalForm]}, {25, 
          FormBox["25", TraditionalForm]}, {26, 
          FormBox["26", TraditionalForm]}, {27, 
          FormBox["27", TraditionalForm]}, {28, 
          FormBox["28", TraditionalForm]}, {29, 
          FormBox["29", TraditionalForm]}, {30, 
          FormBox["30", TraditionalForm]}, {31, 
          FormBox["31", TraditionalForm]}, {32, 
          FormBox["32", TraditionalForm]}, {33, 
          FormBox["33", TraditionalForm]}, {34, 
          FormBox["34", TraditionalForm]}, {35, 
          FormBox["35", TraditionalForm]}, {36, 
          FormBox["36", TraditionalForm]}, {37, 
          FormBox["37", TraditionalForm]}, {38, 
          FormBox["38", TraditionalForm]}, {39, 
          FormBox["39", TraditionalForm]}, {40, 
          FormBox["40", TraditionalForm]}, {41, 
          FormBox["41", TraditionalForm]}, {42, 
          FormBox["42", TraditionalForm]}, {43, 
          FormBox["43", TraditionalForm]}, {44, 
          FormBox["44", TraditionalForm]}, {45, 
          FormBox["45", TraditionalForm]}, {46, 
          FormBox["46", TraditionalForm]}, {47, 
          FormBox["47", TraditionalForm]}, {48, 
          FormBox["48", TraditionalForm]}, {49, 
          FormBox["49", TraditionalForm]}, {50, 
          FormBox["50", TraditionalForm]}, {51, 
          FormBox["51", TraditionalForm]}, {52, 
          FormBox["52", TraditionalForm]}, {53, 
          FormBox["53", TraditionalForm]}, {54, 
          FormBox["54", TraditionalForm]}}, None}}, 
     GridLines -> {Automatic, Automatic}, GridLinesStyle -> Directive[
       GrayLevel[0.4, 0.5], 
       AbsoluteThickness[1], 
       AbsoluteDashing[{1, 2}]], ImageSize -> {700, 200}, 
     Method -> {
      "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, PlotLabel -> FormBox[
       StyleBox[
       "\"Phase2 (8 gen. , 6 indiv.)\"", Bold, 13, StripOnInput -> False], 
       TraditionalForm], PlotRange -> {{0., 48.}, {0, 13.037860658605178`}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    TagBox[
     GridBox[{{
        FormBox[
         TemplateBox[{"\"1st IntError\""}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
                 "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\[FilledCircle]\"", ",", "10"}], "}"}], 
                   "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "True", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}, {
        FormBox[
         TemplateBox[{"\"2nd IntError\""}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0.5, 0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0.5, 0]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0.5, 0]], FontSize -> 10, Plain, StripOnInput -> 
                    False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0.5, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[0.6666666666666666, 0.33333333333333337`, 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0.5`", ",", "0"}], "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0.5, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[1, 0.5, 0], Editable -> False, Selectable -> 
                    False]}], "]"}], "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\[FilledCircle]\"", ",", "10"}], "}"}], 
                   "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "True", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}, {
        FormBox[
         TemplateBox[{"\"Phase Error\""}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 1, 0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 1, 0]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 1, 0]], FontSize -> 10, Plain, StripOnInput -> 
                    False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0, 1, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> RGBColor[0., 0.6666666666666666, 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0, 1, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0, 1, 0], Editable -> False, Selectable -> 
                    False]}], "]"}], "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\[FilledCircle]\"", ",", "10"}], "}"}], 
                   "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "True", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}}, 
      GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> False, 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
      GridBoxSpacings -> {"Columns" -> {{0}}}], "Grid"], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Print",
 CellChangeTimes->{{3.8298402186100535`*^9, 3.8298403060213437`*^9}, {
   3.8298403405185413`*^9, 3.8298403497517333`*^9}, 3.8298965173761387`*^9, {
   3.8299193413854666`*^9, 3.8299193965780153`*^9}, {3.829919471231518*^9, 
   3.8299194766534195`*^9}, {3.829919522449587*^9, 3.8299195269964857`*^9}, {
   3.8299195626818724`*^9, 3.8299196126664433`*^9}},
 CellLabel->
  "During evaluation of \
In[209]:=",ExpressionUUID->"8eb51cc0-aea8-4f13-a7eb-eb9ce46cbe78"],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAGIQDQEf7JVcHihrvPxtDxVw2DDD4njtSlEHCJfD4aTo
XfXD3g+h8gIOTfdFb/gVikPlRRz0l+R/PsisAOVLOCQ919ktWq0M5cs4qJ+b
XzNvFiuUr+CgUFkz77cCI5Sv5ODAlnTwiKw8lK/iECMpF21uJwPlqzncM1ug
/4sVJq/hEPtAKmpZLsx9Wg4vrEqdbE9/hbpPx+Gn5dS3M9TZoPJ6DhufTmW/
8lYdyjdwuLC8aI2PvACUb+jw6Xn/1qt7NaF8I4drZ1dbHmuVgvKNHVJkbPec
ZxOD8k0c/ibIx6R9fw21z9Qh9o/7IaMlglB5M4e/QYkb7SZwQPnmDusfbd6g
o8gF5Vs4fE/6yPXhJ8x8SwfpzxIR2eEweSuH9Yt6FPo1YOFl7XD6EnvMvz0w
/9s4rLlw3Wr/ZJj/bR3WPXn16LmrJJRv5zCRcY7JeiZFKN/e4fQpnVkJHLDw
dnBQME7oMVflhPAbHByyXrTELuSHyTs67Hs2UbnxHDQ+Gxwdtv+yD6vcxQ+V
d3J48OzqlE8TVKHyTg4/G9lv/FQSgco7O8w7vbZAQO0nJHwanB02crn9msJ/
FxpeLg4es6cZ7z7HB9Xv4lBkmPpk7V+Y+a4OJx5pmLZ1Qv3T4OrgKjUlpmUr
D1TezaFCcqGxVPI3qPluDvmvYjt4DwpD5d0dZrWe+XZ3Hcz97g52OsXLhPfD
wtvDIWj2jWrvTAUHACpKxoA=
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         GeometricTransformationBox[
          InsetBox[
           BoxData[
            FormBox[
             StyleBox[
             "\"\[FilledCircle]\"", FontSize -> 10, StripOnInput -> False], 
             TraditionalForm]], {0., 0.}], CompressedData["
1:eJxTTMoPSmVmYGAwAGJGIGZigIEP9kouD5Q1Xv62hwo4bJhhcbx2pagDhMvh
cFL0rvph74dQeQGHpvuiN/wKxaHyIg76S/I/H2RWgPIlHJKe6+wWrVaG8mUc
1M/Nr5k3ixXKV3BQqKyZ91uBEcpXcnBgSzp4RFYeyldxiJGUiza3k4Hy1Rzu
mS3Q/8UKk9dwiH0gFbUsF+Y+LYcXVqVOtqe/Qt2n4/DTcurbGepsUHk9h41P
p7JfeasO5Rs4XFhetMZHXgDKN3T49Lx/69W9mlC+kcO1s6stj7VKQfnGDiky
tnvOs4lB+SYOfxPkY9K+v4baZ+oQ+8f9kNESQai8mcPfoMSNdhM4oHxzh/WP
Nm/QUeSC8i0cvid95PrwE2a+pYP0Z4mI7HCYvJXD+kU9Cv0asPCydjh9iT3m
3x6Y/20c1ly4brV/Msz/tg7rnrx69NxVEsq3c5jIOMdkPZMilG/vcPqUzqwE
Dlh4OzgoGCf0mKtyQvgNDg5ZL1piF/LD5B0d9j2bqNx4DhqfDY4O23/Zh1Xu
4ofKOzk8eHZ1yqcJqlB5J4efjew3fiqJQOWdHeadXlsgoPYTEj4Nzg4budx+
TeG/Cw0vFweP2dOMd5/jg+p3cSgyTH2y9i/MfFeHE480TNs6of5pcHVwlZoS
07KVByrv5lAhudBYKvkb1Hw3h/xXsR28B4Wh8u4Os1rPfLu7DuZ+dwc7neJl
wvth4e3hEDT7RrV3poIDADfSxoI=
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]]}, {}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]]}, {}}}, {{}, {}}}, {{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAGIQDQEf7KcW/3r8TP6/PVTAYecM0ZqULxwOEC6HQ2L6
pDLGNXeg8gIOSf4N7WbH+KHyIg4SivLnPr4WgvIlHEo5vfSqfcWhfBkHuzs3
pA1c/kH1KzjcyvCoP7uTFSqv5PA1wPzvIzYJKF/F4VLE8pZVe2HmqTkw9sUJ
CLjKQPkaDjyi21c7tgpC+VoOD+ZlvfJ2/gw1X8ehxLn82u46mPv1HJTlblr/
+CQL5Rs4VGhq/5rHyAblGzqs4y3IUvqsBuUbOaycq2KvOUsAyjd2yF5k+T/p
jDCUb+KgYOL4+7ECC5Rv6nDbeeNa37mcUL6ZQ9F5zRNKep+g7jF38E1Ysb/w
Lyy8LBzuiEe8fWkgBeVbOiy9sOmm5nwuKN/Kod1gzvfiJTD3WTsI8kke3OQK
c4+NwzEnnugZL0ShfFuHn6mCHr7RMP/ZOfA0G3m9XaUI5ds7LG6ql11oywTl
Ozh4KDhsn5sADb8GB4fJqzqc2NW/Qd3r6FBgZel+cj/Uvw2ODl4fjjMEn4PZ
7+SQ6DnjzdpLqlB5J4c67fJDfrfYofLODg2ZfXk8T75DzGtwdlA46JryMJAZ
Ku/icHXjom2JPtDwa3Bx+CPJeKshGGa+q8PED65662Oh4dPg6uDktJ7/VhYP
VN7NQZft+uNe2x9Q890c2loNU9pncUPl3R3uz3+6Oe0QNP00uDs8jTe//f8R
LH48HKSULmWEH5NzAAAdd78y
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]], 
         GeometricTransformationBox[
          InsetBox[
           BoxData[
            FormBox[
             StyleBox[
             "\"\[FilledCircle]\"", FontSize -> 10, StripOnInput -> False], 
             TraditionalForm]], {0., 0.}], CompressedData["
1:eJxTTMoPSmVmYGAwAGJGIGZigIEP9lOLfz1+Jv/fHirgsHOGaE3KFw4HCJfD
ITF9UhnjmjtQeQGHJP+GdrNj/FB5EQcJRflzH18LQfkSDqWcXnrVvuJQvoyD
3Z0b0gYu/6D6FRxuZXjUn93JCpVXcvgaYP73EZsElK/icCliecuqvTDz1BwY
++IEBFxloHwNBx7R7asdWwWhfC2HB/OyXnk7f4aar+NQ4lx+bXcdzP16Dspy
N61/fJKF8g0cKjS1f81jZIPyDR3W8RZkKX1Wg/KNHFbOVbHXnCUA5Rs7ZC+y
/J90RhjKN3FQMHH8/ViBBco3dbjtvHGt71xOKN/Moei85gklvU9Q95g7+Cas
2F/4FxZeFg53xCPevjSQgvItHZZe2HRTcz4XlG/l0G4w53vxEpj7rB0E+SQP
bnKFucfG4ZgTT/SMF6JQvq3Dz1RBD99omP/sHHiajbzerlKE8u0dFjfVyy60
ZYLyHRw8FBy2z02Ahl+Dg8PkVR1O7OrfoO51dCiwsnQ/uR/q3wZHB68PxxmC
z8Hsd3JI9JzxZu0lVai8k0Oddvkhv1vsUHlnh4bMvjyeJ98h5jU4OygcdE15
GMgMlXdxuLpx0bZEH2j4Nbg4/JFkvNUQDDPf1WHiB1e99bHQ8GlwdXByWs9/
K4sHKu/moMt2/XGv7Q+o+W4Oba2GKe2zuKHy7g735z/dnHYImn4a3B2expvf
/v8IFj8eDlJKlzLCj8k5AAAq/780
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]]}, {}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0.5, 0]]}, {}}}, {{}, {}}}, {{}, {{{}, {}, {
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]], 
         LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAGIQDQEf7G+LMpgL/PlkDxVwmH92wT/9qwwOEC6HwzPj
Iz2Lz36Dygs4/Hhub8eiyAqVF3FQZRWP8p/GD+VLOCRucPpt0CcI5cs4LI8v
vSr79SNUv4LDVsuLrZLxX6F8JYfuDy/edK+VhKpXcWjh3CE70YYFyldzKD6Y
EXfQWQHK13DQkL/cNvs1zH1aDpJFlVtELvyAmqfj8HK1hsDDIJj5eg6GXy/O
58mTh6o3cJiVtOEbQxNM3tAhyPyYIv8Cfai8kcOjihWNiRdFoHxjB/+aTN0z
tZ+h6k0c2JaqnC8S/ALlmzq8VfSWkDjFCFVv5vCx+0fn1Om/oPLmDsVXXK/o
rmCGyls4JPzYvH3lLh4o39Jhtt7Omxu8Ye63cnAWvJNn4wIz39ph56vGb8m8
TFD1Ng7fGlYYnXHihvJtHZiP3jDYewdmv53DfbYOvynVilC+vcPWOcV5Yvdg
8evgsK7qOvNtL2GIfIODgw6TN0d56X+ovKNDt5/+03RNdqi8owNPkdvzaMs/
UHknh0siGufms6lB5Z0ceJ41MTeywfQ7OwSl59xcEAdV3+DsYCOxLeMjN8x/
Lg5CaxtFZRh/QuVdHHylDq6T+ycNda+rgyL7+d/ij3Wh5rs6hLh15LvlwOx3
cwg2ELeomwP1T4ObQ4x+emxMMy9Uv7vD5HlWegl3oOmjwd3h56xL8s0XYenJ
w2GNednc6bxGDgAcmcaf
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]], 
         GeometricTransformationBox[
          InsetBox[
           BoxData[
            FormBox[
             StyleBox[
             "\"\[FilledCircle]\"", FontSize -> 10, StripOnInput -> False], 
             TraditionalForm]], {0., 0.}], CompressedData["
1:eJxTTMoPSmVmYGAwAGJGIGZigIEP9rdFGcwF/nyyhwo4zD+74J/+VQYHCJfD
4ZnxkZ7FZ79B5QUcfjy3t2NRZIXKiziosopH+U/jh/IlHBI3OP026BOE8mUc
lseXXpX9+hGqX8Fhq+XFVsn4r1C+kkP3hxdvutdKQtWrOLRw7pCdaMMC5as5
FB/MiDvorADlazhoyF9um/0a5j4tB8miyi0iF35AzdNxeLlaQ+BhEMx8PQfD
rxfn8+TJQ9UbOMxK2vCNoQkmb+gQZH5MkX+BPlTeyOFRxYrGxIsiUL6xg39N
pu6Z2s9Q9SYObEtVzhcJfoHyTR3eKnpLSJxihKo3c/jY/aNz6vRfUHlzh+Ir
rld0VzBD5S0cEn5s3r5yFw+Ub+kwW2/nzQ3eMPdbOTgL3smzcYGZb+2w81Xj
t2ReJqh6G4dvDSuMzjhxQ/m2DsxHbxjsvQOz387hPluH35RqRSjf3mHrnOI8
sXuw+HVwWFd1nfm2lzBEvsHBQYfJm6O89D9U3tGh20//abomO1Te0YGnyO15
tOUfqLyTwyURjXPz2dSg8k4OPM+amBvZYPqdHYLSc24uiIOqb3B2sJHYlvGR
G+Y/FwehtY2iMow/ofIuDr5SB9fJ/ZOGutfVQZH9/G/xx7pQ810dQtw68t1y
YPa7OQQbiFvUzYH6p8HNIUY/PTammReq391h8jwrvYQ70PTR4O7wc9Yl+eaL
sPTk4bDGvGzudF4jBwAqIcah
          "]]}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]]}, {}}, {{
         Directive[
          PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], 
          AbsoluteThickness[1.6], 
          RGBColor[0, 1, 0]]}, {}}}, {{}, {}}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[
       Rational[1, 5], 0.2], Axes -> {False, False}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0., 0}, DisplayFunction :> 
     Identity, Frame -> {{True, True}, {True, True}}, 
     FrameLabel -> {{None, None}, {None, None}}, FrameStyle -> Automatic, 
     FrameTicks -> {{All, None}, {{{1, 
          FormBox["1", TraditionalForm]}, {2, 
          FormBox["2", TraditionalForm]}, {3, 
          FormBox["3", TraditionalForm]}, {4, 
          FormBox["4", TraditionalForm]}, {5, 
          FormBox["5", TraditionalForm]}, {6, 
          FormBox["6", TraditionalForm]}, {7, 
          FormBox["7", TraditionalForm]}, {8, 
          FormBox["8", TraditionalForm]}, {9, 
          FormBox["9", TraditionalForm]}, {10, 
          FormBox["10", TraditionalForm]}, {11, 
          FormBox["11", TraditionalForm]}, {12, 
          FormBox["12", TraditionalForm]}, {13, 
          FormBox["13", TraditionalForm]}, {14, 
          FormBox["14", TraditionalForm]}, {15, 
          FormBox["15", TraditionalForm]}, {16, 
          FormBox["16", TraditionalForm]}, {17, 
          FormBox["17", TraditionalForm]}, {18, 
          FormBox["18", TraditionalForm]}, {19, 
          FormBox["19", TraditionalForm]}, {20, 
          FormBox["20", TraditionalForm]}, {21, 
          FormBox["21", TraditionalForm]}, {22, 
          FormBox["22", TraditionalForm]}, {23, 
          FormBox["23", TraditionalForm]}, {24, 
          FormBox["24", TraditionalForm]}, {25, 
          FormBox["25", TraditionalForm]}, {26, 
          FormBox["26", TraditionalForm]}, {27, 
          FormBox["27", TraditionalForm]}, {28, 
          FormBox["28", TraditionalForm]}, {29, 
          FormBox["29", TraditionalForm]}, {30, 
          FormBox["30", TraditionalForm]}, {31, 
          FormBox["31", TraditionalForm]}, {32, 
          FormBox["32", TraditionalForm]}, {33, 
          FormBox["33", TraditionalForm]}, {34, 
          FormBox["34", TraditionalForm]}, {35, 
          FormBox["35", TraditionalForm]}, {36, 
          FormBox["36", TraditionalForm]}, {37, 
          FormBox["37", TraditionalForm]}, {38, 
          FormBox["38", TraditionalForm]}, {39, 
          FormBox["39", TraditionalForm]}, {40, 
          FormBox["40", TraditionalForm]}, {41, 
          FormBox["41", TraditionalForm]}, {42, 
          FormBox["42", TraditionalForm]}, {43, 
          FormBox["43", TraditionalForm]}, {44, 
          FormBox["44", TraditionalForm]}, {45, 
          FormBox["45", TraditionalForm]}, {46, 
          FormBox["46", TraditionalForm]}, {47, 
          FormBox["47", TraditionalForm]}, {48, 
          FormBox["48", TraditionalForm]}, {49, 
          FormBox["49", TraditionalForm]}, {50, 
          FormBox["50", TraditionalForm]}, {51, 
          FormBox["51", TraditionalForm]}, {52, 
          FormBox["52", TraditionalForm]}, {53, 
          FormBox["53", TraditionalForm]}, {54, 
          FormBox["54", TraditionalForm]}}, None}}, 
     GridLines -> {Automatic, Automatic}, GridLinesStyle -> Directive[
       GrayLevel[0.4, 0.5], 
       AbsoluteThickness[1], 
       AbsoluteDashing[{1, 2}]], ImageSize -> {700, 200}, 
     Method -> {
      "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, PlotLabel -> FormBox[
       StyleBox[
       "\"Phase3 (8 gen. , 6 indiv.)\"", Bold, 13, StripOnInput -> False], 
       TraditionalForm], PlotRange -> {{0., 48.}, {0, 12.870771097008376`}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    TagBox[
     GridBox[{{
        FormBox[
         TemplateBox[{"\"1st IntError\""}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
                 "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\[FilledCircle]\"", ",", "10"}], "}"}], 
                   "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "True", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}, {
        FormBox[
         TemplateBox[{"\"2nd IntError\""}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0.5, 0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0.5, 0]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0.5, 0]], FontSize -> 10, Plain, StripOnInput -> 
                    False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0.5, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[0.6666666666666666, 0.33333333333333337`, 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0.5`", ",", "0"}], "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0.5, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[1, 0.5, 0], Editable -> False, Selectable -> 
                    False]}], "]"}], "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\[FilledCircle]\"", ",", "10"}], "}"}], 
                   "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "True", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}, {
        FormBox[
         TemplateBox[{"\"Phase Error\""}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 1, 0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 1, 0]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    RGBColor[0, 1, 0]], FontSize -> 10, Plain, StripOnInput -> 
                    False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", 
                    FractionBox["7", "360"], "]"}], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0, 1, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> RGBColor[0., 0.6666666666666666, 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], NumberMarks -> 
                    False]], Appearance -> None, BaseStyle -> {}, 
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0, 1, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0, 1, 0], Editable -> False, Selectable -> 
                    False]}], "]"}], "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\[FilledCircle]\"", ",", "10"}], "}"}], 
                   "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "True", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}}, 
      GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> False, 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
      GridBoxSpacings -> {"Columns" -> {{0}}}], "Grid"], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Print",
 CellChangeTimes->{{3.8298402186100535`*^9, 3.8298403060213437`*^9}, {
   3.8298403405185413`*^9, 3.8298403497517333`*^9}, 3.8298965173761387`*^9, {
   3.8299193413854666`*^9, 3.8299193965780153`*^9}, {3.829919471231518*^9, 
   3.8299194766534195`*^9}, {3.829919522449587*^9, 3.8299195269964857`*^9}, {
   3.8299195626818724`*^9, 3.8299196129008183`*^9}},
 CellLabel->
  "During evaluation of \
In[209]:=",ExpressionUUID->"c4cde897-fda7-41d1-b57a-0f523fed23db"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Best Individual", "Section",
 CellChangeTimes->{{3.8297325840560007`*^9, 3.829732587642288*^9}, {
  3.829820428031332*^9, 3.8298204332953825`*^9}, {3.829840921463166*^9, 
  3.8298409221726913`*^9}},ExpressionUUID->"99ea9db4-4270-422b-8e2a-\
27d7e6db8cb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"errorMtx2", "[", 
     RowBox[{"[", 
      RowBox[{"generation", ",", "i", ",", "phase"}], "]"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"Int1Error", ",", "Int2Error", ",", 
      RowBox[{"RootMeanSquare", "[", "phError", "]"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"magMtx2", "[", 
     RowBox[{"[", "i", "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"offspring1", ",", "offspringIdx1", ",", "termination1"}], 
      "}"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"12", ",", "3", ",", "4"}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"costTotal2", "[", 
    RowBox[{"[", 
     RowBox[{"gen", ",", "i"}], "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DumpGet", "[", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<errorMtx2.mx\>\""}],
       "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DumpGet", "[", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<magMtx2.mx\>\""}], 
      "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DumpGet", "[", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<costTotal2.mx\>\""}], "]"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8297591425754366`*^9, 3.8297592298563104`*^9}, {
  3.8298133814643283`*^9, 3.8298134018223906`*^9}, {3.8298134360596046`*^9, 
  3.829813443074767*^9}, {3.829814116894725*^9, 3.8298141365563855`*^9}, {
  3.8298145797991734`*^9, 3.8298145842484694`*^9}, {3.8298146169205723`*^9, 
  3.8298146269684124`*^9}, {3.829814679001466*^9, 3.8298147106392455`*^9}, {
  3.829833555228091*^9, 3.8298335558521595`*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"9f1a2cb9-79f4-4671-a68e-6175d51c2daf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bestGen", "=", 
   RowBox[{
    RowBox[{"Ordering", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"costTotal2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"nGen", "-", "1"}]}], "}"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bestInd", "=", 
    RowBox[{
     RowBox[{"Ordering", "[", 
      RowBox[{"costTotal2", "[", 
       RowBox[{"[", "bestGen", "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bestMag", "=", 
   RowBox[{"magMtx2", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"6", "*", 
        RowBox[{"(", 
         RowBox[{"bestGen", "-", "1"}], ")"}]}], "+", "bestInd"}], ",", "1"}],
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bestTerm", "=", 
   RowBox[{"magMtx2", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"6", "*", 
        RowBox[{"(", 
         RowBox[{"bestGen", "-", "1"}], ")"}]}], "+", "bestInd"}], ",", "3"}],
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bestBlockList", "=", 
    RowBox[{"magMtx2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"6", "*", 
         RowBox[{"(", 
          RowBox[{"bestGen", "-", "1"}], ")"}]}], "+", "bestInd"}], ",", 
       "2"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bestIndiv", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"bestTerm", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1", ",", "All"}], "]"}], "]"}], ",", "bestMag", 
     ",", 
     RowBox[{"bestTerm", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "4", ",", "All"}], "]"}], "]"}], ",", "2"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8298156947471685`*^9, 3.829815724438442*^9}, {
  3.8298158618079367`*^9, 3.829815901397009*^9}, {3.829818597410513*^9, 
  3.829818744819222*^9}, {3.8298187914958363`*^9, 3.8298188596895895`*^9}, {
  3.8298188964165487`*^9, 3.8298189793722744`*^9}, {3.829833557608896*^9, 
  3.829833562576722*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[210]:=",ExpressionUUID->"188e8a55-92c3-447b-ba1e-4ac37e13e066"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"testError", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "nphase"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testErrorMtx", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "nphase"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"phase", "=", "1"}], ",", 
     RowBox[{"phase", "\[LessEqual]", "nphase"}], ",", 
     RowBox[{"phase", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", "Draw", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"device", "=", 
       RowBox[{"idDraw", "[", 
        RowBox[{
         RowBox[{"typeID", "=", "\"\<DeltaUndulator\>\""}], ",", "gap", ",", 
         "nPeriods", ",", "periodL", ",", "blockGeo", ",", "blockThick", ",", 
         "blockGap", ",", "bestMag", ",", "bestTerm", ",", "phase", ",", 
         "subdiv"}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "Solve", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"idSolve", "[", "device", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "Field", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"baxis", "=", 
       RowBox[{"idField", "[", 
        RowBox[{"device", ",", "li", ",", "lf", ",", "lNpts", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"display", "=", "0"}], ",", 
         RowBox[{"oneplot", "=", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Integral", " ", "Error"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"integral", "=", 
       RowBox[{"idFieldInt", "[", 
        RowBox[{
        "device", ",", "li", ",", "lf", ",", "lstep", ",", "baxis", ",", 
         RowBox[{"display", "=", "0"}], ",", 
         RowBox[{"oneplot", "=", "0"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Int1Error", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"integral", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ")"}], "^", 
            "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"integral", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ")"}], "^", 
            "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"integral", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], ")"}], "^", 
            "2"}]}], ")"}], "/", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Int2Error", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"integral", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ")"}], "^", 
            "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"integral", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ")"}], "^", 
            "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"integral", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], ")"}], "^", 
            "2"}]}], ")"}], "/", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "Trajetoria", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Trajetoria", "=", 
       RowBox[{"idTrajectory", "[", 
        RowBox[{"device", ",", " ", "eEnergy", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "li", ",", "0", ",", "0", ",", "1"}], 
          "}"}], ",", "lf", ",", "lstep", ",", 
         RowBox[{"display", "=", "0"}]}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Phase", " ", "Error"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"phError", "=", 
       RowBox[{"idPhaseError", "[", 
        RowBox[{
        "baxis", ",", "li", ",", "lf", ",", "lNpts", ",", "Trajetoria", ",", 
         "eEnergy"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Error", " ", "Function"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"weight1Int", "=", 
       RowBox[{"1", "/", "77"}]}], ";", " ", 
      RowBox[{"weight2Int", "=", 
       RowBox[{"1", "/", "7.6"}]}], ";", " ", 
      RowBox[{"weightPh", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"testError", "[", 
        RowBox[{"[", "phase", "]"}], "]"}], "=", " ", 
       RowBox[{
        RowBox[{"Int1Error", "*", "weight1Int"}], "+", 
        RowBox[{"Int2Error", "*", "weight2Int"}], "+", 
        RowBox[{
         RowBox[{"RootMeanSquare", "[", "phError", "]"}], "*", 
         "weightPh"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"testErrorMtx", "[", 
        RowBox[{"[", "phase", "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"Int1Error", ",", "Int2Error", ",", 
         RowBox[{"RootMeanSquare", "[", "phError", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\\n>> Cost [Phase \>\"", ",", "Bold", ",", "13"}], 
         "]"}], ",", "phase", ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<]: \>\"", ",", "Bold", ",", "13"}], "]"}], ",", 
        RowBox[{"testError", "[", 
         RowBox[{"[", "phase", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<- 1st Integral (Ix,Iy,Iz)[G.cm]:\\t\>\"", ",", 
        RowBox[{"integral", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], " ", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<- 2nd Integral (IIx,IIy,IIz)[G.cm\.b2]:\\t\>\"", ",", 
        RowBox[{"integral", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], " ", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<- RMS Phase Error [deg]:\\t\\t\>\"", ",", 
        RowBox[{"RootMeanSquare", "[", "phError", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}], ";"}], 
  RowBox[{"(*", "Phase", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testCost", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"testError", "[", 
       RowBox[{"[", "k", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "nphase"}], "}"}]}], "]"}], "/", 
    "nphase"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{"\"\<\\n>> Total Cost: \>\"", ",", "Bold", ",", "14"}], "]"}], 
    ",", " ", "testCost"}], "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.829819006450987*^9, 3.8298190128364687`*^9}, {
  3.8298191131100283`*^9, 3.8298193357583675`*^9}, {3.829819435096271*^9, 
  3.8298197128423295`*^9}, {3.8298198480713835`*^9, 3.8298198910347414`*^9}, {
  3.8298199553865614`*^9, 3.8298200080110254`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[216]:=",ExpressionUUID->"b1026277-bab1-4b5a-ba92-e8b213c7e7d8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"\\n>> Cost [Phase \"\>",
    StripOnInput->False,
    FontSize->13,
    FontWeight->Bold], "\[InvisibleSpace]", "1", "\[InvisibleSpace]", 
   StyleBox["\<\"]: \"\>",
    StripOnInput->False,
    FontSize->13,
    FontWeight->Bold], "\[InvisibleSpace]", "2.233173058173182`"}],
  SequenceForm[
   Style["\n>> Cost [Phase ", Bold, 13], 1, 
   Style["]: ", Bold, 13], 2.233173058173182],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299198368381805`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"cf494de2-50c3-4bb4-92e8-85fa8a292c75"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- 1st Integral (Ix,Iy,Iz)[G.cm]:\\t\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10.622344312333125`"}], ",", "28.92026842251675`", ",", 
     "0.014743604205074479`"}], "}"}]}],
  SequenceForm[
  "- 1st Integral (Ix,Iy,Iz)[G.cm]:\t", {-10.622344312333125`, 
   28.92026842251675, 0.014743604205074479`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299198368381805`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"0861d040-3426-4ea0-aaf5-079831d7d1eb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- 2nd Integral (IIx,IIy,IIz)[G.cm\.b2]:\\t\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"9.110245411446234`", ",", "2.1573806040170203`", ",", 
     RowBox[{"-", "1.3947808011392686`"}]}], "}"}]}],
  SequenceForm[
  "- 2nd Integral (IIx,IIy,IIz)[G.cm\.b2]:\t", {9.110245411446234, 
   2.1573806040170203`, -1.3947808011392686`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299198368381805`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"7dff676e-5cca-4bbd-befb-4256f966f536"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- RMS Phase Error [deg]:\\t\\t\"\>", "\[InvisibleSpace]", 
   "1.2830934871753463`"}],
  SequenceForm["- RMS Phase Error [deg]:\t\t", 1.2830934871753463`],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299198368381805`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"e5bdbc33-c166-4fe3-b63c-6f4510872086"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"\\n>> Cost [Phase \"\>",
    StripOnInput->False,
    FontSize->13,
    FontWeight->Bold], "\[InvisibleSpace]", "2", "\[InvisibleSpace]", 
   StyleBox["\<\"]: \"\>",
    StripOnInput->False,
    FontSize->13,
    FontWeight->Bold], "\[InvisibleSpace]", "7.413366130889179`"}],
  SequenceForm[
   Style["\n>> Cost [Phase ", Bold, 13], 2, 
   Style["]: ", Bold, 13], 7.413366130889179],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299200144314365`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"905e33d0-3ae8-4a78-a4d0-2b4e4604c693"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- 1st Integral (Ix,Iy,Iz)[G.cm]:\\t\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "14.596493679451946`"}], ",", "14.340380082316383`", ",", 
     "0.07474287096878508`"}], "}"}]}],
  SequenceForm[
  "- 1st Integral (Ix,Iy,Iz)[G.cm]:\t", {-14.596493679451946`, 
   14.340380082316383`, 0.07474287096878508}],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299200144314365`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"a8b21134-c9fe-48d3-af7c-292720fcb4b4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- 2nd Integral (IIx,IIy,IIz)[G.cm\.b2]:\\t\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"9.290866892384715`", ",", "2.979555294369287`", ",", 
     RowBox[{"-", "1.3717790374261414`"}]}], "}"}]}],
  SequenceForm[
  "- 2nd Integral (IIx,IIy,IIz)[G.cm\.b2]:\t", {9.290866892384715, 
   2.979555294369287, -1.3717790374261414`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299200144314365`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"e52260dd-1b5e-43d4-8278-0c3501d926f1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- RMS Phase Error [deg]:\\t\\t\"\>", "\[InvisibleSpace]", 
   "6.511440926092524`"}],
  SequenceForm["- RMS Phase Error [deg]:\t\t", 6.511440926092524],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299200144314365`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"81fcad26-b6c9-48af-b6d3-1409c8d7e974"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"\\n>> Cost [Phase \"\>",
    StripOnInput->False,
    FontSize->13,
    FontWeight->Bold], "\[InvisibleSpace]", "3", "\[InvisibleSpace]", 
   StyleBox["\<\"]: \"\>",
    StripOnInput->False,
    FontSize->13,
    FontWeight->Bold], "\[InvisibleSpace]", "2.3942564797440187`"}],
  SequenceForm[
   Style["\n>> Cost [Phase ", Bold, 13], 3, 
   Style["]: ", Bold, 13], 2.3942564797440187`],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.829920191664931*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"0165f04f-8680-4803-b95e-4c11b97fe746"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- 1st Integral (Ix,Iy,Iz)[G.cm]:\\t\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "67.12132927082754`"}], ",", "8.051951918125214`", ",", 
     "0.26489352966381613`"}], "}"}]}],
  SequenceForm[
  "- 1st Integral (Ix,Iy,Iz)[G.cm]:\t", {-67.12132927082754, 
   8.051951918125214, 0.26489352966381613`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.829920191664931*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"a9d94042-b821-45a2-a644-6ea0d5aab9f7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- 2nd Integral (IIx,IIy,IIz)[G.cm\.b2]:\\t\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"5.340321077428324`", ",", 
     RowBox[{"-", "2.6038335056835007`"}], ",", 
     RowBox[{"-", "1.3329799918429193`"}]}], "}"}]}],
  SequenceForm[
  "- 2nd Integral (IIx,IIy,IIz)[G.cm\.b2]:\t", {
   5.340321077428324, -2.6038335056835007`, -1.3329799918429193`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299201916805563`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"2bd38a52-de6b-4412-b4b7-7d1c43e0d42b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- RMS Phase Error [deg]:\\t\\t\"\>", "\[InvisibleSpace]", 
   "1.4248015582495919`"}],
  SequenceForm["- RMS Phase Error [deg]:\t\t", 1.4248015582495919`],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299201916805563`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"def94759-f8c5-49bb-82c1-489e22d6e563"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"\\n>> Total Cost: \"\>",
    StripOnInput->False,
    FontSize->14,
    FontWeight->Bold], "\[InvisibleSpace]", "4.013598556268793`"}],
  SequenceForm[
   Style["\n>> Total Cost: ", Bold, 14], 4.013598556268793],
  Editable->False]], "Print",
 CellChangeTimes->{3.8298201510592985`*^9, 3.829896721390529*^9, 
  3.8299201916805563`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"05ef9d4d-78d1-4a90-b449-cbcbbd7e76fe"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export", "Section",
 CellChangeTimes->{{3.829838714588422*^9, 
  3.829838715252263*^9}},ExpressionUUID->"bdf08dea-4834-47a7-b4e4-\
f597c91f3f33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fileNameB", "=", "\"\<Blocks_B_V2.xlsx\>\""}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Magnetizations", " ", "File", " ", "name", " ", 
    RowBox[{"(", 
     RowBox[{"with", " ", "extension"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"headLineB", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "Head", " ", "Lines", " ", "on", " ", "the", " ",
     "File"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileNameT", "=", "\"\<Blocks_T_V2.xlsx\>\""}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Magnetizations", " ", "File", " ", "name", " ", 
    RowBox[{"(", 
     RowBox[{"with", " ", "extension"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"headLineT", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "Head", " ", "Lines", " ", "on", " ", "the", " ",
     "File"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listMagB", "=", 
   RowBox[{"idSortingImportMag", "[", 
    RowBox[{"fileNameB", ",", "headLineB"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listMagT", "=", 
   RowBox[{"idSortingImportMag", "[", 
    RowBox[{"fileNameT", ",", "headLineT"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.829820756632382*^9, 3.8298207580223384`*^9}, {
  3.829820888131859*^9, 3.829820888386568*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[221]:=",ExpressionUUID->"89c7ad0d-7d40-493b-9604-70934056674d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"magLimit", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dir", "=", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Termination", " ", "Front", " ", "Index"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"idxTf", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"listMagT", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"bestBlockList", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "bestBlockList", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"bestTerm", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Normal", " ", "Size", " ", "Blocks", " ", "Index"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"idxb", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"listMagB", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"bestBlockList", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "bestBlockList", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"bestTerm", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"bestBlockList", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
         RowBox[{"Length", "[", 
          RowBox[{"bestTerm", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Termination", " ", "Back", " ", "Index"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"idxTb", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"listMagT", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"bestBlockList", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "bestBlockList", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", 
         RowBox[{"Length", "[", 
          RowBox[{"bestTerm", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"idx", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"idxTf", ",", "idxb", ",", "idxTb", ",", "2"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.824387005948445*^9, 3.8243870329880853`*^9}, {
   3.82438711725729*^9, 3.824387132407564*^9}, {3.824387178754134*^9, 
   3.824387211672903*^9}, {3.8243872431968575`*^9, 3.8243873637122993`*^9}, {
   3.824387575613282*^9, 3.824387585349804*^9}, {3.824387626221998*^9, 
   3.824387627745124*^9}, {3.8243876804834976`*^9, 3.824387747587452*^9}, {
   3.82438793669376*^9, 3.824387954408394*^9}, {3.824387991467616*^9, 
   3.82438802822399*^9}, {3.824388121044731*^9, 3.8243882453264456`*^9}, 
   3.824388312258857*^9, {3.8243885006924624`*^9, 3.8243887301999035`*^9}, {
   3.824388765408686*^9, 3.8243888005149746`*^9}, {3.8243888329065857`*^9, 
   3.824388850311941*^9}, {3.8243889832042685`*^9, 3.824389001488744*^9}, {
   3.8243890830319138`*^9, 3.8243891023732233`*^9}, {3.824391590511155*^9, 
   3.8243916517739134`*^9}, {3.824391696902976*^9, 3.824391727202298*^9}, {
   3.8243918064596233`*^9, 3.8243918525982075`*^9}, {3.824483488907426*^9, 
   3.824483499002688*^9}, {3.8245459796151447`*^9, 3.8245459880820456`*^9}, {
   3.828518147933011*^9, 3.828518157942628*^9}, {3.8285184386643004`*^9, 
   3.8285184413859134`*^9}, {3.82851988382559*^9, 3.828519910343066*^9}, {
   3.828520121321742*^9, 3.8285201732686434`*^9}, {3.8285202248181667`*^9, 
   3.828520248125553*^9}, 3.828520283055109*^9, {3.828520504694028*^9, 
   3.8285205057350264`*^9}, {3.828520977078823*^9, 3.8285209968398066`*^9}, {
   3.829820654649457*^9, 3.829820655004558*^9}, {3.8298209526149535`*^9, 
   3.8298209863047667`*^9}, {3.8298210525997624`*^9, 3.829821098877813*^9}, {
   3.8298215296088657`*^9, 3.829821586175048*^9}, 3.8298216769466047`*^9, {
   3.829821885617747*^9, 3.8298219111077166`*^9}, 3.829832457728711*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[227]:=",ExpressionUUID->"5e33845b-b650-4ffa-a4f9-79333c4a448b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Termination", " ", "Front", " ", "Rotation", " ", "Indicative"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diffTf", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"listMagT", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"idxTf", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
        "-", 
        RowBox[{"bestTerm", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "1", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "idxTf", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"idxTf", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Normal", " ", "Size", " ", "Blocks", " ", "Rotation", " ", 
     "Indicative"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"diffb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"listMagB", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"idxb", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
        "-", 
        RowBox[{"bestMag", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "idxb", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"idxb", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"Termination", " ", "Back", " ", "Rotation", " ", "Indicative"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diffTb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"listMagT", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"idxTb", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
        "-", 
        RowBox[{"bestTerm", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "1", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "idxTb", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"idxTb", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diff", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"diffTf", ",", "diffb", ",", "diffTb", ",", "2"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.824387005948445*^9, 3.8243870329880853`*^9}, {
   3.82438711725729*^9, 3.824387132407564*^9}, {3.824387178754134*^9, 
   3.824387211672903*^9}, {3.8243872431968575`*^9, 3.8243873637122993`*^9}, {
   3.824387575613282*^9, 3.824387585349804*^9}, {3.824387626221998*^9, 
   3.824387627745124*^9}, {3.8243876804834976`*^9, 3.824387747587452*^9}, {
   3.82438793669376*^9, 3.824387954408394*^9}, {3.824387991467616*^9, 
   3.82438802822399*^9}, {3.824388121044731*^9, 3.8243882453264456`*^9}, 
   3.824388312258857*^9, {3.8243885006924624`*^9, 3.8243887301999035`*^9}, {
   3.824388765408686*^9, 3.8243888005149746`*^9}, {3.8243888329065857`*^9, 
   3.824388850311941*^9}, {3.8243889832042685`*^9, 3.824389001488744*^9}, {
   3.8243890830319138`*^9, 3.8243891023732233`*^9}, {3.824391590511155*^9, 
   3.8243916517739134`*^9}, {3.824391696902976*^9, 3.824391727202298*^9}, {
   3.8243918064596233`*^9, 3.8243918525982075`*^9}, {3.824483488907426*^9, 
   3.824483499002688*^9}, {3.8245459796151447`*^9, 3.8245459880820456`*^9}, {
   3.828518147933011*^9, 3.828518157942628*^9}, {3.8285205448706217`*^9, 
   3.8285206099240966`*^9}, {3.8285206630721703`*^9, 3.828520786749983*^9}, {
   3.828520939684898*^9, 3.828521049940818*^9}, {3.829821688314851*^9, 
   3.8298216935035224`*^9}, {3.8298217835118866`*^9, 3.8298217886935253`*^9}, 
   3.829821837935653*^9, {3.8298218800012903`*^9, 3.829821880957903*^9}, {
   3.8298219846015673`*^9, 3.8298220160312376`*^9}, 3.829822256913931*^9, {
   3.8298227240690575`*^9, 3.829822773766382*^9}, {3.8298228139537506`*^9, 
   3.8298228175730925`*^9}, {3.8298315112440443`*^9, 
   3.8298315554609056`*^9}, {3.8298316755916476`*^9, 
   3.8298316779958487`*^9}, {3.8298317292321877`*^9, 3.8298317661897297`*^9}, 
   3.829832632402822*^9, {3.8298327204073987`*^9, 3.8298327210609927`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[233]:=",ExpressionUUID->"56cfd4df-48a3-41c1-8191-148171399217"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Create", " ", "a", " ", "matrix", " ", "with", " ", "1", " ", "for", " ",
      "rotated", " ", "blocks"}], ",", " ", 
    RowBox[{"and", " ", "0", " ", "for", " ", "unrotated", " ", "blocks"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rotateIdx", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"diff", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i", ",", "1"}], "]"}], "]"}], "]"}], "<", 
         "magLimit"}], ",", "0", ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "diff", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"diff", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.824387005948445*^9, 3.8243870329880853`*^9}, {
   3.82438711725729*^9, 3.824387132407564*^9}, {3.824387178754134*^9, 
   3.824387211672903*^9}, {3.8243872431968575`*^9, 3.8243873637122993`*^9}, {
   3.824387575613282*^9, 3.824387585349804*^9}, {3.824387626221998*^9, 
   3.824387627745124*^9}, {3.8243876804834976`*^9, 3.824387747587452*^9}, {
   3.82438793669376*^9, 3.824387954408394*^9}, {3.824387991467616*^9, 
   3.82438802822399*^9}, {3.824388121044731*^9, 3.8243882453264456`*^9}, 
   3.824388312258857*^9, {3.8243885006924624`*^9, 3.8243887301999035`*^9}, {
   3.824388765408686*^9, 3.8243888005149746`*^9}, {3.8243888329065857`*^9, 
   3.824388850311941*^9}, {3.8243889832042685`*^9, 3.824389001488744*^9}, {
   3.8243890830319138`*^9, 3.8243891023732233`*^9}, {3.824391590511155*^9, 
   3.8243916517739134`*^9}, {3.824391696902976*^9, 3.824391727202298*^9}, {
   3.8243918064596233`*^9, 3.8243918525982075`*^9}, {3.824483488907426*^9, 
   3.824483499002688*^9}, {3.8245459796151447`*^9, 3.8245459880820456`*^9}, {
   3.828518147933011*^9, 3.828518157942628*^9}, {3.8285205448706217`*^9, 
   3.8285206099240966`*^9}, {3.8285206630721703`*^9, 3.828520760934183*^9}, {
   3.82853519934956*^9, 3.828535199663122*^9}, {3.8285352769501257`*^9, 
   3.8285353032938037`*^9}, {3.8285353422106237`*^9, 
   3.8285353423558426`*^9}, {3.8298329464098206`*^9, 3.829832948348133*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[237]:=",ExpressionUUID->"555135c2-9706-4b50-8b9c-6f11c97b8cc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Create", " ", "Result", " ", "Matrix"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"resultCass", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"bestBlockList", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], "}"}], ",", 
        RowBox[{"bestIndiv", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"rotateIdx", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "bestIndiv", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"bestIndiv", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.824387005948445*^9, 3.8243870329880853`*^9}, {
   3.82438711725729*^9, 3.824387132407564*^9}, {3.824387178754134*^9, 
   3.824387211672903*^9}, {3.8243872431968575`*^9, 3.8243873637122993`*^9}, {
   3.824387575613282*^9, 3.824387585349804*^9}, {3.824387626221998*^9, 
   3.824387627745124*^9}, {3.8243876804834976`*^9, 3.824387747587452*^9}, {
   3.82438793669376*^9, 3.824387954408394*^9}, {3.824387991467616*^9, 
   3.82438802822399*^9}, {3.824388121044731*^9, 3.8243882453264456`*^9}, 
   3.824388312258857*^9, {3.8243885006924624`*^9, 3.8243887301999035`*^9}, {
   3.824388765408686*^9, 3.8243888005149746`*^9}, {3.8243888329065857`*^9, 
   3.824388850311941*^9}, {3.8243889832042685`*^9, 3.824389001488744*^9}, {
   3.8243890830319138`*^9, 3.8243891023732233`*^9}, {3.824391590511155*^9, 
   3.8243916517739134`*^9}, {3.824391696902976*^9, 3.824391727202298*^9}, {
   3.8243918064596233`*^9, 3.8243918525982075`*^9}, {3.824483488907426*^9, 
   3.824483499002688*^9}, {3.8245459796151447`*^9, 3.8245459880820456`*^9}, 
   3.828518147933011*^9, 3.828535455753793*^9, {3.829833347218587*^9, 
   3.8298333514153857`*^9}, {3.829838332994162*^9, 3.8298383411321087`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[238]:=",ExpressionUUID->"4bd50bc4-9961-4a69-b87d-5c397e7b8cbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{"dir", ",", "\"\<Sorting_Otimization_Result.xlsx\>\""}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<Cassete ID\>\"", "\[Rule]", " ", 
       RowBox[{"resultCass", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Cassete IE\>\"", "\[Rule]", 
       RowBox[{"resultCass", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Cassete SE\>\"", "\[Rule]", 
       RowBox[{"resultCass", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Cassete SD\>\"", "\[Rule]", 
       RowBox[{"resultCass", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.824387005948445*^9, 3.8243870329880853`*^9}, {
   3.82438711725729*^9, 3.824387132407564*^9}, {3.824387178754134*^9, 
   3.824387211672903*^9}, {3.8243872431968575`*^9, 3.8243873637122993`*^9}, {
   3.824387575613282*^9, 3.824387585349804*^9}, {3.824387626221998*^9, 
   3.824387627745124*^9}, {3.8243876804834976`*^9, 3.824387747587452*^9}, {
   3.82438793669376*^9, 3.824387954408394*^9}, {3.824387991467616*^9, 
   3.82438802822399*^9}, {3.824388121044731*^9, 3.8243882453264456`*^9}, 
   3.824388312258857*^9, {3.8243885006924624`*^9, 3.8243887301999035`*^9}, {
   3.824388765408686*^9, 3.8243888005149746`*^9}, {3.8243888329065857`*^9, 
   3.824388850311941*^9}, {3.8243889832042685`*^9, 3.824389001488744*^9}, {
   3.8243890830319138`*^9, 3.8243891023732233`*^9}, {3.824391590511155*^9, 
   3.8243916517739134`*^9}, {3.824391696902976*^9, 3.824391727202298*^9}, {
   3.8243918064596233`*^9, 3.8243918525982075`*^9}, {3.824483488907426*^9, 
   3.824483499002688*^9}, {3.8245459796151447`*^9, 3.8245459880820456`*^9}, 
   3.828518147933011*^9, 3.828535455753793*^9, {3.8287149526871433`*^9, 
   3.8287149776123266`*^9}, {3.829838383495947*^9, 3.8298383854227552`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[239]:=",ExpressionUUID->"e6e45f3b-c913-4d9e-b6cb-45edfc980b72"]
}, Open  ]]
},
WindowSize->{1366, 725},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 305, 5, 67, "Section",ExpressionUUID->"a20bfe0c-ce1c-4fe5-95f0-72aace82b492"],
Cell[CellGroupData[{
Cell[910, 31, 874, 19, 102, "Input",ExpressionUUID->"03992682-afbe-4169-bb6f-06bebcd00eeb"],
Cell[CellGroupData[{
Cell[1809, 54, 644, 13, 22, "Print",ExpressionUUID->"d98cdd68-a081-4abb-ba3b-5c259baacc5a"],
Cell[2456, 69, 476, 8, 22, "Print",ExpressionUUID->"e8a413b1-6d75-4310-a719-6bb6ac0b058b"],
Cell[2935, 79, 492, 9, 22, "Print",ExpressionUUID->"f93c323c-622c-4326-8a5f-47779d0a360d"],
Cell[3430, 90, 485, 8, 22, "Print",ExpressionUUID->"f5d08969-e3b9-4819-94a5-27d4b1579215"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3976, 105, 154, 3, 67, "Section",ExpressionUUID->"840b05d9-51ab-45e4-ba4d-6d8d1291fdf4"],
Cell[CellGroupData[{
Cell[4155, 112, 161, 3, 53, "Subsection",ExpressionUUID->"d8aa3d6e-c222-46c0-a648-0b9d56672601"],
Cell[4319, 117, 6334, 165, 367, "Input",ExpressionUUID->"321735b9-b075-4bbb-8fe7-1fe4be8c7c82"]
}, Closed]],
Cell[CellGroupData[{
Cell[10690, 287, 215, 4, 37, "Subsection",ExpressionUUID->"d5b41983-278f-47c0-9e7b-c32de49448a7"],
Cell[10908, 293, 28241, 615, 2894, "Input",ExpressionUUID->"8364b443-e1d6-4c82-a34b-4f609527996f"]
}, Closed]],
Cell[CellGroupData[{
Cell[39186, 913, 156, 3, 37, "Subsection",ExpressionUUID->"51cb89dd-7aeb-44ea-a317-5ad1203e5d64"],
Cell[39345, 918, 19774, 417, 1266, "Input",ExpressionUUID->"95243fa1-4b54-4745-9acb-bc07d15f3e54"]
}, Closed]],
Cell[CellGroupData[{
Cell[59156, 1340, 218, 4, 37, "Subsection",ExpressionUUID->"815dbba2-f00e-4ce5-b85c-2e5cdeff26df"],
Cell[59377, 1346, 20575, 464, 1266, "Input",ExpressionUUID->"c6e471c8-d370-41aa-b90d-ea83ddd693a5"]
}, Closed]],
Cell[CellGroupData[{
Cell[79989, 1815, 222, 4, 37, "Subsection",ExpressionUUID->"2471c28d-facd-48e0-9fe9-b02242a87935"],
Cell[80214, 1821, 50374, 1151, 2571, "Input",ExpressionUUID->"9755bac4-8b7b-40fc-b78a-09929cccd3e6"],
Cell[130591, 2974, 177, 3, 27, "Input",ExpressionUUID->"d71f2df0-3388-4b01-93c1-90c27c360ae1"]
}, Closed]],
Cell[CellGroupData[{
Cell[130805, 2982, 219, 4, 37, "Subsection",ExpressionUUID->"3bfd9293-4ca8-4015-8a66-b17a4bc25a6e"],
Cell[131027, 2988, 3776, 94, 310, "Input",ExpressionUUID->"26df87e0-4b9c-40b2-8c5e-2095ecb2f30b"]
}, Closed]],
Cell[CellGroupData[{
Cell[134840, 3087, 219, 4, 37, "Subsection",ExpressionUUID->"bbdc4e46-8c0c-4894-9793-c9ffaa8c8176"],
Cell[135062, 3093, 1935, 49, 158, "Input",ExpressionUUID->"dbd358d7-3966-4297-8250-9e95954ad690"]
}, Closed]],
Cell[CellGroupData[{
Cell[137034, 3147, 153, 3, 37, "Subsection",ExpressionUUID->"617a9e25-d1cf-4046-96f6-8268964adeef"],
Cell[137190, 3152, 1894, 40, 177, "Input",ExpressionUUID->"e2ff82c5-dc8b-4a3a-b2dc-2a85fef9fa01"]
}, Closed]],
Cell[CellGroupData[{
Cell[139121, 3197, 159, 3, 37, "Subsection",ExpressionUUID->"0bd4213d-5884-4c30-aab9-17fbbdf212a8"],
Cell[139283, 3202, 12870, 280, 690, "Input",ExpressionUUID->"7b07522a-1392-4257-a7c0-1c250cb2558d"]
}, Closed]],
Cell[CellGroupData[{
Cell[152190, 3487, 259, 4, 37, "Subsection",ExpressionUUID->"ff06735a-5dcd-4af4-b5d1-524b67fccf9c"],
Cell[152452, 3493, 18046, 416, 956, "Input",ExpressionUUID->"73ac0523-c825-4dd5-895d-2be8aa0fefb6"]
}, Closed]],
Cell[CellGroupData[{
Cell[170535, 3914, 223, 4, 37, "Subsection",ExpressionUUID->"42ae1a74-4d7c-492c-8b4c-7549d31deb5e"],
Cell[170761, 3920, 14846, 339, 1280, "Input",ExpressionUUID->"025bc5ab-4637-489a-906f-8dab98922eda"]
}, Closed]],
Cell[CellGroupData[{
Cell[185644, 4264, 165, 3, 37, "Subsection",ExpressionUUID->"b0078541-74f5-4ab7-855f-61a5f4c15790"],
Cell[185812, 4269, 3591, 94, 253, "Input",ExpressionUUID->"93a67c47-a1a5-45b6-be01-ef92e823a81a"]
}, Closed]],
Cell[CellGroupData[{
Cell[189440, 4368, 268, 4, 37, "Subsection",ExpressionUUID->"9c04e01e-677d-4fc8-96ac-fb04bbe32cbf"],
Cell[189711, 4374, 31743, 763, 2381, "Input",ExpressionUUID->"6b381c11-3d63-4a60-9e9e-44371b356054"]
}, Closed]],
Cell[CellGroupData[{
Cell[221491, 5142, 162, 3, 37, "Subsection",ExpressionUUID->"14ced6b7-8500-4c18-b83b-0dfbc2296d22"],
Cell[221656, 5147, 28347, 653, 2020, "Input",ExpressionUUID->"83085b5e-7bf9-4cee-8c85-4eaad9ea737e"]
}, Closed]],
Cell[CellGroupData[{
Cell[250040, 5805, 213, 4, 37, "Subsection",ExpressionUUID->"d4e2c33d-f22b-4238-9163-8e69154b75fb"],
Cell[250256, 5811, 40789, 899, 2590, "Input",ExpressionUUID->"735b04ef-a913-4cc2-918a-6cdc6904136f"]
}, Closed]],
Cell[CellGroupData[{
Cell[291082, 6715, 167, 3, 37, "Subsection",ExpressionUUID->"f69734b6-2902-4ff2-bc69-28e6345a5ad1"],
Cell[291252, 6720, 9812, 229, 558, "Input",ExpressionUUID->"38353bdc-6d56-44d9-ac89-35561fb445cb"]
}, Closed]],
Cell[CellGroupData[{
Cell[301101, 6954, 213, 4, 37, "Subsection",ExpressionUUID->"9fc6b17a-fc2f-4c11-bf14-5d8d67218b95"],
Cell[301317, 6960, 993, 25, 82, "Input",ExpressionUUID->"16c69f02-5cd9-4b85-91c9-c48b70d2c245"]
}, Closed]],
Cell[CellGroupData[{
Cell[302347, 6990, 170, 3, 37, "Subsection",ExpressionUUID->"16bbfc3b-c9f7-4e7c-88be-9fedc606ae0c"],
Cell[302520, 6995, 2381, 57, 292, "Input",ExpressionUUID->"7a603409-2e67-4a60-ab11-bdb2cecbd8c7"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[304950, 7058, 160, 3, 67, "Section",ExpressionUUID->"ad3b45f7-eb85-4cfe-93ad-7fc761086791"],
Cell[CellGroupData[{
Cell[305135, 7065, 162, 3, 53, "Subsection",ExpressionUUID->"4279ff7f-278c-41f2-8ff7-03254173c71a"],
Cell[305300, 7070, 16089, 347, 903, "Input",ExpressionUUID->"e09f2ade-ef71-487b-ac8d-afecef8816b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[321426, 7422, 170, 3, 53, "Subsection",ExpressionUUID->"7b203568-8089-4ab8-85b5-2c02e1f62e16"],
Cell[321599, 7427, 52242, 1309, 3617, "Input",ExpressionUUID->"f951ebae-15ff-40a7-ac07-638e5b6246b0"]
}, Closed]],
Cell[CellGroupData[{
Cell[373878, 8741, 155, 3, 37, "Subsection",ExpressionUUID->"86547095-574a-45c4-9fcc-02f0a4eb716e"],
Cell[CellGroupData[{
Cell[374058, 8748, 2888, 52, 121, "Input",ExpressionUUID->"afa167dc-2d48-4144-954a-1d254cf61099"],
Cell[376949, 8802, 881, 19, 77, "Print",ExpressionUUID->"c1727a0d-d5f9-46c6-bf5b-105584c501f5"]
}, Open  ]],
Cell[377845, 8824, 4450, 89, 235, "Input",ExpressionUUID->"15379898-1804-4b53-a228-76ea4e41ecf8"],
Cell[382298, 8915, 19453, 416, 1318, "Input",ExpressionUUID->"4a8c822e-a4e2-40ee-90d0-541035b9a7c5"],
Cell[401754, 9333, 925, 25, 83, "Input",ExpressionUUID->"0e77d0f4-a848-4005-a9dd-06ffe611995a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[402728, 9364, 160, 3, 67, "Section",ExpressionUUID->"93aaa47b-a396-4161-91ca-49b667c0b840"],
Cell[CellGroupData[{
Cell[402913, 9371, 1455, 38, 83, "Input",ExpressionUUID->"d316d4ed-54ce-4083-af58-19d4fd0e62f1"],
Cell[404371, 9411, 6282, 146, 117, "Output",ExpressionUUID->"92141852-aa51-4d6d-98be-30e2b22ba505"]
}, Open  ]],
Cell[CellGroupData[{
Cell[410690, 9562, 5281, 124, 273, "Input",ExpressionUUID->"59fc110c-c743-45ac-a920-c8642c27e866"],
Cell[CellGroupData[{
Cell[415996, 9690, 31894, 680, 210, "Print",ExpressionUUID->"9e78b900-ba8f-4c91-9077-9601c02c1a99"],
Cell[447893, 10372, 32506, 689, 210, "Print",ExpressionUUID->"8eb51cc0-aea8-4f13-a7eb-eb9ce46cbe78"],
Cell[480402, 11063, 31904, 680, 210, "Print",ExpressionUUID->"c4cde897-fda7-41d1-b57a-0f523fed23db"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[512367, 11750, 266, 4, 67, "Section",ExpressionUUID->"99ea9db4-4270-422b-8e2a-27d7e6db8cb8"],
Cell[512636, 11756, 2045, 53, 159, "Input",ExpressionUUID->"9f1a2cb9-79f4-4671-a68e-6175d51c2daf"],
Cell[514684, 11811, 2479, 74, 178, "Input",ExpressionUUID->"188e8a55-92c3-447b-ba1e-4ac37e13e066"],
Cell[CellGroupData[{
Cell[517188, 11889, 7848, 193, 729, "Input",ExpressionUUID->"b1026277-bab1-4b5a-ba92-e8b213c7e7d8"],
Cell[CellGroupData[{
Cell[525061, 12086, 675, 19, 41, "Print",ExpressionUUID->"cf494de2-50c3-4bb4-92e8-85fa8a292c75"],
Cell[525739, 12107, 615, 15, 22, "Print",ExpressionUUID->"0861d040-3426-4ea0-aaf5-079831d7d1eb"],
Cell[526357, 12124, 623, 15, 22, "Print",ExpressionUUID->"7dff676e-5cca-4bbd-befb-4256f966f536"],
Cell[526983, 12141, 433, 10, 22, "Print",ExpressionUUID->"e5bdbc33-c166-4fe3-b63c-6f4510872086"],
Cell[527419, 12153, 675, 19, 41, "Print",ExpressionUUID->"905e33d0-3ae8-4a78-a4d0-2b4e4604c693"],
Cell[528097, 12174, 615, 15, 22, "Print",ExpressionUUID->"a8b21134-c9fe-48d3-af7c-292720fcb4b4"],
Cell[528715, 12191, 620, 15, 22, "Print",ExpressionUUID->"e52260dd-1b5e-43d4-8278-0c3501d926f1"],
Cell[529338, 12208, 430, 10, 22, "Print",ExpressionUUID->"81fcad26-b6c9-48af-b6d3-1409c8d7e974"],
Cell[529771, 12220, 676, 19, 41, "Print",ExpressionUUID->"0165f04f-8680-4803-b95e-4c11b97fe746"],
Cell[530450, 12241, 608, 15, 22, "Print",ExpressionUUID->"a9d94042-b821-45a2-a644-6ea0d5aab9f7"],
Cell[531061, 12258, 645, 16, 22, "Print",ExpressionUUID->"2bd38a52-de6b-4412-b4b7-7d1c43e0d42b"],
Cell[531709, 12276, 433, 10, 22, "Print",ExpressionUUID->"def94759-f8c5-49bb-82c1-489e22d6e563"],
Cell[532145, 12288, 503, 14, 41, "Print",ExpressionUUID->"05ef9d4d-78d1-4a90-b449-cbcbbd7e76fe"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[532709, 12309, 151, 3, 67, "Section",ExpressionUUID->"bdf08dea-4834-47a7-b4e4-f597c91f3f33"],
Cell[532863, 12314, 1600, 44, 159, "Input",ExpressionUUID->"89c7ad0d-7d40-493b-9604-70934056674d"],
Cell[534466, 12360, 5582, 138, 254, "Input",ExpressionUUID->"5e33845b-b650-4ffa-a4f9-79333c4a448b"],
Cell[540051, 12500, 4955, 117, 178, "Input",ExpressionUUID->"56cfd4df-48a3-41c1-8191-148171399217"],
Cell[545009, 12619, 2517, 51, 64, "Input",ExpressionUUID->"555135c2-9706-4b50-8b9c-6f11c97b8cc5"],
Cell[547529, 12672, 2336, 49, 64, "Input",ExpressionUUID->"4bd50bc4-9961-4a69-b87d-5c397e7b8cbe"],
Cell[549868, 12723, 2090, 39, 64, "Input",ExpressionUUID->"e6e45f3b-c913-4d9e-b6cb-45edfc980b72"]
}, Open  ]]
}
]
*)

